<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>GeekIBLi</title>
  
  <subtitle>For Coder</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2021-08-30T06:13:16.598Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>gaolei</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>MySQL-ShardingJDBCåˆ†åº“åˆ†è¡¨å®æˆ˜</title>
    <link href="http://example.com/wiki/MySQL-ShardingJDBC%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E5%AE%9E%E6%88%98/"/>
    <id>http://example.com/wiki/MySQL-ShardingJDBC%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E5%AE%9E%E6%88%98/</id>
    <published>2021-08-27T11:18:15.000Z</published>
    <updated>2021-08-30T06:13:16.598Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åˆ†åº“åˆ†è¡¨Demo"><a href="#åˆ†åº“åˆ†è¡¨Demo" class="headerlink" title="åˆ†åº“åˆ†è¡¨Demo"></a>åˆ†åº“åˆ†è¡¨Demo</h1><p><strong>é¡¹ç›®åœ°å€</strong> <a href="https://github.com/geekibli/sharding-demos/tree/main/simple-sharding-stratery">https://github.com/geekibli/sharding-demos/</a></p><h2 id="Springboot-Sharding-jdbc"><a href="#Springboot-Sharding-jdbc" class="headerlink" title="Springboot + Sharding jdbc"></a>Springboot + Sharding jdbc</h2><h3 id="mavenä¾èµ–"><a href="#mavenä¾èµ–" class="headerlink" title="mavenä¾èµ–"></a>mavenä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shardingsphere<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>sharding-jdbc-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.0-RC1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="æ•°æ®æºé…ç½®"><a href="#æ•°æ®æºé…ç½®" class="headerlink" title="æ•°æ®æºé…ç½®"></a>æ•°æ®æºé…ç½®</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DuridConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Filter <span class="title">statFilter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        StatFilter filter = <span class="keyword">new</span> StatFilter();</span><br><span class="line">        filter.setSlowSqlMillis(<span class="number">5000</span>);</span><br><span class="line">        filter.setLogSlowSql(<span class="keyword">true</span>);</span><br><span class="line">        filter.setMergeSql(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">return</span> filter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletRegistrationBean <span class="title">statViewServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºservletæ³¨å†Œå®ä½“</span></span><br><span class="line">        ServletRegistrationBean servletRegistrationBean = <span class="keyword">new</span> ServletRegistrationBean(<span class="keyword">new</span> StatViewServlet(), <span class="string">&quot;/druid/*&quot;</span>);</span><br><span class="line">        <span class="comment">//è®¾ç½®ipç™½åå•</span></span><br><span class="line">        servletRegistrationBean.addInitParameter(<span class="string">&quot;allow&quot;</span>, <span class="string">&quot;127.0.0.1&quot;</span>);</span><br><span class="line">        <span class="comment">//è®¾ç½®ipé»‘åå•ï¼Œå¦‚æœallowä¸denyå…±åŒå­˜åœ¨æ—¶,denyä¼˜å…ˆäºallow</span></span><br><span class="line">        <span class="comment">//servletRegistrationBean.addInitParameter(&quot;deny&quot;,&quot;192.168.0.19&quot;);</span></span><br><span class="line">        <span class="comment">//è®¾ç½®æ§åˆ¶å°ç®¡ç†ç”¨æˆ·</span></span><br><span class="line">        servletRegistrationBean.addInitParameter(<span class="string">&quot;loginUsername&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">        servletRegistrationBean.addInitParameter(<span class="string">&quot;loginPassword&quot;</span>, <span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        <span class="comment">//æ˜¯å¦å¯ä»¥é‡ç½®æ•°æ®</span></span><br><span class="line">        servletRegistrationBean.addInitParameter(<span class="string">&quot;resetEnable&quot;</span>, <span class="string">&quot;false&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> servletRegistrationBean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">server.port</span>=<span class="string">8071</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># mybatis é…ç½®</span></span><br><span class="line"><span class="meta">mybatis.mapper-locations</span>=<span class="string">classpath:mapping/*.xml</span></span><br><span class="line"><span class="meta">mybatis.type-aliases-package</span>=<span class="string">com.ibli.sharding.simple.domain</span></span><br><span class="line"></span><br><span class="line"><span class="meta">spring.shardingsphere.datasource.names</span>=<span class="string">ds0,ds1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">spring.shardingsphere.datasource.ds0.type</span>=<span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line"><span class="meta">spring.shardingsphere.datasource.ds0.driver-class-name</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="meta">spring.shardingsphere.datasource.ds0.url</span>=<span class="string">jdbc:mysql://localhost:3331/ds0?useUnicode=true&amp;characterEncoding=UTF-8&amp;autoReconnect=true&amp;failOverReadOnly=false&amp;allowMultiQueries=true&amp;useSSL=false</span></span><br><span class="line"><span class="meta">spring.shardingsphere.datasource.ds0.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.shardingsphere.datasource.ds0.password</span>=<span class="string">123456</span></span><br><span class="line"></span><br><span class="line"><span class="meta">spring.shardingsphere.datasource.ds1.type</span>=<span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line"><span class="meta">spring.shardingsphere.datasource.ds1.driver-class-name</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="meta">spring.shardingsphere.datasource.ds1.url</span>=<span class="string">jdbc:mysql://localhost:3331/ds1?useUnicode=true&amp;characterEncoding=UTF-8&amp;autoReconnect=true&amp;failOverReadOnly=false&amp;allowMultiQueries=true&amp;useSSL=false</span></span><br><span class="line"><span class="meta">spring.shardingsphere.datasource.ds1.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.shardingsphere.datasource.ds1.password</span>=<span class="string">123456</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># åˆ†åº“é…ç½® ï¼Œ æ ¹æ®member_idåˆ†åº“</span></span><br><span class="line"><span class="meta">spring.shardingsphere.sharding.default-database-strategy.inline.sharding-column</span>=<span class="string">member_id</span></span><br><span class="line"><span class="meta">spring.shardingsphere.sharding.default-database-strategy.inline.algorithm-expression</span>=<span class="string">ds$-&gt;&#123;member_id % 2&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># åˆ†è¡¨é…ç½®ï¼Œæ ¹æ®member_idåˆ†è¡¨</span></span><br><span class="line"><span class="meta">spring.shardingsphere.sharding.tables.member.actual-data-nodes</span>=<span class="string">ds$-&gt;&#123;0..1&#125;.member</span></span><br><span class="line"><span class="meta">spring.shardingsphere.sharding.tables.member.table-strategy.inline.sharding-column</span>=<span class="string">member_id</span></span><br><span class="line"><span class="meta">spring.shardingsphere.sharding.tables.member.table-strategy.inline.algorithm-expression</span>=<span class="string">member$-&gt;&#123;member_id % 2&#125;</span></span><br><span class="line"><span class="meta">spring.shardingsphere.sharding.tables.member.key-generator.column</span>=<span class="string">member_id</span></span><br><span class="line"><span class="meta">spring.shardingsphere.sharding.tables.member.key-generator.type</span>=<span class="string">SNOWFLAKE</span></span><br><span class="line"></span><br><span class="line"><span class="meta">spring.shardingsphere.props.sql.show</span>=<span class="string">true</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æ’å…¥æ•°æ®"><a href="#æ’å…¥æ•°æ®" class="headerlink" title="æ’å…¥æ•°æ®"></a>æ’å…¥æ•°æ®</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Member <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Member member = <span class="keyword">new</span> Member();</span><br><span class="line">        <span class="comment">//ä¸ç”¨æ‰‹åŠ¨è®¾ç½®ä¸»é”®idï¼Œæ–°å¢æ—¶ï¼Œsharding-jdbcä¼šè‡ªåŠ¨èµ‹å€¼ï¼Œå› ä¸ºåœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®äº†è¯¥åˆ—ä½¿ç”¨SNOWFLAKEç®—æ³•ç”Ÿæˆå€¼</span></span><br><span class="line"><span class="comment">//        member.setMemberId(IdWorker.getLongId());</span></span><br><span class="line">        member.setNickName(<span class="string">&quot;nickname&quot;</span>);</span><br><span class="line">        member.setAccountNo(<span class="keyword">new</span> Date().hashCode());</span><br><span class="line">        member.setPassword(UUID.randomUUID().toString());</span><br><span class="line">        member.setAge(<span class="number">10</span>);</span><br><span class="line">        member.setDelFlag(UUID.randomUUID().toString());</span><br><span class="line">        memberServiceImpl.insert(member);</span><br><span class="line">        <span class="keyword">return</span> member;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="SQLæ–‡ä»¶"><a href="#SQLæ–‡ä»¶" class="headerlink" title="SQLæ–‡ä»¶"></a>SQLæ–‡ä»¶</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `member0` (</span><br><span class="line">  `member_id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `nick_name` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `account_no` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `password` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `age` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `birthday` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `del_flag` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`member_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">0</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `member1` (</span><br><span class="line">  `member_id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `nick_name` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `account_no` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `password` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `age` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `birthday` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `del_flag` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`member_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">0</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br></pre></td></tr></table></figure><h3 id="å¯åŠ¨é¡¹ç›®"><a href="#å¯åŠ¨é¡¹ç›®" class="headerlink" title="å¯åŠ¨é¡¹ç›®"></a>å¯åŠ¨é¡¹ç›®</h3><h4 id="è®¿é—®åˆ›å»ºç”¨æˆ·æ¥å£"><a href="#è®¿é—®åˆ›å»ºç”¨æˆ·æ¥å£" class="headerlink" title="è®¿é—®åˆ›å»ºç”¨æˆ·æ¥å£"></a>è®¿é—®åˆ›å»ºç”¨æˆ·æ¥å£</h4><p><code>curl -X GET http://localhost:8071/member/add</code></p><h4 id="æŸ¥çœ‹æ•°æ®åº“"><a href="#æŸ¥çœ‹æ•°æ®åº“" class="headerlink" title="æŸ¥çœ‹æ•°æ®åº“"></a>æŸ¥çœ‹æ•°æ®åº“</h4><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/20210830141127.png"><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://juejin.cn/post/6844903773383426061">https://juejin.cn/post/6844903773383426061</a></p><p><a href="https://juejin.cn/post/6890772387000762382">https://juejin.cn/post/6890772387000762382</a></p><p><a href="https://shardingsphere.apache.org/document/current/cn/quick-start/shardingsphere-proxy-quick-start/">https://shardingsphere.apache.org/document/current/cn/quick-start/shardingsphere-proxy-quick-start/</a></p><p><a href="https://www.pianshen.com/article/7996383507/">https://www.pianshen.com/article/7996383507/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åˆ†åº“åˆ†è¡¨Demo&quot;&gt;&lt;a href=&quot;#åˆ†åº“åˆ†è¡¨Demo&quot; class=&quot;headerlink&quot; title=&quot;åˆ†åº“åˆ†è¡¨Demo&quot;&gt;&lt;/a&gt;åˆ†åº“åˆ†è¡¨Demo&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;é¡¹ç›®åœ°å€&lt;/strong&gt; &lt;a href=&quot;https://github.</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>MySQL-ä¸»ä»åŒæ­¥åŸç†ä»¥åŠå®ç°</title>
    <link href="http://example.com/wiki/MySQL-%E4%B8%BB%E4%BB%8E%E5%90%8C%E6%AD%A5%E5%8E%9F%E7%90%86%E4%BB%A5%E5%8F%8A%E5%AE%9E%E7%8E%B0/"/>
    <id>http://example.com/wiki/MySQL-%E4%B8%BB%E4%BB%8E%E5%90%8C%E6%AD%A5%E5%8E%9F%E7%90%86%E4%BB%A5%E5%8F%8A%E5%AE%9E%E7%8E%B0/</id>
    <published>2021-08-27T08:53:05.000Z</published>
    <updated>2021-08-27T10:56:25.190Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸»ä»å¤åˆ¶çš„åŸç†"><a href="#ä¸»ä»å¤åˆ¶çš„åŸç†" class="headerlink" title="ä¸»ä»å¤åˆ¶çš„åŸç†"></a>ä¸»ä»å¤åˆ¶çš„åŸç†</h2><p>æˆ‘ä»¬åœ¨å¹³æ—¶å·¥ä½œä¸­ï¼Œä½¿ç”¨æœ€å¤šçš„æ•°æ®åº“å°±æ˜¯ <code>MySQL</code> äº†ï¼Œéšç€ä¸šåŠ¡çš„å¢åŠ ï¼Œå¦‚æœå•å•é ä¸€å°æœåŠ¡å™¨çš„è¯ï¼Œè´Ÿè½½è¿‡é‡ï¼Œå°±å®¹æ˜“é€ æˆ<strong>å®•æœº</strong>ã€‚</p><p>è¿™æ ·æˆ‘ä»¬ä¿å­˜åœ¨ MySQL æ•°æ®åº“çš„æ•°æ®å°±ä¼šä¸¢å¤±ï¼Œé‚£ä¹ˆè¯¥æ€ä¹ˆè§£å†³å‘¢ï¼Ÿ</p><p>å…¶å®åœ¨ MySQL æœ¬èº«å°±è‡ªå¸¦æœ‰ä¸€ä¸ªä¸»ä»å¤åˆ¶çš„åŠŸèƒ½ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°<strong>è´Ÿè½½å‡è¡¡å’Œè¯»å†™åˆ†ç¦»</strong>ã€‚</p><p>å¯¹äºä¸»æœåŠ¡å™¨ï¼ˆMasterï¼‰æ¥è¯´ï¼Œä¸»è¦è´Ÿè´£å†™ï¼Œä»æœåŠ¡å™¨ï¼ˆSlaveï¼‰ä¸»è¦è´Ÿè´£è¯»ï¼Œè¿™æ ·çš„è¯ï¼Œå°±ä¼šå¤§å¤§å‡è½»å‹åŠ›ï¼Œä»è€Œæé«˜æ•ˆç‡ã€‚</p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210827173121932.png" alt="image-20210827173121932" style="zoom:33%;" /><p>MySQL çš„ä¸»ä»å¤åˆ¶å·¥ä½œè¿‡ç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p><ol><li>ä»åº“ç”Ÿæˆ<strong>ä¸¤ä¸ªçº¿ç¨‹</strong>ï¼Œä¸€ä¸ª I/O çº¿ç¨‹ï¼Œä¸€ä¸ª SQL çº¿ç¨‹ï¼›</li><li>I/O çº¿ç¨‹å»è¯·æ±‚ä¸»åº“çš„ binlogï¼Œå¹¶å°†å¾—åˆ°çš„ binlog æ—¥å¿—<strong>å†™åˆ°</strong> relay log(ä¸­ç»§æ—¥å¿—) æ–‡ä»¶ä¸­ï¼›</li><li>ä¸»åº“ä¼š<strong>ç”Ÿæˆ</strong>ä¸€ä¸ª log dump çº¿ç¨‹ï¼Œç”¨æ¥ç»™ä»åº“ I/O çº¿ç¨‹ä¼  binlogï¼›</li><li>SQL çº¿ç¨‹ä¼šè¯»å– relay log æ–‡ä»¶ä¸­çš„æ—¥å¿—ï¼Œå¹¶<strong>è§£æ</strong>æˆå…·ä½“æ“ä½œï¼Œæ¥å®ç°ä¸»ä»çš„æ“ä½œä¸€è‡´ï¼Œè€Œæœ€ç»ˆæ•°æ®ä¸€è‡´ï¼›</li></ol><h4 id="è¯·æ±‚æµç¨‹"><a href="#è¯·æ±‚æµç¨‹" class="headerlink" title="è¯·æ±‚æµç¨‹"></a>è¯·æ±‚æµç¨‹</h4><p>MySQL å»ºç«‹è¯·æ±‚çš„ä¸»ä»çš„è¯¦ç»†æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li>å½“ä»æœåŠ¡å™¨è¿æ¥ä¸»æœåŠ¡å™¨æ—¶ï¼Œä¸»æœåŠ¡å™¨ä¼šåˆ›å»ºä¸€ä¸ª log dump çº¿ç¨‹ï¼Œç”¨äºå‘é€ binlog çš„å†…å®¹ã€‚åœ¨è¯»å– binlog çš„å†…å®¹çš„æ“ä½œä¸­ï¼Œä¼šå¯¹è±¡ä¸»èŠ‚ç‚¹ä¸Šçš„ binlog <strong>åŠ é”</strong>ï¼Œå½“è¯»å–å®Œæˆå¹¶å‘é€ç»™ä»æœåŠ¡å™¨åè§£é”ã€‚</li><li>å½“ä»èŠ‚ç‚¹ä¸Šæ‰§è¡Œ <code>start slave</code> å‘½ä»¤ä¹‹åï¼Œä»èŠ‚ç‚¹ä¼šåˆ›å»ºä¸€ä¸ª IO çº¿ç¨‹ç”¨æ¥è¿æ¥ä¸»èŠ‚ç‚¹ï¼Œè¯·æ±‚ä¸»åº“ä¸­<strong>æ›´æ–°</strong>binlogã€‚IO çº¿ç¨‹æ¥æ”¶ä¸»èŠ‚ç‚¹ binlog dump è¿›ç¨‹å‘æ¥çš„æ›´æ–°ä¹‹åï¼Œä¿å­˜åˆ° relay-log ä¸­ã€‚</li><li>ä»èŠ‚ç‚¹ SQL çº¿ç¨‹è´Ÿè´£è¯»å– realy-log ä¸­çš„å†…å®¹ï¼Œ<strong>è§£æ</strong>æˆå…·ä½“çš„æ“ä½œæ‰§è¡Œï¼Œæœ€ç»ˆä¿è¯ä¸»ä»æ•°æ®çš„ä¸€è‡´æ€§ã€‚</li></ol><h2 id="ä¸»ä»åŒæ­¥å®ç°"><a href="#ä¸»ä»åŒæ­¥å®ç°" class="headerlink" title="ä¸»ä»åŒæ­¥å®ç°"></a>ä¸»ä»åŒæ­¥å®ç°</h2><p>æˆ‘è¿™é‡Œå®ç°äº†ä¸€ä¸»ä¸€ä»ã€‚æ•°æ®åº“ç‰ˆæœ¬éƒ½æ˜¯ç”¨çš„MySQL5.8ã€‚</p><h3 id="è®¾ç½®ä¸»åº“"><a href="#è®¾ç½®ä¸»åº“" class="headerlink" title="è®¾ç½®ä¸»åº“"></a>è®¾ç½®ä¸»åº“</h3><h4 id="è®¾ç½®é…ç½®æ–‡ä»¶"><a href="#è®¾ç½®é…ç½®æ–‡ä»¶" class="headerlink" title="è®¾ç½®é…ç½®æ–‡ä»¶"></a>è®¾ç½®é…ç½®æ–‡ä»¶</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">log-bin=mysql-bin #æ·»åŠ è¿™ä¸€è¡Œå°±ok</span><br><span class="line">binlog-format=ROW #é€‰æ‹©rowæ¨¡å¼</span><br><span class="line">server_id=1 #é…ç½®mysql replactionéœ€è¦å®šä¹‰</span><br></pre></td></tr></table></figure><h4 id="åˆ›å»ºåŒæ­¥ç”¨æˆ·"><a href="#åˆ›å»ºåŒæ­¥ç”¨æˆ·" class="headerlink" title="åˆ›å»ºåŒæ­¥ç”¨æˆ·"></a>åˆ›å»ºåŒæ­¥ç”¨æˆ·</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># åˆ›å»ºç”¨æˆ·</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> <span class="string">&#x27;repl&#x27;</span>@<span class="string">&#x27;*&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;repl&#x27;</span>;</span><br><span class="line"></span><br><span class="line"># æˆæƒï¼Œåªæˆäºˆå¤åˆ¶å’Œå®¢æˆ·ç«¯è®¿é—®æƒé™</span><br><span class="line"><span class="keyword">grant</span> replication slave <span class="keyword">on</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;repl&#x27;</span>@<span class="string">&#x27;*&#x27;</span>;#åˆ†é…æƒé™</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹binlogçŠ¶æ€"><a href="#æŸ¥çœ‹binlogçŠ¶æ€" class="headerlink" title="æŸ¥çœ‹binlogçŠ¶æ€"></a>æŸ¥çœ‹binlogçŠ¶æ€</h4><p><code>SHOW MASTER STATUS;</code></p><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210827170105244.png" alt="image-20210827170105244"></p><p>Positionä¸€å¼€å§‹åŒæ­¥ä¹‹å‰æ˜¯åœ¨ 2729 ä½ç½®ã€‚</p><h3 id="é…ç½®ä»åº“Slave"><a href="#é…ç½®ä»åº“Slave" class="headerlink" title="é…ç½®ä»åº“Slave"></a>é…ç½®ä»åº“Slave</h3><h4 id="ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹é…ç½®æ–‡ä»¶</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">log-bin=mysql-bin #æ·»åŠ è¿™ä¸€è¡Œå°±ok</span><br><span class="line">binlog-format=ROW #é€‰æ‹©rowæ¨¡å¼</span><br><span class="line">server_id=2 </span><br></pre></td></tr></table></figure><h4 id="è®¾ç½®åŒæ­¥ä¿¡æ¯"><a href="#è®¾ç½®åŒæ­¥ä¿¡æ¯" class="headerlink" title="è®¾ç½®åŒæ­¥ä¿¡æ¯"></a>è®¾ç½®åŒæ­¥ä¿¡æ¯</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CHANGE MASTER <span class="keyword">TO</span> MASTER_HOST<span class="operator">=</span><span class="string">&#x27;123.56.77.177&#x27;</span>, </span><br><span class="line">        MASTER_USER<span class="operator">=</span><span class="string">&#x27;repl&#x27;</span>, </span><br><span class="line">        MASTER_PASSWORD<span class="operator">=</span><span class="string">&#x27;repl&#x27;</span>,</span><br><span class="line">        MASTER_LOG_FILE<span class="operator">=</span><span class="string">&#x27;binlog.000001&#x27;</span>, </span><br><span class="line">        MASTER_LOG_POS<span class="operator">=</span><span class="number">2729</span>, </span><br><span class="line">        Master_Port <span class="operator">=</span> <span class="number">3306</span>;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œè¿™ä¸ªSQLå¿…é¡»æ˜¯åœ¨ <code>slave not running</code> çŠ¶æ€ä¸‹å¯ä»¥è¿è¡Œï¼Œå¯ä»¥ <code>stop slave</code>å‘½ä»¤æ¥åœæ­¢slaveã€‚</p><h4 id="å¯åŠ¨slave"><a href="#å¯åŠ¨slave" class="headerlink" title="å¯åŠ¨slave"></a>å¯åŠ¨slave</h4><p><code>mysql&gt;start slave;</code></p><h4 id="æŸ¥çœ‹slaveçŠ¶æ€"><a href="#æŸ¥çœ‹slaveçŠ¶æ€" class="headerlink" title="æŸ¥çœ‹slaveçŠ¶æ€"></a>æŸ¥çœ‹slaveçŠ¶æ€</h4><p><code>mysql&gt; show slave status\G</code></p><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210827170515304.png" alt="image-20210827170515304"></p><p>âš ï¸ åªæœ‰å½“ <code>Slave_IO_Running: Yes</code> å’Œ <code>Slave_SQL_Running: Yes</code> åŒæ—¶æ˜¯ yesçš„æ—¶å€™ï¼Œæ‰å¯ä»¥è¿›è¡ŒåŒæ­¥ã€‚</p><h4 id="Slave-IO-Running-No-å¯èƒ½çš„åŸå› "><a href="#Slave-IO-Running-No-å¯èƒ½çš„åŸå› " class="headerlink" title="Slave_IO_Running: No å¯èƒ½çš„åŸå› "></a>Slave_IO_Running: No å¯èƒ½çš„åŸå› </h4><p>1ã€ç«¯å£ä¸åŒ</p><p><code>ping ip</code> å¦‚æœæ˜¯dockerå¯åŠ¨çš„mysqlçš„è¯ï¼Œéœ€è¦é€€å‡ºdockeræ¥æµ‹è¯•ç«¯å£ã€‚</p><p><code>telnet ip port</code></p><p>2ã€æ²¡æœ‰æƒé™</p><p><code>grant replication slave, replication client on *.* to  &#39;repl&#39;@&#39;%&#39;;</code></p><p>3ã€binlogæ–‡ä»¶å†™é”™</p><p>å¯ä»¥æŸ¥çœ‹ <code> Last_IO_Error</code> çš„é”™è¯¯æç¤ºï¼Œæˆ‘è¿™é‡Œé‡åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œä¸»åº“binlogæ–‡ä»¶æ˜¯binlog.000001 ï¼Œä½†æ˜¯æˆ‘ç›´æ¥ç²˜è´´åˆ«äººåšå®¢çš„æ—¶å€™ï¼Œæ²¡æœ‰æ³¨æ„ï¼Œåšå®¢ä¸Šé¢å†™çš„æ˜¯mysql-bin.000001ã€‚</p><h2 id="åŒæ­¥æ•ˆæœæµ‹è¯•"><a href="#åŒæ­¥æ•ˆæœæµ‹è¯•" class="headerlink" title="åŒæ­¥æ•ˆæœæµ‹è¯•"></a>åŒæ­¥æ•ˆæœæµ‹è¯•</h2><h4 id="åˆ†ä¸‰ä¸ªæ­¥éª¤æµ‹è¯•"><a href="#åˆ†ä¸‰ä¸ªæ­¥éª¤æµ‹è¯•" class="headerlink" title="åˆ†ä¸‰ä¸ªæ­¥éª¤æµ‹è¯•"></a>åˆ†ä¸‰ä¸ªæ­¥éª¤æµ‹è¯•</h4><p><strong>1ã€æµ‹è¯•æ•°æ®åº“</strong></p><p><strong>2ã€æµ‹è¯•è¡¨</strong></p><p><strong>3ã€æµ‹è¯•è¡¨æ•°æ®</strong></p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210827171817248.png" alt="image-20210827171817248" style="zoom:50%;" /><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p>ä¸»ä»åŒæ­¥çš„ç±»å‹ ï¼ˆå¼‚æ­¥ åŒæ­¥ åŠåŒæ­¥ å»¶è¿Ÿï¼‰</p><p><a href="https://juejin.cn/post/6967224081410162696">https://juejin.cn/post/6967224081410162696</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ä¸»ä»å¤åˆ¶çš„åŸç†&quot;&gt;&lt;a href=&quot;#ä¸»ä»å¤åˆ¶çš„åŸç†&quot; class=&quot;headerlink&quot; title=&quot;ä¸»ä»å¤åˆ¶çš„åŸç†&quot;&gt;&lt;/a&gt;ä¸»ä»å¤åˆ¶çš„åŸç†&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬åœ¨å¹³æ—¶å·¥ä½œä¸­ï¼Œä½¿ç”¨æœ€å¤šçš„æ•°æ®åº“å°±æ˜¯ &lt;code&gt;MySQL&lt;/code&gt; äº†ï¼Œéšç€ä¸šåŠ¡çš„å¢åŠ ï¼Œå¦‚</summary>
      
    
    
    
    
    <category term="MySQL" scheme="http://example.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>Dockerå®‰è£…MySQL</title>
    <link href="http://example.com/wiki/Docker%E5%AE%89%E8%A3%85MySQL/"/>
    <id>http://example.com/wiki/Docker%E5%AE%89%E8%A3%85MySQL/</id>
    <published>2021-08-27T06:16:47.000Z</published>
    <updated>2021-08-27T08:53:43.472Z</updated>
    
    <content type="html"><![CDATA[<h2 id="linuxå®‰è£…docker"><a href="#linuxå®‰è£…docker" class="headerlink" title="linuxå®‰è£…docker"></a>linuxå®‰è£…docker</h2><p><code>yum update</code><br><code>yum install docker</code></p><p>ç»“æœå¯åŠ¨dockeræ—¶æŠ¥é”™äº† ğŸ‘‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Emulate Docker CLI using podman. Create /etc/containers/nodocker to quiet msg.</span><br><span class="line">Error: open /proc/self/uid_map: no such file or directory</span><br></pre></td></tr></table></figure><p><strong>è§£å†³åŠæ³•</strong><br>1ï¼Œå¸è½½podmanè½¯ä»¶ï¼ˆå¯ä»¥ä½¿ç”¨rpm -qa|grep dockerï¼‰<br><code>yum remove docker</code><br>2,ä¸‹è½½docker-ceæº<br><code>curl https://download.docker.com/linux/centos/docker-ce.repo -o /etc/yum.repos.d/docker-ce.repo</code><br>3ï¼Œå®‰è£…docker-ce<br><code>yum install docker-ce -y</code></p><p><strong>é—®é¢˜åŸå› åˆ†æï¼š</strong><br>Centos 8ä½¿ç”¨yum install docker -yæ—¶ï¼Œé»˜è®¤å®‰è£…çš„æ˜¯podman-dockerè½¯ä»¶</p><h3 id="æŸ¥çœ‹dockerçŠ¶æ€"><a href="#æŸ¥çœ‹dockerçŠ¶æ€" class="headerlink" title="æŸ¥çœ‹dockerçŠ¶æ€"></a>æŸ¥çœ‹dockerçŠ¶æ€</h3><img src = 'https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/20210827142038.png'><h3 id="å¯åŠ¨docker"><a href="#å¯åŠ¨docker" class="headerlink" title="å¯åŠ¨docker"></a>å¯åŠ¨docker</h3><p><code>systemctl start docker</code><br><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/20210827142309.png"></p><h2 id="å®‰è£…MySQl"><a href="#å®‰è£…MySQl" class="headerlink" title="å®‰è£…MySQl"></a>å®‰è£…MySQl</h2><p><code>docker search mysql</code></p><h3 id="é€‰æ‹©ä½ è¦å®‰è£…çš„ç‰ˆæœ¬"><a href="#é€‰æ‹©ä½ è¦å®‰è£…çš„ç‰ˆæœ¬" class="headerlink" title="é€‰æ‹©ä½ è¦å®‰è£…çš„ç‰ˆæœ¬"></a><strong>é€‰æ‹©ä½ è¦å®‰è£…çš„ç‰ˆæœ¬</strong></h3><p><code>docker pull centos/mysql-57-centos7</code></p><h3 id="æŸ¥çœ‹å®‰è£…çš„é•œåƒ"><a href="#æŸ¥çœ‹å®‰è£…çš„é•œåƒ" class="headerlink" title="æŸ¥çœ‹å®‰è£…çš„é•œåƒ"></a><strong>æŸ¥çœ‹å®‰è£…çš„é•œåƒ</strong></h3><p><code>docker images</code><br><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/20210827142710.png"></p><h3 id="å¯åŠ¨mysql"><a href="#å¯åŠ¨mysql" class="headerlink" title="å¯åŠ¨mysql"></a><strong>å¯åŠ¨mysql</strong></h3><p><code>docker run --name mysqlserver -v /etc/mysql/my.conf:/etc/my.conf -e MYSQL_ROOT_PASSWORD=123456 -d -i -p 3306:3306 centos/mysql-57-centos7</code><br><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/20210827143045.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;linuxå®‰è£…docker&quot;&gt;&lt;a href=&quot;#linuxå®‰è£…docker&quot; class=&quot;headerlink&quot; title=&quot;linuxå®‰è£…docker&quot;&gt;&lt;/a&gt;linuxå®‰è£…docker&lt;/h2&gt;&lt;p&gt;&lt;code&gt;yum update&lt;/code&gt;&lt;br</summary>
      
    
    
    
    
    <category term="docker" scheme="http://example.com/tags/docker/"/>
    
    <category term="mysql" scheme="http://example.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>ç®—æ³•-KMPç®—æ³•ä»¥åŠæ‰©å±•</title>
    <link href="http://example.com/wiki/%E7%AE%97%E6%B3%95-KMP%E7%AE%97%E6%B3%95%E4%BB%A5%E5%8F%8A%E6%89%A9%E5%B1%95/"/>
    <id>http://example.com/wiki/%E7%AE%97%E6%B3%95-KMP%E7%AE%97%E6%B3%95%E4%BB%A5%E5%8F%8A%E6%89%A9%E5%B1%95/</id>
    <published>2021-08-26T14:27:32.000Z</published>
    <updated>2021-08-26T15:23:50.995Z</updated>
    
    <content type="html"><![CDATA[<p>é¢˜ç›®1</p><p>â€œ123456â€ å’Œ â€œ345612â€æ˜¯ä¸æ˜¯äº’ä¸ºæ—‹è½¬ä¸²</p><p>æ€è·¯ï¼šâ€œ123456123456â€ åˆ¤æ–­ â€œ345612â€  æ˜¯ä¸æ˜¯å­ä¸²å°±å¯ä»¥äº†</p><p>é¢˜ç›®2</p><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210826225159606.png" alt="image-20210826225159606"></p><p>![image-20210826225714858](/Users/gaolei/Library/Application Support/typora-user-images/image-20210826225714858.png)</p><img src="/Users/gaolei/Library/Application Support/typora-user-images/image-20210826230341631.png" alt="image-20210826230341631" style="zoom: 25%;" /><p>è·å…°å›½æ——é—®é¢˜ï¼Ÿï¼Ÿï¼Ÿ</p><p>Bfprt ç®—æ³•</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;é¢˜ç›®1&lt;/p&gt;
&lt;p&gt;â€œ123456â€ å’Œ â€œ345612â€æ˜¯ä¸æ˜¯äº’ä¸ºæ—‹è½¬ä¸²&lt;/p&gt;
&lt;p&gt;æ€è·¯ï¼šâ€œ123456123456â€ åˆ¤æ–­ â€œ345612â€  æ˜¯ä¸æ˜¯å­ä¸²å°±å¯ä»¥äº†&lt;/p&gt;
&lt;p&gt;é¢˜ç›®2&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.n</summary>
      
    
    
    
    
    <category term="ç®—æ³•" scheme="http://example.com/tags/%E7%AE%97%E6%B3%95/"/>
    
    <category term="KMP" scheme="http://example.com/tags/KMP/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€æ–‡ææ‡‚é«˜å¹¶å‘æ€§èƒ½æŒ‡æ ‡ï¼šQPSã€TPSã€RTã€ååé‡</title>
    <link href="http://example.com/wiki/%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82%E9%AB%98%E5%B9%B6%E5%8F%91%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87%EF%BC%9AQPS%E3%80%81TPS%E3%80%81RT%E3%80%81%E5%90%9E%E5%90%90%E9%87%8F/"/>
    <id>http://example.com/wiki/%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82%E9%AB%98%E5%B9%B6%E5%8F%91%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87%EF%BC%9AQPS%E3%80%81TPS%E3%80%81RT%E3%80%81%E5%90%9E%E5%90%90%E9%87%8F/</id>
    <published>2021-08-26T11:41:56.000Z</published>
    <updated>2021-08-26T11:59:27.668Z</updated>
    
    <content type="html"><![CDATA[<h2 id="QPS"><a href="#QPS" class="headerlink" title="QPS"></a>QPS</h2><p>Queries Per Secondæ„æ€æ˜¯â€œæ¯ç§’æŸ¥è¯¢ç‡â€ï¼Œæ˜¯ä¸€å°æœåŠ¡å™¨æ¯ç§’èƒ½å¤Ÿç›¸åº”çš„æŸ¥è¯¢æ¬¡æ•°ï¼Œæ˜¯å¯¹ä¸€ä¸ªç‰¹å®šçš„æŸ¥è¯¢æœåŠ¡å™¨åœ¨è§„å®šæ—¶é—´å†…æ‰€å¤„ç†æµé‡å¤šå°‘çš„è¡¡é‡æ ‡å‡†ã€‚</p><p>äº’è”ç½‘ä¸­ï¼Œä½œä¸ºåŸŸåç³»ç»ŸæœåŠ¡å™¨çš„æœºå™¨çš„æ€§èƒ½ç»å¸¸ç”¨æ¯ç§’æŸ¥è¯¢ç‡æ¥è¡¡é‡ã€‚</p><p>åŸç†ï¼šæ¯å¤©80%çš„è®¿é—®é›†ä¸­åœ¨20%çš„æ—¶é—´é‡Œï¼Œè¿™20%æ—¶é—´å«åšå³°å€¼æ—¶é—´ã€‚</p><p>å…¬å¼ï¼š( æ€»PVæ•° * 80% ) / ( æ¯å¤©ç§’æ•° * 20% ) = å³°å€¼æ—¶é—´æ¯ç§’è¯·æ±‚æ•°(QPS) ã€‚</p><p>PVï¼ˆpage viewï¼‰å³é¡µé¢æµè§ˆé‡ï¼Œé€šå¸¸æ˜¯è¡¡é‡ä¸€ä¸ªç½‘ç»œæ–°é—»é¢‘é“æˆ–ç½‘ç«™ç”šè‡³ä¸€æ¡ç½‘ç»œæ–°é—»çš„ä¸»è¦æŒ‡æ ‡ã€‚ç½‘é¡µæµè§ˆæ•°æ˜¯è¯„ä»·ç½‘ç«™æµé‡æœ€å¸¸ç”¨çš„æŒ‡æ ‡ä¹‹ä¸€ï¼Œç®€ç§°ä¸ºPVã€‚</p><p>æœºå™¨ï¼šå³°å€¼æ—¶é—´æ¯ç§’QPS / å•å°æœºå™¨çš„QPS = éœ€è¦çš„æœºå™¨ ã€‚</p><p>æ¯å¤©300w PV çš„åœ¨å•å°æœºå™¨ä¸Šï¼Œè¿™å°æœºå™¨éœ€è¦å¤šå°‘QPSï¼Ÿ</p><p><code>( 3000000 * 0.8 ) / (86400 * 0.2 ) = 139 (QPS)ã€‚</code></p><p>ä¸€èˆ¬éœ€è¦è¾¾åˆ°139QPSï¼Œå› ä¸ºæ˜¯å³°å€¼ã€‚(200ä¸‡pvæ‰æœ‰100å³°å€¼qps)</p><h2 id="TPS"><a href="#TPS" class="headerlink" title="TPS"></a>TPS</h2><p>TPSï¼šTransactions Per Secondï¼ˆæ¯ç§’ä¼ è¾“çš„äº‹åŠ¡å¤„ç†ä¸ªæ•°ï¼‰ï¼Œå³æœåŠ¡å™¨æ¯ç§’å¤„ç†çš„äº‹åŠ¡æ•°ã€‚</p><p>TPSåŒ…æ‹¬ä¸€æ¡æ¶ˆæ¯å…¥å’Œä¸€æ¡æ¶ˆæ¯å‡ºï¼ŒåŠ ä¸Šä¸€æ¬¡ç”¨æˆ·æ•°æ®åº“è®¿é—®ã€‚ï¼ˆä¸šåŠ¡TPS = CAPS Ã— æ¯ä¸ªå‘¼å«å¹³å‡TPSï¼‰</p><p>ä¸€ä¸ªäº‹åŠ¡æ˜¯æŒ‡ä¸€ä¸ªå®¢æˆ·æœºå‘æœåŠ¡å™¨å‘é€è¯·æ±‚ç„¶åæœåŠ¡å™¨åšå‡ºååº”çš„è¿‡ç¨‹ã€‚å®¢æˆ·æœºåœ¨å‘é€è¯·æ±‚æ—¶å¼€å§‹è®¡æ—¶ï¼Œæ”¶åˆ°æœåŠ¡å™¨å“åº”åç»“æŸè®¡æ—¶ï¼Œä»¥æ­¤æ¥è®¡ç®—ä½¿ç”¨çš„æ—¶é—´å’Œå®Œæˆçš„äº‹åŠ¡ä¸ªæ•°ã€‚</p><p>ä¸€èˆ¬çš„ï¼Œè¯„ä»·ç³»ç»Ÿæ€§èƒ½å‡ä»¥æ¯ç§’é’Ÿå®Œæˆçš„æŠ€æœ¯äº¤æ˜“çš„æ•°é‡æ¥è¡¡é‡ã€‚ç³»ç»Ÿæ•´ä½“å¤„ç†èƒ½åŠ›å–å†³äºå¤„ç†èƒ½åŠ›æœ€ä½æ¨¡å—çš„TPSå€¼ã€‚</p><h2 id="RTï¼ˆå“åº”æ—¶é•¿ï¼‰"><a href="#RTï¼ˆå“åº”æ—¶é•¿ï¼‰" class="headerlink" title="RTï¼ˆå“åº”æ—¶é•¿ï¼‰"></a>RTï¼ˆå“åº”æ—¶é•¿ï¼‰</h2><p>å“åº”æ—¶é—´ï¼šæ‰§è¡Œä¸€ä¸ªè¯·æ±‚ä»å¼€å§‹åˆ°æœ€åæ”¶åˆ°å“åº”æ•°æ®æ‰€èŠ±è´¹çš„æ€»ä½“æ—¶é—´,å³ä»å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚åˆ°æ”¶åˆ°æœåŠ¡å™¨å“åº”ç»“æœçš„æ—¶é—´ã€‚</p><p>å“åº”æ—¶é—´RT(Response-time)ï¼Œæ˜¯ä¸€ä¸ªç³»ç»Ÿæœ€é‡è¦çš„æŒ‡æ ‡ä¹‹ä¸€ï¼Œå®ƒçš„æ•°å€¼å¤§å°ç›´æ¥ååº”äº†ç³»ç»Ÿçš„å¿«æ…¢ã€‚</p><p>ç›´è§‚ä¸Šçœ‹ï¼Œè¿™ä¸ªæŒ‡æ ‡ä¸äººå¯¹è½¯ä»¶æ€§èƒ½çš„ä¸»è§‚æ„Ÿå—æ˜¯éå¸¸ä¸€è‡´çš„ï¼Œå› ä¸ºå®ƒå®Œæ•´åœ°è®°å½•äº†æ•´ä¸ªè®¡ç®—æœºç³»ç»Ÿå¤„ç†è¯·æ±‚çš„æ—¶é—´ã€‚</p><p>ç”±äºä¸€ä¸ªç³»ç»Ÿé€šå¸¸ä¼šæä¾›è®¸å¤šåŠŸèƒ½ï¼Œè€Œä¸åŒåŠŸèƒ½çš„å¤„ç†é€»è¾‘ä¹Ÿåƒå·®ä¸‡åˆ«ï¼Œå› è€Œä¸åŒåŠŸèƒ½çš„å“åº”æ—¶é—´ä¹Ÿä¸å°½ç›¸åŒï¼Œç”šè‡³åŒä¸€åŠŸèƒ½åœ¨ä¸åŒè¾“å…¥æ•°æ®çš„æƒ…å†µä¸‹å“åº”æ—¶é—´ä¹Ÿä¸ç›¸åŒã€‚</p><p>æ‰€ä»¥ï¼Œåœ¨è®¨è®ºä¸€ä¸ªç³»ç»Ÿçš„å“åº”æ—¶é—´æ—¶ï¼Œäººä»¬é€šå¸¸æ˜¯æŒ‡è¯¥ç³»ç»Ÿæ‰€æœ‰åŠŸèƒ½çš„å¹³å‡æ—¶é—´æˆ–è€…æ‰€æœ‰åŠŸèƒ½çš„æœ€å¤§å“åº”æ—¶é—´ã€‚å½“ç„¶ï¼Œå¾€å¾€ä¹Ÿéœ€è¦å¯¹æ¯ä¸ªæˆ–æ¯ç»„åŠŸèƒ½è®¨è®ºå…¶å¹³å‡å“åº”æ—¶é—´å’Œæœ€å¤§å“åº”æ—¶é—´ã€‚</p><p>å¯¹äºå•æœºçš„æ²¡æœ‰å¹¶å‘æ“ä½œçš„åº”ç”¨ç³»ç»Ÿè€Œè¨€ï¼Œäººä»¬æ™®éè®¤ä¸ºå“åº”æ—¶é—´æ˜¯ä¸€ä¸ªåˆç†ä¸”å‡†ç¡®çš„æ€§èƒ½æŒ‡æ ‡ã€‚éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œå“åº”æ—¶é—´çš„ç»å¯¹å€¼å¹¶ä¸èƒ½ç›´æ¥åæ˜ è½¯ä»¶çš„æ€§èƒ½çš„é«˜ä½ï¼Œè½¯ä»¶æ€§èƒ½çš„é«˜ä½å®é™…ä¸Šå–å†³äºç”¨æˆ·å¯¹è¯¥å“åº”æ—¶é—´çš„æ¥å—ç¨‹åº¦ã€‚</p><p>å¯¹äºä¸€ä¸ªæ¸¸æˆè½¯ä»¶æ¥è¯´ï¼Œå“åº”æ—¶é—´å°äº100æ¯«ç§’åº”è¯¥æ˜¯ä¸é”™çš„ï¼Œå“åº”æ—¶é—´åœ¨1ç§’å·¦å³å¯èƒ½å±äºå‹‰å¼ºå¯ä»¥æ¥å—ï¼Œå¦‚æœå“åº”æ—¶é—´è¾¾åˆ°3ç§’å°±å®Œå…¨éš¾ä»¥æ¥å—äº†ã€‚è€Œå¯¹äºç¼–è¯‘ç³»ç»Ÿæ¥è¯´ï¼Œå®Œæ•´ç¼–è¯‘ä¸€ä¸ªè¾ƒå¤§è§„æ¨¡è½¯ä»¶çš„æºä»£ç å¯èƒ½éœ€è¦å‡ ååˆ†é’Ÿç”šè‡³æ›´é•¿æ—¶é—´ï¼Œä½†è¿™äº›å“åº”æ—¶é—´å¯¹äºç”¨æˆ·æ¥è¯´éƒ½æ˜¯å¯ä»¥æ¥å—çš„</p><h2 id="Loadï¼ˆç³»ç»Ÿè´Ÿè½½ï¼‰"><a href="#Loadï¼ˆç³»ç»Ÿè´Ÿè½½ï¼‰" class="headerlink" title="Loadï¼ˆç³»ç»Ÿè´Ÿè½½ï¼‰"></a>Loadï¼ˆç³»ç»Ÿè´Ÿè½½ï¼‰</h2><p>Linuxçš„Load(ç³»ç»Ÿè´Ÿè½½)ï¼Œæ˜¯ä¸€ä¸ªè®©æ–°æ‰‹ä¸å¤ªå®¹æ˜“äº†è§£çš„æ¦‚å¿µã€‚loadçš„å°±æ˜¯ä¸€å®šæ—¶é—´å†…è®¡ç®—æœºæœ‰å¤šå°‘ä¸ªactive_tasksï¼Œä¹Ÿå°±æ˜¯è¯´æ˜¯è®¡ç®—æœºçš„ä»»åŠ¡æ‰§è¡Œé˜Ÿåˆ—çš„é•¿åº¦ï¼Œcpuè®¡ç®—çš„é˜Ÿåˆ—ã€‚</p><p>top/uptimeç­‰å·¥å…·é»˜è®¤ä¼šæ˜¾ç¤º1åˆ†é’Ÿã€5åˆ†é’Ÿã€15åˆ†é’Ÿçš„å¹³å‡Loadã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œå¹³å‡Loadæ˜¯æŒ‡ï¼Œåœ¨ç‰¹å®šçš„ä¸€æ®µæ—¶é—´å†…ç»Ÿè®¡çš„æ­£åœ¨CPUä¸­è¿è¡Œçš„(RçŠ¶æ€)ã€æ­£åœ¨ç­‰å¾…CPUè¿è¡Œçš„ã€å¤„äºä¸å¯ä¸­æ–­ç¡çœ çš„(DçŠ¶æ€)çš„ä»»åŠ¡æ•°é‡çš„å¹³å‡å€¼ã€‚</p><p>æœ€åï¼Œè¯´ä¸€ä¸‹CPUä½¿ç”¨ç‡å’ŒLoadçš„å…³ç³»å§ã€‚å¦‚æœä¸»è¦æ˜¯CPUå¯†é›†å‹çš„ç¨‹åºåœ¨è¿è¡Œ(If CPU utilization is near 100 percent (user + nice + system), the workload sampled is CPU-bound.)ï¼Œ</p><p>é‚£ä¹ˆCPUåˆ©ç”¨ç‡é«˜ï¼ŒLoadä¸€èˆ¬ä¹Ÿä¼šæ¯”è¾ƒé«˜ã€‚è€ŒI/Oå¯†é›†å‹çš„ç¨‹åºåœ¨è¿è¡Œï¼Œ</p><p>å¯èƒ½çœ‹åˆ°CPUçš„%user, %systeméƒ½ä¸é«˜ï¼Œ%iowaitå¯èƒ½ä¼šæœ‰ç‚¹é«˜ï¼Œè¿™æ—¶çš„Loadé€šå¸¸æ¯”è¾ƒé«˜ã€‚</p><p>åŒç†ï¼Œç¨‹åºè¯»å†™æ…¢é€ŸI/Oè®¾å¤‡(å¦‚ç£ç›˜ã€NFS)æ¯”è¾ƒå¤šæ—¶ï¼ŒLoadå¯èƒ½ä¼šæ¯”è¾ƒé«˜ï¼Œè€ŒCPUåˆ©ç”¨ç‡ä¸ä¸€å®šé«˜ã€‚è¿™ç§æƒ…å†µï¼Œè¿˜ç»å¸¸å‘ç”Ÿåœ¨ç³»ç»Ÿå†…å­˜ä¸è¶³å¹¶å¼€å§‹ä½¿ç”¨swapçš„æ—¶å€™ï¼ŒLoadä¸€èˆ¬ä¼šæ¯”è¾ƒé«˜ï¼Œè€ŒCPUä½¿ç”¨ç‡å¹¶ä¸é«˜ã€‚</p><h2 id="PV"><a href="#PV" class="headerlink" title="PV"></a>PV</h2><p>é¡µé¢è®¿é—®æ¬¡æ•°ï¼šPage View</p><h3 id="UV"><a href="#UV" class="headerlink" title="UV"></a>UV</h3><p>è®¿å®¢æ•°ï¼ˆå»é‡å¤ï¼‰ï¼šUnique Visitor</p><h2 id="å¹¶å‘æ•°"><a href="#å¹¶å‘æ•°" class="headerlink" title="å¹¶å‘æ•°"></a>å¹¶å‘æ•°</h2><p>å¹¶å‘æ•°æ˜¯æŒ‡ç³»ç»ŸåŒæ—¶èƒ½å¤„ç†çš„è¯·æ±‚æ•°é‡ï¼Œè¿™ä¸ªä¹Ÿæ˜¯ååº”äº†ç³»ç»Ÿçš„è´Ÿè½½èƒ½åŠ›ã€‚</p><h2 id="ååé‡"><a href="#ååé‡" class="headerlink" title="ååé‡"></a>ååé‡</h2><p>ç³»ç»Ÿçš„ååé‡ï¼ˆæ‰¿å‹èƒ½åŠ›ï¼‰ä¸requestå¯¹CPUçš„æ¶ˆè€—ã€å¤–éƒ¨æ¥å£ã€IOç­‰ç­‰ç´§å¯†å…³è”ã€‚å•ä¸ªrequest å¯¹CPUæ¶ˆè€—è¶Šé«˜ï¼Œå¤–éƒ¨ç³»ç»Ÿæ¥å£ã€IOé€Ÿåº¦è¶Šæ…¢ï¼Œç³»ç»Ÿååèƒ½åŠ›è¶Šä½ï¼Œåä¹‹è¶Šé«˜ã€‚</p><p>ç³»ç»Ÿååé‡å‡ ä¸ªé‡è¦å‚æ•°ï¼šQPSï¼ˆTPSï¼‰ã€å¹¶å‘æ•°ã€å“åº”æ—¶é—´ã€‚</p><ol><li>QPSï¼ˆTPSï¼‰ï¼šï¼ˆQuery Per Secondï¼‰æ¯ç§’é’Ÿrequest/äº‹åŠ¡ æ•°é‡</li><li>å¹¶å‘æ•°ï¼š ç³»ç»ŸåŒæ—¶å¤„ç†çš„request/äº‹åŠ¡æ•°</li><li>å“åº”æ—¶é—´ï¼š ä¸€èˆ¬å–å¹³å‡å“åº”æ—¶é—´</li></ol><p>ç†è§£äº†ä¸Šé¢ä¸‰ä¸ªè¦ç´ çš„æ„ä¹‰ä¹‹åï¼Œå°±èƒ½æ¨ç®—å‡ºå®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼š</p><ul><li><strong>QPSï¼ˆTPSï¼‰= å¹¶å‘æ•°/å¹³å‡å“åº”æ—¶é—´</strong></li><li><strong>å¹¶å‘æ•° = QPS*å¹³å‡å“åº”æ—¶é—´</strong></li></ul><h2 id="æœ€ä½³çº¿ç¨‹æ•°ã€QPSã€RT"><a href="#æœ€ä½³çº¿ç¨‹æ•°ã€QPSã€RT" class="headerlink" title="æœ€ä½³çº¿ç¨‹æ•°ã€QPSã€RT"></a>æœ€ä½³çº¿ç¨‹æ•°ã€QPSã€RT</h2><p><strong>1ã€å•çº¿ç¨‹QPSå…¬å¼ï¼šQPS=1000ms/RT</strong><br>å¯¹åŒä¸€ä¸ªç³»ç»Ÿè€Œè¨€ï¼Œæ”¯æŒçš„çº¿ç¨‹æ•°è¶Šå¤šï¼ŒQPSè¶Šé«˜ã€‚å‡è®¾ä¸€ä¸ªRTæ˜¯80ms,åˆ™å¯ä»¥å¾ˆå®¹æ˜“çš„è®¡ç®—å‡ºQPS,QPS = 1000/80 = 12.5<br>å¤šçº¿ç¨‹åœºæ™¯ï¼Œå¦‚æœæŠŠæœåŠ¡ç«¯çš„çº¿ç¨‹æ•°æå‡åˆ°2ï¼Œé‚£ä¹ˆæ•´ä¸ªç³»ç»Ÿçš„QPSåˆ™ä¸º 2*ï¼ˆ1000/80ï¼‰ = 25, å¯è§QPSéšç€çº¿ç¨‹çš„å¢åŠ è€Œçº¿æ€§å¢é•¿ï¼Œé‚£QPSä¸Šä¸å»å°±åŠ çº¿ç¨‹å‘—ï¼Œå¬èµ·æ¥å¾ˆæœ‰é“ç†ï¼Œå…¬å¸ä¹Ÿè¯´çš„é€šï¼Œä½†æ˜¯å¾€å¾€ç°å®å¹¶éå¦‚æ­¤ã€‚</p><p><strong>2ã€æœ€ä½³çº¿ç¨‹æ•°é‡</strong><br>åˆšå¥½æ¶ˆè€—å®ŒæœåŠ¡å™¨çš„ç“¶é¢ˆèµ„æºçš„ä¸´ç•Œçº¿ç¨‹æ•°ï¼Œå…¬å¼å¦‚ä¸‹<br>æœ€ä½³çº¿ç¨‹æ•°é‡=ï¼ˆï¼ˆçº¿ç¨‹ç­‰å¾…æ—¶é—´+çº¿ç¨‹cpuæ—¶é—´ï¼‰/ çº¿ç¨‹cpuæ—¶é—´ï¼‰* cpuæ•°é‡<br>ç‰¹æ€§ï¼š</p><ul><li>åœ¨è¾¾åˆ°æœ€ä½³çº¿ç¨‹æ•°çš„æ—¶å€™ï¼Œçº¿ç¨‹æ•°é‡ç»§ç»­é€’å¢ï¼Œåˆ™QPSä¸å˜ï¼Œè€Œå“åº”æ—¶é—´å˜é•¿ï¼ŒæŒç»­é€’å¢çº¿ç¨‹æ•°é‡ï¼Œåˆ™QPSå¼€å§‹ä¸‹é™ã€‚</li><li>æ¯ä¸ªç³»ç»Ÿéƒ½æœ‰å…¶æœ€ä½³çº¿ç¨‹æ•°é‡ï¼Œä½†æ˜¯ä¸åŒçŠ¶æ€ä¸‹ï¼Œæœ€ä½³çº¿ç¨‹æ•°é‡æ˜¯ä¼šå˜åŒ–çš„ã€‚</li><li>ç“¶é¢ˆèµ„æºå¯ä»¥æ˜¯CPU,å¯ä»¥æ˜¯å†…å­˜ï¼Œå¯ä»¥æ˜¯é”èµ„æºï¼ŒIOèµ„æºï¼šè¶…è¿‡æœ€ä½³çº¿ç¨‹æ•°-å¯¼è‡´èµ„æºçš„ç«äº‰ï¼Œè¶…è¿‡æœ€ä½³çº¿ç¨‹æ•°-å“åº”æ—¶é—´é€’å¢ã€‚</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;QPS&quot;&gt;&lt;a href=&quot;#QPS&quot; class=&quot;headerlink&quot; title=&quot;QPS&quot;&gt;&lt;/a&gt;QPS&lt;/h2&gt;&lt;p&gt;Queries Per Secondæ„æ€æ˜¯â€œæ¯ç§’æŸ¥è¯¢ç‡â€ï¼Œæ˜¯ä¸€å°æœåŠ¡å™¨æ¯ç§’èƒ½å¤Ÿç›¸åº”çš„æŸ¥è¯¢æ¬¡æ•°ï¼Œæ˜¯å¯¹ä¸€ä¸ªç‰¹å®šçš„æŸ¥è¯¢æœåŠ¡å™¨åœ¨è§„å®šæ—¶é—´å†…æ‰€</summary>
      
    
    
    
    
    <category term="é«˜å¹¶å‘" scheme="http://example.com/tags/%E9%AB%98%E5%B9%B6%E5%8F%91/"/>
    
    <category term="æ€§èƒ½æŒ‡æ ‡" scheme="http://example.com/tags/%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87/"/>
    
  </entry>
  
  <entry>
    <title>MySQL-åŸºæœ¬æ¶æ„åŠåŸç†</title>
    <link href="http://example.com/wiki/MySQL-%E5%9F%BA%E6%9C%AC%E6%9E%B6%E6%9E%84%E5%8F%8A%E5%8E%9F%E7%90%86/"/>
    <id>http://example.com/wiki/MySQL-%E5%9F%BA%E6%9C%AC%E6%9E%B6%E6%9E%84%E5%8F%8A%E5%8E%9F%E7%90%86/</id>
    <published>2021-08-26T03:51:47.000Z</published>
    <updated>2021-08-26T03:53:20.235Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210826115314566.png" alt="image-20210826115314566"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210826115314566.png&quot; alt=&quot;image-20210826115314566&quot;&gt;&lt;/p&gt;
</summary>
      
    
    
    
    
    <category term="MySQL" scheme="http://example.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>ç”¨äº†é‚£ä¹ˆä¹…MySQLï¼Œæˆ‘ç«Ÿç„¶ä¸çŸ¥é“ICP</title>
    <link href="http://example.com/wiki/MySQL-%E7%B4%A2%E5%BC%95%E6%9D%A1%E4%BB%B6%E4%B8%8B%E6%8E%A8ICP/"/>
    <id>http://example.com/wiki/MySQL-%E7%B4%A2%E5%BC%95%E6%9D%A1%E4%BB%B6%E4%B8%8B%E6%8E%A8ICP/</id>
    <published>2021-08-26T03:37:16.000Z</published>
    <updated>2021-08-26T10:34:17.437Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç”¨äº†é‚£ä¹ˆä¹…MySQLï¼Œæˆ‘ç«Ÿç„¶ä¸çŸ¥é“ICP"><a href="#ç”¨äº†é‚£ä¹ˆä¹…MySQLï¼Œæˆ‘ç«Ÿç„¶ä¸çŸ¥é“ICP" class="headerlink" title="ç”¨äº†é‚£ä¹ˆä¹…MySQLï¼Œæˆ‘ç«Ÿç„¶ä¸çŸ¥é“ICP"></a>ç”¨äº†é‚£ä¹ˆä¹…MySQLï¼Œæˆ‘ç«Ÿç„¶ä¸çŸ¥é“ICP</h1><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>å¼€å¯ICPï¼Œå¦‚æœéƒ¨åˆ†WHEREæ¡ä»¶èƒ½ä½¿ç”¨ç´¢å¼•ä¸­çš„å­—æ®µï¼ŒMySQL Server ä¼šæŠŠè¿™éƒ¨åˆ†ä¸‹æ¨åˆ°å­˜å‚¨å¼•æ“å±‚ï¼Œå­˜å‚¨å¼•æ“é€šè¿‡ç´¢å¼•è¿‡æ»¤ï¼ŒæŠŠæ»¡è¶³çš„è¡Œä»è¡¨ä¸­è¯»å–å‡ºã€‚ICPèƒ½å‡å°‘å¼•æ“å±‚è®¿é—®åŸºè¡¨çš„æ¬¡æ•°å’ŒMySQL Server è®¿é—®å­˜å‚¨å¼•æ“çš„æ¬¡æ•°ã€‚</p><p>ICP ä¼˜åŒ–çš„å…¨ç§°æ˜¯ Index Condition Pushdown Optimization ã€‚</p><p>ICP ä¼˜åŒ–é€‚ç”¨äº MySQL åˆ©ç”¨ç´¢å¼•ä»è¡¨é‡Œæ£€ç´¢æ•°æ®çš„åœºæ™¯ã€‚</p><hr><p>ç»è¿‡å­¦ä¹ äº†ICPä¹‹åæˆ‘å¤§æ¦‚å¯¹ICPæœ‰äº†åˆæ­¥çš„ç†è§£ ğŸ‘‡</p><h3 id="å…³é—­ICPæƒ…å†µä¸‹çš„æŸ¥è¯¢æµç¨‹"><a href="#å…³é—­ICPæƒ…å†µä¸‹çš„æŸ¥è¯¢æµç¨‹" class="headerlink" title="å…³é—­ICPæƒ…å†µä¸‹çš„æŸ¥è¯¢æµç¨‹"></a>å…³é—­ICPæƒ…å†µä¸‹çš„æŸ¥è¯¢æµç¨‹</h3><p>ç¦ç”¨ICPï¼Œå­˜å‚¨å¼•æ“ä¼šé€šè¿‡éå†ç´¢å¼•å®šä½åŸºè¡¨ä¸­çš„è¡Œï¼Œç„¶åè¿”å›ç»™MySQL Serverå±‚ï¼Œå†å»ä¸ºè¿™äº›æ•°æ®è¡Œè¿›è¡ŒWHEREåçš„æ¡ä»¶çš„è¿‡æ»¤ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210826183031500.png" alt="image-20210826183031500"></p><h3 id="å¼€å¯ICPä¹‹åçš„æ‰§è¡Œæµç¨‹"><a href="#å¼€å¯ICPä¹‹åçš„æ‰§è¡Œæµç¨‹" class="headerlink" title="å¼€å¯ICPä¹‹åçš„æ‰§è¡Œæµç¨‹"></a>å¼€å¯ICPä¹‹åçš„æ‰§è¡Œæµç¨‹</h3><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210826183050694.png" alt="image-20210826183050694"></p><p>ä¸€å¼€å§‹æˆ‘å¯¹äº <strong>ICPåªèƒ½ä½¿ç”¨äºäºŒçº§ç´¢å¼•ï¼Œè€Œä¸èƒ½ç”¨äºä¸»é”®ç´¢å¼•</strong>è¿™ä¸€é™åˆ¶ä¸å¤ªç†è§£ã€‚é‚£æ˜¯å› ä¸ºæˆ‘æ²¡æœ‰è¯¥æ˜ç™½ICPåˆ°åº•æ˜¯å¹²ä»€ä¹ˆçš„ï¼Ÿ</p><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210826171730637.png" alt="image-20210826171730637"></p><p>æˆ‘ä»¬è¿™è¾¹ç”¨ä¸€äº›åˆ«äººçš„å›¾æ–¹ä¾¿ç†è§£ã€‚</p><p><strong>ICPèƒ½å‡å°‘å¼•æ“å±‚è®¿é—®åŸºè¡¨çš„æ¬¡æ•°å’ŒMySQL Server è®¿é—®å­˜å‚¨å¼•æ“çš„æ¬¡æ•°ã€‚</strong></p><p>è¿™æ˜¯ICPçš„å…³é”®ç›®çš„ï¼Œä¸ºä»€ä¹ˆèƒ½å‡å°‘å¼•æ“å¯¹äºåŸºè¡¨çš„è®¿é—®å‘¢ï¼Ÿå› ä¸ºICPåœ¨å¼•æ“å±‚æ‰§è¡Œäº†é¢å¤–çš„è¿‡æ»¤å’Œç­›é€‰ï¼Œä½¿å¾—å¤§é‡çš„æ— æ•ˆæ•°æ®æŸ¥è¯¢åŸºè¡¨ã€‚</p><p>å› ä¸ºæ˜¯äºŒçº§ç´¢å¼•ï¼Œéœ€è¦æ ¹æ®ä¸»é”®idå»è·å–åˆ°æ•´è¡Œçš„æ•°æ®ã€‚</p><hr><h2 id="ICP-åŸç†"><a href="#ICP-åŸç†" class="headerlink" title="ICP åŸç†"></a>ICP åŸç†</h2><p>ä»¥ InnoDB è¡¨ä¸ºä¾‹ã€‚</p><p>åœ¨ä¸å¯ç”¨ ICP çš„æƒ…å†µä¸‹åˆ©ç”¨äºŒçº§ç´¢å¼•æŸ¥æ‰¾æ•°æ®çš„è¿‡ç¨‹ï¼š</p><ol><li>ç”¨äºŒçº§ç´¢å¼•æŸ¥æ‰¾æ•°æ®çš„ä¸»é”®ï¼›</li><li>ç”¨ä¸»é”®å›è¡¨è¯»å–å®Œæ•´çš„è¡Œè®°å½•ï¼›</li><li>åˆ©ç”¨ where è¯­å¥çš„æ¡ä»¶å¯¹è¡Œè®°å½•è¿›è¡Œè¿‡æ»¤ã€‚</li></ol><p>å¯ç”¨ ICP çš„æƒ…å†µä¸‹åˆ©ç”¨äºŒçº§ç´¢å¼•æŸ¥æ‰¾æ•°æ®çš„è¿‡ç¨‹ä¸ºï¼š</p><ol><li>ç”¨äºŒçº§ç´¢å¼•æŸ¥æ‰¾æ•°æ®çš„ä¸»é”®ï¼›</li><li>å¦‚æœäºŒçº§ç´¢å¼•è®°å½•çš„å…ƒç»„é‡Œçš„åˆ—å‡ºç°åœ¨ where æ¡ä»¶é‡Œï¼Œé‚£ä¹ˆå¯¹å…ƒç»„è¿›è¡Œè¿‡æ»¤ï¼›</li><li>å¯¹ç´¢å¼•å…ƒç»„çš„ä¸»é”®å›è¡¨è¯»å–å®Œæ•´çš„è¡Œè®°å½•ï¼›</li><li>åˆ©ç”¨ where è¯­å¥çš„å‰©ä½™æ¡ä»¶å¯¹è¡Œè®°å½•è¿›è¡Œè¿‡æ»¤ï¼›</li></ol><p>ICP é€‚ç”¨çš„ä¸€ä¸ªéšå«å‰ææ˜¯äºŒçº§ç´¢å¼•å¿…é¡»æ˜¯ç»„åˆç´¢å¼•ã€ä¸”åœ¨ä½¿ç”¨ç´¢å¼•è¿›è¡Œæ‰«ææ—¶åªèƒ½é‡‡ç”¨æœ€å·¦å‰ç¼€åŒ¹é…åŸåˆ™ã€‚ç»„åˆç´¢å¼•åé¢çš„åˆ—å‡ºç°åœ¨ where æ¡ä»¶é‡Œï¼Œå› æ­¤å¯ä»¥å…ˆè¿‡æ»¤ç´¢å¼•å…ƒç»„ã€ä»è€Œå‡å°‘å›è¡¨è¯»çš„æ•°é‡ã€‚</p><h2 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h2><p>å¯¹äºç»„åˆç´¢å¼• <code>INDEX (zipcode, lastname, firstname)</code>ï¼Œä¸‹é¢çš„ SQL æ ¹æ®æœ€å·¦å‰ç¼€åŸåˆ™ï¼Œåªèƒ½ä½¿ç”¨åˆ°ç´¢å¼•çš„ç¬¬ä¸€åˆ— <code>zipcode</code>ï¼Œç´¢å¼•çš„å¦ä¸€åˆ— <code>lastname</code> å‡ºç°åœ¨ where æ¡ä»¶é‡Œï¼Œå¯ä»¥é‡‡ç”¨ ICP å¯¹ç´¢å¼•çš„å…ƒç»„è¿›è¡Œè¿‡æ»¤ï¼Œå³åº”ç”¨ <code>lastname LIKE &#39;%etrunia%&#39;</code> æ¡ä»¶ï¼›ç„¶åå†å›è¡¨è¯»å–å®Œæˆçš„è¡Œè®°å½•ï¼Œå†å¯¹è¡Œè®°å½•åº”ç”¨ <code>address LIKE &#39;%Main Street%&#39;</code> æ¡ä»¶ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> people</span><br><span class="line"><span class="keyword">WHERE</span> zipcode<span class="operator">=</span><span class="string">&#x27;95054&#x27;</span></span><br><span class="line"><span class="keyword">AND</span> lastname <span class="keyword">LIKE</span> <span class="string">&#x27;%etrunia%&#x27;</span></span><br><span class="line"><span class="keyword">AND</span> address <span class="keyword">LIKE</span> <span class="string">&#x27;%Main Street%&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="ICPä½¿ç”¨é™åˆ¶"><a href="#ICPä½¿ç”¨é™åˆ¶" class="headerlink" title="ICPä½¿ç”¨é™åˆ¶"></a>ICPä½¿ç”¨é™åˆ¶</h3><p>1 å½“sqléœ€è¦å…¨è¡¨è®¿é—®æ—¶,ICPçš„ä¼˜åŒ–ç­–ç•¥å¯ç”¨äºrange, ref, eq_ref, ref_or_null ç±»å‹çš„è®¿é—®æ•°æ®æ–¹æ³• ã€‚</p><p>2 æ”¯æŒInnoDBå’ŒMyISAMè¡¨ã€‚</p><p>3 ICPåªèƒ½ç”¨äºäºŒçº§ç´¢å¼•ï¼Œä¸èƒ½ç”¨äºä¸»ç´¢å¼•ã€‚</p><p>4 å¹¶éå…¨éƒ¨whereæ¡ä»¶éƒ½å¯ä»¥ç”¨ICPç­›é€‰ã€‚<br>  å¦‚æœwhereæ¡ä»¶çš„å­—æ®µä¸åœ¨ç´¢å¼•åˆ—ä¸­,è¿˜æ˜¯è¦è¯»å–æ•´è¡¨çš„è®°å½•åˆ°serverç«¯åšwhereè¿‡æ»¤ã€‚</p><p>5 ICPçš„åŠ é€Ÿæ•ˆæœå–å†³äºåœ¨å­˜å‚¨å¼•æ“å†…é€šè¿‡ICPç­›é€‰æ‰çš„æ•°æ®çš„æ¯”ä¾‹ã€‚</p><p>6 5.6 ç‰ˆæœ¬çš„ä¸æ”¯æŒåˆ†è¡¨çš„ICP åŠŸèƒ½ï¼Œ5.7 ç‰ˆæœ¬çš„å¼€å§‹æ”¯æŒã€‚</p><p>7 å½“sql ä½¿ç”¨è¦†ç›–ç´¢å¼•æ—¶ï¼Œä¸æ”¯æŒICP ä¼˜åŒ–æ–¹æ³•ã€‚</p><h2 id="å¦‚ä½•æŸ¥çœ‹æ˜¯å¦å¼€å¯äº†ICP"><a href="#å¦‚ä½•æŸ¥çœ‹æ˜¯å¦å¼€å¯äº†ICP" class="headerlink" title="å¦‚ä½•æŸ¥çœ‹æ˜¯å¦å¼€å¯äº†ICP"></a>å¦‚ä½•æŸ¥çœ‹æ˜¯å¦å¼€å¯äº†ICP</h2><p><code>show variables like &#39;optimizer_switch&#39;;</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index_merge<span class="operator">=</span><span class="keyword">on</span>,index_merge_union<span class="operator">=</span><span class="keyword">on</span>,index_merge_sort_union<span class="operator">=</span><span class="keyword">on</span>,index_merge_intersection<span class="operator">=</span><span class="keyword">on</span>,engine_condition_pushdown<span class="operator">=</span><span class="keyword">on</span>,index_condition_pushdown<span class="operator">=</span><span class="keyword">on</span>,mrr<span class="operator">=</span><span class="keyword">on</span>,mrr_cost_based<span class="operator">=</span><span class="keyword">on</span>,block_nested_loop<span class="operator">=</span><span class="keyword">on</span>,batched_key_access<span class="operator">=</span>off,materialization<span class="operator">=</span><span class="keyword">on</span>,semijoin<span class="operator">=</span><span class="keyword">on</span>,loosescan<span class="operator">=</span><span class="keyword">on</span>,firstmatch<span class="operator">=</span><span class="keyword">on</span>,duplicateweedout<span class="operator">=</span><span class="keyword">on</span>,subquery_materialization_cost_based<span class="operator">=</span><span class="keyword">on</span>,use_index_extensions<span class="operator">=</span><span class="keyword">on</span>,condition_fanout_filter<span class="operator">=</span><span class="keyword">on</span>,derived_merge<span class="operator">=</span><span class="keyword">on</span>,use_invisible_indexes<span class="operator">=</span>off,skip_scan<span class="operator">=</span><span class="keyword">on</span>,hash_join<span class="operator">=</span><span class="keyword">on</span>,subquery_to_derived<span class="operator">=</span>off,prefer_ordering_index<span class="operator">=</span><span class="keyword">on</span>,hypergraph_optimizer<span class="operator">=</span>off,derived_condition_pushdown<span class="operator">=</span><span class="keyword">on</span></span><br></pre></td></tr></table></figure><h2 id="ä»€ä¹ˆæ˜¯äºŒçº§ç´¢å¼•"><a href="#ä»€ä¹ˆæ˜¯äºŒçº§ç´¢å¼•" class="headerlink" title="ä»€ä¹ˆæ˜¯äºŒçº§ç´¢å¼•"></a>ä»€ä¹ˆæ˜¯äºŒçº§ç´¢å¼•</h2><h3 id="1ã€ä¸€çº§ç´¢å¼•"><a href="#1ã€ä¸€çº§ç´¢å¼•" class="headerlink" title="1ã€ä¸€çº§ç´¢å¼•"></a>1ã€ä¸€çº§ç´¢å¼•</h3><p>ç´¢å¼•å’Œæ•°æ®å­˜å‚¨åœ¨ä¸€èµ·ï¼Œéƒ½å­˜å‚¨åœ¨åŒä¸€ä¸ªB+treeä¸­çš„å¶å­èŠ‚ç‚¹ã€‚ä¸€èˆ¬ä¸»é”®ç´¢å¼•éƒ½æ˜¯ä¸€çº§ç´¢å¼•ã€‚</p><h3 id="2ã€äºŒçº§ç´¢å¼•"><a href="#2ã€äºŒçº§ç´¢å¼•" class="headerlink" title="2ã€äºŒçº§ç´¢å¼•"></a>2ã€äºŒçº§ç´¢å¼•</h3><p>äºŒçº§ç´¢å¼•æ ‘çš„å¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯ä¸»é”®è€Œä¸æ˜¯æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ‰¾åˆ°ç´¢å¼•åï¼Œå¾—åˆ°å¯¹åº”çš„ä¸»é”®ï¼Œå†å›åˆ°ä¸€çº§ç´¢å¼•ä¸­æ‰¾ä¸»é”®å¯¹åº”çš„æ•°æ®è®°å½•ã€‚</p><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p><a href="https://mp.weixin.qq.com/s/ygvuP35B_sJAlBHuuEJhfg">https://mp.weixin.qq.com/s/ygvuP35B_sJAlBHuuEJhfg</a></p><p><a href="https://mp.weixin.qq.com/s/Vv1gNLh1aLCLDJfEYXvr-g">https://mp.weixin.qq.com/s/Vv1gNLh1aLCLDJfEYXvr-g</a></p><p><a href="https://blog.51cto.com/qhd2004/1870996?source=drt">https://blog.51cto.com/qhd2004/1870996?source=drt</a></p><p><a href="https://blog.csdn.net/thesprit/article/details/112989674">äºŒçº§ç´¢å¼•æ£€ç´¢è¿‡ç¨‹</a></p><p><a href="https://zhuanlan.zhihu.com/p/137647823">https://zhuanlan.zhihu.com/p/137647823</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ç”¨äº†é‚£ä¹ˆä¹…MySQLï¼Œæˆ‘ç«Ÿç„¶ä¸çŸ¥é“ICP&quot;&gt;&lt;a href=&quot;#ç”¨äº†é‚£ä¹ˆä¹…MySQLï¼Œæˆ‘ç«Ÿç„¶ä¸çŸ¥é“ICP&quot; class=&quot;headerlink&quot; title=&quot;ç”¨äº†é‚£ä¹ˆä¹…MySQLï¼Œæˆ‘ç«Ÿç„¶ä¸çŸ¥é“ICP&quot;&gt;&lt;/a&gt;ç”¨äº†é‚£ä¹ˆä¹…MySQLï¼Œæˆ‘ç«Ÿç„¶ä¸çŸ¥é“ICP&lt;/h1&gt;&lt;</summary>
      
    
    
    
    
    <category term="MySQL" scheme="http://example.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>MySQL-InnoDBæ¶æ„</title>
    <link href="http://example.com/wiki/MySQL-InnoDB%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E5%BA%95%E5%B1%82%E7%BB%93%E6%9E%84%E7%BA%A7%E5%8E%9F%E7%90%86/"/>
    <id>http://example.com/wiki/MySQL-InnoDB%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E5%BA%95%E5%B1%82%E7%BB%93%E6%9E%84%E7%BA%A7%E5%8E%9F%E7%90%86/</id>
    <published>2021-08-26T02:12:37.000Z</published>
    <updated>2021-08-26T10:51:05.124Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Innodbæ¶æ„"><a href="#Innodbæ¶æ„" class="headerlink" title="Innodbæ¶æ„"></a>Innodbæ¶æ„</h1><p>å­˜å‚¨å¼•æ“æ˜¯MySQLéå¸¸é‡è¦çš„ç»„æˆéƒ¨åˆ†ï¼Œå®ƒç›´æ¥å½±å“äº†ä¸€ä¸ªæ•°æ®åº“çš„æ€§èƒ½ï¼Œæ˜¯MySQLçš„ç»å¯¹æ ¸å¿ƒã€‚</p><p>ä¸‹é¢æ˜¯InnoDBçš„ç»“æ„å›¾ ğŸ‘‡</p><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210826101756286.png" alt="image-20210826101756286"></p><p>ä»ä¸Šé¢ç¬¬äºŒå¼ å›¾å¯ä»¥çœ‹åˆ°ï¼ŒInnoDB ä¸»è¦åˆ†ä¸ºä¸¤å¤§å—ï¼š</p><ul><li>InnoDB In-Memory Structures</li><li>InnoDB On-Disk Structures</li></ul><p>å†…å­˜å’Œç£ç›˜ï¼Œè®©æˆ‘ä»¬å…ˆä»å†…å­˜å¼€å§‹ã€‚</p><h2 id="In-Memory-Structureså†…å­˜æ¨¡å—"><a href="#In-Memory-Structureså†…å­˜æ¨¡å—" class="headerlink" title="In-Memory Structureså†…å­˜æ¨¡å—"></a>In-Memory Structureså†…å­˜æ¨¡å—</h2><h3 id="Buffer-Pool"><a href="#Buffer-Pool" class="headerlink" title="Buffer Pool"></a>Buffer Pool</h3><p>æ­£å¦‚ä¹‹å‰æåˆ°çš„ï¼Œ<font color=blue>MySQL ä¸ä¼šç›´æ¥å»ä¿®æ”¹ç£ç›˜çš„æ•°æ®ï¼Œå› ä¸ºè¿™æ ·åšå¤ªæ…¢äº†</font>ï¼ŒMySQL ä¼šå…ˆæ”¹å†…å­˜ï¼Œç„¶åè®°å½• redo logï¼Œç­‰æœ‰ç©ºäº†å†åˆ·ç£ç›˜ï¼Œå¦‚æœå†…å­˜é‡Œæ²¡æœ‰æ•°æ®ï¼Œå°±å»ç£ç›˜ loadã€‚</p><p>è€Œè¿™äº›æ•°æ®å­˜æ”¾çš„åœ°æ–¹ï¼Œå°±æ˜¯ Buffer Poolã€‚</p><p>æˆ‘ä»¬å¹³æ—¶å¼€å‘æ—¶ï¼Œä¼šç”¨ redis æ¥åšç¼“å­˜ï¼Œç¼“è§£æ•°æ®åº“å‹åŠ›ï¼Œå…¶å® MySQL è‡ªå·±ä¹Ÿåšäº†ä¸€å±‚ç±»ä¼¼ç¼“å­˜çš„ä¸œè¥¿ã€‚</p><p>MySQL æ˜¯ä»¥ã€Œé¡µã€ï¼ˆpageï¼‰ä¸ºå•ä½ä»ç£ç›˜è¯»å–æ•°æ®çš„ï¼ŒBuffer Pool é‡Œçš„æ•°æ®ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå®é™…ä¸Šï¼ŒBuffer Pool æ˜¯<code>a linked list of pages</code>ï¼Œä¸€ä¸ªä»¥é¡µä¸ºå…ƒç´ çš„é“¾è¡¨ã€‚</p><p>ä¸ºä»€ä¹ˆæ˜¯é“¾è¡¨ï¼Ÿå› ä¸ºå’Œç¼“å­˜ä¸€æ ·ï¼Œå®ƒä¹Ÿéœ€è¦ä¸€å¥—æ·˜æ±°ç®—æ³•æ¥ç®¡ç†æ•°æ®ã€‚Buffer Pool é‡‡ç”¨åŸºäº LRUï¼ˆleast recently usedï¼‰ çš„ç®—æ³•æ¥ç®¡ç†å†…å­˜ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210826102246153.png" alt="image-20210826102246153"></p><p><strong>B+æ ‘ä¸­ä¸€ä¸ªèŠ‚ç‚¹ä¸ºä¸€é¡µæˆ–é¡µçš„å€æ•°æœ€ä¸ºåˆé€‚</strong>ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>å› ä¸ºå¦‚æœä¸€ä¸ªèŠ‚ç‚¹çš„å¤§å°å°äº1é¡µï¼Œé‚£ä¹ˆè¯»å–è¿™ä¸ªèŠ‚ç‚¹çš„æ—¶å€™å…¶å®ä¹Ÿä¼šè¯»å‡º1é¡µï¼Œé€ æˆèµ„æºçš„æµªè´¹ã€‚</p><p>å¦‚æœä¸€ä¸ªèŠ‚ç‚¹çš„å¤§å°å¤§äº1é¡µï¼Œæ¯”å¦‚1.2é¡µï¼Œé‚£ä¹ˆè¯»å–è¿™ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ä¼šè¯»å‡º2é¡µï¼Œä¹Ÿä¼šé€ æˆèµ„æºçš„æµªè´¹ã€‚</p><p>æ‰€ä»¥ä¸ºäº†ä¸é€ æˆæµªè´¹ï¼Œæ‰€ä»¥æœ€åæŠŠä¸€ä¸ªèŠ‚ç‚¹çš„å¤§å°æ§åˆ¶åœ¨1é¡µã€2é¡µã€3é¡µã€4é¡µç­‰å€æ•°é¡µå¤§å°æœ€ä¸ºåˆé€‚ã€‚</p><ul><li><strong>å„ä¸ªæ•°æ®é¡µ</strong>å¯ä»¥ç»„æˆä¸€ä¸ª<strong>åŒå‘é“¾è¡¨</strong></li><li>è€Œ<strong>æ¯ä¸ªæ•°æ®é¡µä¸­çš„è®°å½•</strong>åˆå¯ä»¥ç»„æˆä¸€ä¸ª<strong>å•å‘</strong>é“¾è¡¨</li><li>æ¯ä¸ªæ•°æ®é¡µéƒ½ä¼šä¸ºå­˜å‚¨åœ¨å®ƒé‡Œè¾¹å„¿çš„è®°å½•ç”Ÿæˆä¸€ä¸ª<strong>é¡µç›®å½•</strong>ï¼Œåœ¨é€šè¿‡<strong>ä¸»é”®</strong>æŸ¥æ‰¾æŸæ¡è®°å½•çš„æ—¶å€™å¯ä»¥åœ¨é¡µç›®å½•ä¸­ä½¿ç”¨<strong>äºŒåˆ†æ³•å¿«é€Ÿå®šä½</strong>åˆ°å¯¹åº”çš„æ§½ï¼Œç„¶åå†éå†è¯¥æ§½å¯¹åº”åˆ†ç»„ä¸­çš„è®°å½•å³å¯å¿«é€Ÿæ‰¾åˆ°æŒ‡å®šçš„è®°å½•</li><li>ä»¥<strong>å…¶ä»–åˆ—</strong>(éä¸»é”®)ä½œä¸ºæœç´¢æ¡ä»¶ï¼šåªèƒ½ä»æœ€å°è®°å½•å¼€å§‹<strong>ä¾æ¬¡éå†å•é“¾è¡¨ä¸­çš„æ¯æ¡è®°å½•</strong>ã€‚</li></ul><p>æ‰€ä»¥è¯´ï¼Œå¦‚æœæˆ‘ä»¬å†™ select * from user where username=â€™å°æ˜â€™ è¿™æ ·æ²¡æœ‰è¿›è¡Œä»»ä½•ä¼˜åŒ–çš„sqlè¯­å¥ï¼Œé»˜è®¤ä¼šè¿™æ ·åšï¼š</p><ul><li>å®šä½åˆ°è®°å½•æ‰€åœ¨çš„é¡µ</li><li>éœ€è¦éå†åŒå‘é“¾è¡¨ï¼Œæ‰¾åˆ°æ‰€åœ¨çš„é¡µ</li><li>ä»æ‰€åœ¨çš„é¡µå†…ä¸­æŸ¥æ‰¾ç›¸åº”çš„è®°å½•</li><li> ç”±äºä¸æ˜¯æ ¹æ®ä¸»é”®æŸ¥è¯¢ï¼Œåªèƒ½éå†æ‰€åœ¨é¡µçš„å•é“¾è¡¨äº†</li></ul><h3 id="Change-Buffer"><a href="#Change-Buffer" class="headerlink" title="Change Buffer"></a><strong>Change Buffer</strong></h3><p>change bufferå­˜æ”¾åœ¨Buffer Poolä¸­ã€‚</p><p>ä¸Šé¢æåˆ°è¿‡ï¼Œå¦‚æœå†…å­˜é‡Œæ²¡æœ‰å¯¹åº”ã€Œé¡µã€çš„æ•°æ®ï¼ŒMySQL å°±ä¼šå»æŠŠæ•°æ®ä»ç£ç›˜é‡Œ load å‡ºæ¥ï¼Œå¦‚æœæ¯æ¬¡éœ€è¦çš„ã€Œé¡µã€éƒ½ä¸åŒï¼Œæˆ–è€…ä¸æ˜¯ç›¸é‚»çš„ã€Œé¡µã€ï¼Œé‚£ä¹ˆæ¯æ¬¡ MySQL éƒ½è¦å» loadï¼Œè¿™æ ·å°±å¾ˆæ…¢äº†ã€‚</p><p>äºæ˜¯å¦‚æœ MySQL å‘ç°ä½ è¦ä¿®æ”¹çš„é¡µï¼Œä¸åœ¨å†…å­˜é‡Œï¼Œå°±æŠŠä½ è¦å¯¹é¡µçš„ä¿®æ”¹ï¼Œå…ˆè®°åˆ°ä¸€ä¸ªå« Change Buffer çš„åœ°æ–¹ï¼ŒåŒæ—¶è®°å½• redo logï¼Œç„¶åå†æ…¢æ…¢æŠŠæ•°æ® load åˆ°å†…å­˜ï¼Œload è¿‡æ¥åï¼Œå†æŠŠ Change Buffer é‡Œè®°å½•çš„ä¿®æ”¹ï¼Œåº”ç”¨åˆ°å†…å­˜ï¼ˆBuffer Poolï¼‰ä¸­ï¼Œè¿™ä¸ªåŠ¨ä½œå«åš <strong>merge</strong>ï¼›è€ŒæŠŠå†…å­˜æ•°æ®åˆ·åˆ°ç£ç›˜çš„åŠ¨ä½œï¼Œå« <strong>purge</strong>ï¼š</p><ul><li><strong>mergeï¼šChange Buffer -&gt; Buffer Pool</strong></li><li><strong>purgeï¼šBuffer Pool -&gt; Disk</strong></li></ul><h3 id="Adaptive-Hash-Index"><a href="#Adaptive-Hash-Index" class="headerlink" title="Adaptive Hash Index"></a><strong>Adaptive Hash Index</strong></h3><p>MySQL ç´¢å¼•ï¼Œä¸ç®¡æ˜¯åœ¨ç£ç›˜é‡Œï¼Œè¿˜æ˜¯è¢« load åˆ°å†…å­˜åï¼Œéƒ½æ˜¯ B+ æ ‘ï¼ŒB+ æ ‘çš„æŸ¥æ‰¾æ¬¡æ•°å–å†³äºæ ‘çš„æ·±åº¦ã€‚ä½ çœ‹ï¼Œæ•°æ®éƒ½å·²ç»æ”¾åˆ°å†…å­˜äº†ï¼Œè¿˜ä¸èƒ½â€œä¸€ä¸‹å­â€å°±æ‰¾åˆ°å®ƒï¼Œè¿˜è¦â€œå‡ ä¸‹å­â€ï¼Œè¿™ç©ºé—´ç‰ºç‰²çš„æ˜¯ä¸æ˜¯ä¸å¤ªå€¼å¾—ï¼Ÿ</p><p>å°¤å…¶æ˜¯é‚£äº›é¢‘ç¹è¢«è®¿é—®çš„æ•°æ®ï¼Œæ¯æ¬¡è¿‡æ¥éƒ½è¦èµ° B+ æ ‘æ¥æŸ¥è¯¢ï¼Œè¿™æ—¶å°±ä¼šæƒ³åˆ°ï¼Œæˆ‘ç”¨ä¸€ä¸ªæŒ‡é’ˆæŠŠæ•°æ®çš„ä½ç½®è®°å½•ä¸‹æ¥ä¸å°±å¥½äº†ï¼Ÿ</p><p>è¿™å°±æ˜¯ã€Œè‡ªé€‚åº”å“ˆå¸Œç´¢å¼•ã€ï¼ˆAdaptive Hash Indexï¼‰ã€‚è‡ªé€‚åº”ï¼Œé¡¾åæ€ä¹‰ï¼ŒMySQL ä¼šè‡ªåŠ¨è¯„ä¼°ä½¿ç”¨è‡ªé€‚åº”ç´¢å¼•æ˜¯å¦å€¼å¾—ï¼Œå¦‚æœè§‚å¯Ÿåˆ°å»ºç«‹å“ˆå¸Œç´¢å¼•å¯ä»¥æå‡é€Ÿåº¦ï¼Œåˆ™å»ºç«‹ã€‚</p><h3 id="Redo-log-buffer"><a href="#Redo-log-buffer" class="headerlink" title="Redo log buffer"></a>Redo log buffer</h3><p>Redo log bufferé‡Œé¢å­˜å‚¨äº†æ•°æ®ä¿®æ”¹æ‰€äº§ç”Ÿçš„redo logã€‚</p><h2 id="On-Disk-Structures-ç£ç›˜æ¨¡å—"><a href="#On-Disk-Structures-ç£ç›˜æ¨¡å—" class="headerlink" title="On-Disk Structures ç£ç›˜æ¨¡å—"></a>On-Disk Structures ç£ç›˜æ¨¡å—</h2><p>ç£ç›˜é‡Œæœ‰ä»€ä¹ˆå‘¢ï¼Ÿé™¤äº†è¡¨ç»“æ„å®šä¹‰å’Œç´¢å¼•ï¼Œè¿˜æœ‰ä¸€äº›ä¸ºäº†é«˜æ€§èƒ½å’Œé«˜å¯é è€Œè®¾è®¡çš„è§’è‰²ï¼Œæ¯”å¦‚ redo logã€undo logã€Change Bufferï¼Œä»¥åŠ Doublewrite Buffer ç­‰ç­‰.</p><h3 id="Tablespacesè¡¨ç©ºé—´"><a href="#Tablespacesè¡¨ç©ºé—´" class="headerlink" title="Tablespacesè¡¨ç©ºé—´"></a><strong>Tablespacesè¡¨ç©ºé—´</strong></h3><p>Tablespaces åˆ†ä¸ºäº”ç§ï¼š</p><ul><li>The System Tablespace</li><li>File-Per-Table Tablespaces</li><li>General Tablespace</li><li>Undo Tablespaces</li><li>Temporary Tablespaces</li></ul><p>å…¶ä¸­ï¼Œæˆ‘ä»¬å¹³æ—¶åˆ›å»ºçš„è¡¨çš„æ•°æ®ï¼Œå¯ä»¥å­˜æ”¾åˆ° The System Tablespace ã€File-Per-Table Tablespacesã€General Tablespace ä¸‰è€…ä¸­çš„ä»»æ„ä¸€ä¸ªåœ°æ–¹ï¼Œå…·ä½“å–å†³äºä½ çš„é…ç½®å’Œåˆ›å»ºè¡¨æ—¶çš„ sql è¯­å¥ã€‚</p><h3 id="Doublewrite-Buffer"><a href="#Doublewrite-Buffer" class="headerlink" title="Doublewrite Buffer"></a><strong>Doublewrite Buffer</strong></h3><p><strong>å¦‚æœè¯´ Change Buffer æ˜¯æå‡æ€§èƒ½ï¼Œé‚£ä¹ˆ Doublewrite Buffer å°±æ˜¯ä¿è¯æ•°æ®é¡µçš„å¯é æ€§ã€‚</strong></p><p>æ€ä¹ˆç†è§£å‘¢ï¼Ÿ</p><p>å‰é¢æåˆ°è¿‡ï¼ŒMySQL ä»¥ã€Œé¡µã€ä¸ºè¯»å–å’Œå†™å…¥å•ä½ï¼Œä¸€ä¸ªã€Œé¡µã€é‡Œé¢æœ‰å¤šè¡Œæ•°æ®ï¼Œå†™å…¥æ•°æ®æ—¶ï¼ŒMySQL ä¼šå…ˆå†™å†…å­˜ä¸­çš„é¡µï¼Œç„¶åå†åˆ·æ–°åˆ°ç£ç›˜ä¸­çš„é¡µã€‚</p><p>è¿™æ—¶é—®é¢˜æ¥äº†ï¼Œå‡è®¾åœ¨æŸä¸€æ¬¡ä»å†…å­˜åˆ·æ–°åˆ°ç£ç›˜çš„è¿‡ç¨‹ä¸­ï¼Œä¸€ä¸ªã€Œé¡µã€åˆ·äº†ä¸€åŠï¼Œçªç„¶æ“ä½œç³»ç»Ÿæˆ–è€… MySQL è¿›ç¨‹å¥”æºƒäº†ï¼Œè¿™æ—¶å€™ï¼Œå†…å­˜é‡Œçš„é¡µæ•°æ®è¢«æ¸…é™¤äº†ï¼Œè€Œç£ç›˜é‡Œçš„é¡µæ•°æ®ï¼Œåˆ·äº†ä¸€åŠï¼Œå¤„äºä¸€ä¸ªä¸­é—´çŠ¶æ€ï¼Œä¸å°´ä¸å°¬ï¼Œå¯ä»¥è¯´æ˜¯ä¸€ä¸ªã€Œä¸å®Œæ•´ã€ï¼Œç”šè‡³æ˜¯ã€Œåæ‰çš„ã€çš„é¡µã€‚</p><p>æœ‰åŒå­¦è¯´ï¼Œä¸æ˜¯æœ‰ Redo Log ä¹ˆï¼Ÿå…¶å®è¿™ä¸ªæ—¶å€™ Redo Log ä¹Ÿå·²ç»æ— åŠ›å›å¤©ï¼ŒRedo Log æ˜¯è¦åœ¨ç£ç›˜ä¸­çš„é¡µæ•°æ®æ˜¯æ­£å¸¸çš„ã€æ²¡æœ‰æŸåçš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½æŠŠç£ç›˜é‡Œé¡µæ•°æ® load åˆ°å†…å­˜ï¼Œç„¶ååº”ç”¨ Redo Logã€‚è€Œå¦‚æœç£ç›˜ä¸­çš„é¡µæ•°æ®å·²ç»æŸåï¼Œæ˜¯æ— æ³•åº”ç”¨ Redo Log çš„ã€‚</p><p>æ‰€ä»¥ï¼ŒMySQL åœ¨åˆ·æ•°æ®åˆ°ç£ç›˜ä¹‹å‰ï¼Œè¦å…ˆæŠŠæ•°æ®å†™åˆ°å¦å¤–ä¸€ä¸ªåœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯ Doublewrite Bufferï¼Œå†™å®Œåï¼Œå†å¼€å§‹å†™ç£ç›˜ã€‚Doublewrite Buffer å¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ä¸ªå¤‡ä»½ï¼ˆrecoveryï¼‰ï¼Œä¸‡ä¸€çœŸçš„å‘ç”Ÿ crashï¼Œå°±å¯ä»¥åˆ©ç”¨ Doublewrite Buffer æ¥ä¿®å¤ç£ç›˜é‡Œçš„æ•°æ®ã€‚</p><h3 id="Insert-Buffer"><a href="#Insert-Buffer" class="headerlink" title="Insert Buffer"></a>Insert Buffer</h3><p>å¯¹äºä¸»é”®é¡ºåºæ’å…¥çš„æ•°æ®ï¼Œæ’å…¥é€Ÿåº¦å¾ˆå¿«ï¼Œå› ä¸ºæ•°æ®é¡µçš„å­˜æ”¾æ˜¯æŒ‰ç…§ä¸»é”®é¡ºåºå­˜æ”¾çš„ã€‚ä½†æ˜¯å¯¹äºéèšé›†çš„ä¸”ä¸æ˜¯å”¯ä¸€çš„ç´¢å¼•ï¼Œæ•°æ®çš„æ’å…¥ä¸æ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥éœ€è¦ç¦»æ•£çš„è®¿é—®éèšé›†ç´¢å¼•é¡µï¼Œéšæœºè¯»å–çš„å­˜åœ¨ä¼šå¯¼è‡´æ’å…¥æ“ä½œæ€§èƒ½ä¸‹é™ã€‚</p><p>MySQL çš„æ’å…¥ç¼“å†²ï¼Œåœ¨éèšé›†ç´¢å¼•çš„æ’å…¥æˆ–æ›´æ–°æ—¶ï¼Œä¸ç›´æ¥æ’å…¥åˆ°ç´¢å¼•é¡µï¼Œè€Œæ˜¯å…ˆåˆ¤æ–­æ’å…¥çš„éèšé›†ç´¢å¼•é¡µæ˜¯å¦åœ¨ç¼“å†²æ± ä¸­ï¼Œè‹¥åœ¨ï¼Œåˆ™ç›´æ¥æ’å…¥ï¼›å¦‚æœä¸åœ¨ï¼Œä¸ä¼šå»è¯»æ•°æ®ï¼Œè€Œæ˜¯å…ˆæ”¾å…¥åˆ°ä¸€ä¸ªinsert bufferå¯¹è±¡ä¸­ï¼Œç„¶åå†ä»¥ä¸€å®šçš„é¢‘ç‡å’Œæƒ…å†µè¿›è¡Œ insert buffer å’Œ è¾…åŠ©ç´¢å¼•é¡µå­èŠ‚ç‚¹åˆå¹¶æ“ä½œï¼Œè¿™æ˜¯é€šå¸¸èƒ½å°†å¤šä¸ªæ’å…¥åˆå¹¶åˆ°ä¸€ä¸ªæ“ä½œä¸­ï¼Œè¿™å°±å¤§å¤§æé«˜äº†å¯¹äºéèšé›†ç´¢å¼•æ’å…¥çš„æ€§èƒ½ã€‚</p><h3 id="ä½¿ç”¨Insert-Bufferçš„åœºæ™¯"><a href="#ä½¿ç”¨Insert-Bufferçš„åœºæ™¯" class="headerlink" title="ä½¿ç”¨Insert Bufferçš„åœºæ™¯"></a>ä½¿ç”¨Insert Bufferçš„åœºæ™¯</h3><p>1ã€ç´¢å¼•æ˜¯è¾…åŠ©ç´¢å¼•</p><p>2ã€ç´¢å¼•ä¸æ˜¯å”¯ä¸€çš„</p><p>å› ä¸ºåœ¨æ’å…¥æ—¶ï¼Œæ•°æ®åº“å¹¶ä¸å»æŸ¥æ‰¾æ’å…¥è®°å½•çš„å”¯ä¸€æ€§ï¼Œå¦åˆ™å°±éœ€è¦ç¦»æ•£çš„è¯»å–æ•°æ®ï¼Œè¿™ä½¿ insert buffer å¤±å»äº†æ„ä¹‰ã€‚</p><h3 id="é£é™©ç‚¹"><a href="#é£é™©ç‚¹" class="headerlink" title="é£é™©ç‚¹"></a>é£é™©ç‚¹</h3><p>å¦‚æœæ•°æ®åº“å®•æœºæ—¶è¿˜æœ‰å¤§é‡çš„ç¼“å­˜æ²¡åˆå¹¶åˆ°å®é™…çš„ç´¢å¼•ä¸­å»ï¼Œæ¢å¤è¿™äº›æ•°æ®å¯èƒ½éœ€è¦å¾ˆé•¿çš„æ—¶é—´</p><h3 id="flush-neighbor-page"><a href="#flush-neighbor-page" class="headerlink" title="flush neighbor page"></a>flush neighbor page</h3><p>å½“åˆ·æ–°ä¸€ä¸ªè„é¡µæ—¶ï¼ŒInnodbå­˜å‚¨å¼•æ“ä¼š æ£€æµ‹è¯¥é¡µæ‰€åœ¨åŒºçš„æ‰€æœ‰é¡µï¼Œå¦‚æœæ˜¯è„é¡µï¼Œé‚£ä¹ˆä¸€èµ·è¿›è¡Œåˆ·æ–°</p><h2 id="innodb-fast-shutdownå‚æ•°"><a href="#innodb-fast-shutdownå‚æ•°" class="headerlink" title="innodb_fast_shutdownå‚æ•°"></a>innodb_fast_shutdownå‚æ•°</h2><p>innodb_fast_shutdownå‚æ•°æœ‰ä¸‰ä¸ªå€¼ å¦‚ä¸‹ğŸ‘‡</p><p>0 è¡¨ç¤ºmysqlæ•°æ®åº“å…³é—­æ—¶ï¼Œinnodbéœ€è¦å®Œæˆæ‰€æœ‰çš„full purge å’Œ merge insert bufferï¼Œå¹¶å°†æ‰€æœ‰çš„è„é¡µåˆ·æ–°ä¼šç£ç›˜ã€‚è€—æ—¶é•¿</p><p>1 é»˜è®¤å€¼ï¼Œè¡¨ç¤ºä¸éœ€è¦å®Œæˆ full purge å’Œ merge insert buffer æ“ä½œï¼Œä½†æ˜¯åœ¨ç¼“å†²æ± ä¸­çš„ä¸€äº›æ•°æ®è¿˜æ˜¯ä¼šåˆ·æ–°ä¼šç£ç›˜ã€‚</p><p>2 è¡¨ç¤ºä¸å®Œæˆ full purge å’Œ merge insert buffer æ“ä½œï¼Œä¹Ÿä¸åˆ·æ–°è„é¡µï¼Œè€Œæ˜¯å°†æ—¥å¿—éƒ½å†™å…¥æ—¥å¿—ã€‚è¿™æ ·ä¸ä¼šæœ‰ä»»ä½•çš„äº‹åŠ¡ä¸¢å¤±ï¼Œä½†æ˜¯ä¸‹æ¬¡æ•°æ®åº“å¯åŠ¨æ—¶ï¼Œéœ€è¦è¿›è¡Œæ¢å¤æ“ä½œ</p><h2 id="åå°çº¿ç¨‹"><a href="#åå°çº¿ç¨‹" class="headerlink" title="åå°çº¿ç¨‹"></a>åå°çº¿ç¨‹</h2><p>InnoDB æ˜¯å¤šçº¿ç¨‹æ¨¡å‹ï¼Œä¸åŒçš„åå°çº¿ç¨‹å¤„ç†ä¸åŒçš„ä»»åŠ¡ã€‚</p><h3 id="Master-Thread"><a href="#Master-Thread" class="headerlink" title="Master Thread"></a>Master Thread</h3><p>æ ¸å¿ƒçº¿ç¨‹ï¼Œè´Ÿè´£å°†ç¼“å†²æ± ä¸­çš„æ•°æ®å¼‚æ­¥åˆ·æ–°åˆ°ç£ç›˜ï¼Œä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼ŒåŒ…æ‹¬è„é¡µçš„åˆ·æ–°ã€åˆå¹¶æ’å…¥ç¼“å†²ã€Undoé¡µçš„å›æ”¶ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210826112203051.png" alt="image-20210826112203051"></p><h3 id="IO-Thread"><a href="#IO-Thread" class="headerlink" title="IO Thread"></a>IO Thread</h3><p>InnoDB ä½¿ç”¨AIOå¤„ç†IOè¯·æ±‚ï¼Œæé«˜æ•°æ®åº“æ€§èƒ½ï¼ŒIO Threadè´Ÿè´£è¿™äº›è¯·æ±‚çš„å›è°ƒã€‚</p><p>IO Thread åŒ…æ‹¬write/read/insert buffer/log io thread</p><h3 id="Purge-Thread"><a href="#Purge-Thread" class="headerlink" title="Purge Thread"></a>Purge Thread</h3><p>äº‹åŠ¡è¢«æäº¤åï¼Œå…¶ä½¿ç”¨çš„undologå¯èƒ½ä¸å†éœ€è¦ï¼Œéœ€è¦ purge threadæ¥å›æ”¶å·²ç»ä½¿ç”¨å¹¶åˆ†é…çš„undoé¡µ</p><h3 id="Page-Cleaner-Thread"><a href="#Page-Cleaner-Thread" class="headerlink" title="Page Cleaner Thread"></a>Page Cleaner Thread</h3><p>å‡è½»åŸMaster Thrad çš„å·¥ä½œåŠå¯¹äºç”¨æˆ·æŸ¥è¯¢çº¿ç¨‹çš„é˜»å¡ï¼Œè¿›ä¸€æ­¥æä¾›InnoDBå­˜å‚¨å¼•æ“çš„æ€§èƒ½</p><h2 id="checkpoint"><a href="#checkpoint" class="headerlink" title="checkpoint"></a>checkpoint</h2><h3 id="ä»€ä¹ˆæ˜¯checkpoint"><a href="#ä»€ä¹ˆæ˜¯checkpoint" class="headerlink" title="ä»€ä¹ˆæ˜¯checkpoint"></a>ä»€ä¹ˆæ˜¯checkpoint</h3><p>é¡µé¢æ“ä½œå…ˆåœ¨å†…å­˜ç¼“å†²åŒºï¼Œå†åˆ·æ–°åˆ°ç£ç›˜ï¼Œå¦‚æœåˆ·æ–°ç£ç›˜æ—¶å‘ç”Ÿçš„å®•æœºï¼Œé‚£ä¹ˆæ•°æ®å°†ä¸¢å¤±ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªæ–‡ä»¶ï¼Œå½“å‰äº‹åŠ¡æ•°æ®åº“æ™®éä½¿ç”¨ write ahead logç­–ç•¥ï¼Œå³äº‹åŠ¡æäº¤æ—¶ï¼Œå…ˆå†™é‡åšæ—¥å¿—ï¼Œå†ä¿®æ”¹é¡µã€‚è¿™æ ·å³ä½¿å®•æœºï¼Œä¹Ÿå¯ä»¥é€šè¿‡é‡åšæ—¥å¿—æ¥å®Œæˆæ•°æ®çš„æ¢å¤ã€‚ä½†æ˜¯é‡åšæ—¥å¿—æ²¡æœ‰redisçš„redoåŠŸèƒ½ï¼Œå¯¹äºè¿è¡Œæ—¶é—´è¾ƒé•¿æˆ–è€…æäº¤è¾ƒå¤§çš„é‡åšæ—¥å¿—æ¢å¤æ˜¯éå¸¸è€—æ—¶çš„ï¼Œæ‰€ä»¥éœ€è¦ CheckPoint è§£å†³</p><h3 id="Checkpoint-è§£å†³çš„é—®é¢˜"><a href="#Checkpoint-è§£å†³çš„é—®é¢˜" class="headerlink" title="Checkpoint è§£å†³çš„é—®é¢˜"></a>Checkpoint è§£å†³çš„é—®é¢˜</h3><p>1ã€ç¼“å†²æ± ä¸å¤Ÿç”¨æ—¶ ï¼Œå°†è„é¡µåˆ·æ–°åˆ°ç£ç›˜</p><p>2ã€é‡åšæ—¥å¿—ä¸å¯ç”¨æ—¶ï¼Œåˆ·æ–°è„é¡µ</p><p>3ã€æ•°æ®åº“åªéœ€è¦åˆ°checkpointåçš„æ—¥å¿—è¿›è¡Œæ¢å¤ï¼Œç¼©çŸ­æ•°æ®åº“çš„æ¢å¤æ—¶é—´</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Innodbæ¶æ„&quot;&gt;&lt;a href=&quot;#Innodbæ¶æ„&quot; class=&quot;headerlink&quot; title=&quot;Innodbæ¶æ„&quot;&gt;&lt;/a&gt;Innodbæ¶æ„&lt;/h1&gt;&lt;p&gt;å­˜å‚¨å¼•æ“æ˜¯MySQLéå¸¸é‡è¦çš„ç»„æˆéƒ¨åˆ†ï¼Œå®ƒç›´æ¥å½±å“äº†ä¸€ä¸ªæ•°æ®åº“çš„æ€§èƒ½ï¼Œæ˜¯MySQLçš„ç»å¯¹æ ¸å¿ƒ</summary>
      
    
    
    
    
    <category term="MySQL" scheme="http://example.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>MySQL-ç´¢å¼•</title>
    <link href="http://example.com/wiki/MySQL-%E7%B4%A2%E5%BC%95/"/>
    <id>http://example.com/wiki/MySQL-%E7%B4%A2%E5%BC%95/</id>
    <published>2021-08-25T06:48:18.000Z</published>
    <updated>2021-08-26T11:19:01.929Z</updated>
    
    <content type="html"><![CDATA[<h1 id="MySQLä¸­æ”¯æŒçš„ç´¢å¼•"><a href="#MySQLä¸­æ”¯æŒçš„ç´¢å¼•" class="headerlink" title="MySQLä¸­æ”¯æŒçš„ç´¢å¼•"></a>MySQLä¸­æ”¯æŒçš„ç´¢å¼•</h1><p>ä¹‹å‰é—®è¿‡å­˜å‚¨å¼•æ“æ˜¯æ•°æ®åº“å±‚é¢çš„è¿˜æ˜¯æ•°æ®è¡¨å±‚é¢çš„ï¼Ÿ</p><p>é‚£ä¹ˆç°åœ¨ä¹ŸåŒæ ·é—®ä¸€ä¸ªé—®é¢˜ï¼Œç´¢å¼•æ˜¯å­˜å‚¨å¼•æ“å±‚é¢çš„è¿˜æ˜¯æœåŠ¡å™¨å±‚é¢å®ç°çš„ï¼Ÿç­”æ¡ˆæ˜¯å­˜å‚¨å¼•æ“å±‚é¢çš„ã€‚ </p><h2 id="ä»€ä¹ˆæ˜¯ç´¢å¼•"><a href="#ä»€ä¹ˆæ˜¯ç´¢å¼•" class="headerlink" title="ä»€ä¹ˆæ˜¯ç´¢å¼•"></a>ä»€ä¹ˆæ˜¯ç´¢å¼•</h2><p>å®˜æ–¹ä»‹ç»ç´¢å¼•æ˜¯å¸®åŠ©MySQLé«˜æ•ˆè·å–æ•°æ®çš„æ•°æ®ç»“æ„ã€‚æ›´é€šä¿—çš„è¯´ï¼Œæ•°æ®åº“ç´¢å¼•å¥½æ¯”æ˜¯ä¸€æœ¬ä¹¦å‰é¢çš„ç›®å½•ï¼Œèƒ½åŠ å¿«æ•°æ®åº“çš„æŸ¥è¯¢é€Ÿåº¦ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ç´¢å¼•æœ¬èº«ä¹Ÿå¾ˆå¤§ï¼Œä¸å¯èƒ½å…¨éƒ¨å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå› æ­¤ç´¢å¼•å¾€å¾€æ˜¯å­˜å‚¨åœ¨ç£ç›˜ä¸Šçš„æ–‡ä»¶ä¸­çš„ï¼ˆå¯èƒ½å­˜å‚¨åœ¨å•ç‹¬çš„ç´¢å¼•æ–‡ä»¶ä¸­ï¼Œä¹Ÿå¯èƒ½å’Œæ•°æ®ä¸€èµ·å­˜å‚¨åœ¨æ•°æ®æ–‡ä»¶ä¸­ï¼‰ã€‚</p><p>æˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„ç´¢å¼•ï¼ŒåŒ…æ‹¬èšé›†ç´¢å¼•ã€è¦†ç›–ç´¢å¼•ã€ç»„åˆç´¢å¼•ã€å‰ç¼€ç´¢å¼•ã€å”¯ä¸€ç´¢å¼•ç­‰ï¼Œæ²¡æœ‰ç‰¹åˆ«è¯´æ˜ï¼Œé»˜è®¤éƒ½æ˜¯ä½¿ç”¨B+æ ‘ç»“æ„ç»„ç»‡ï¼ˆå¤šè·¯æœç´¢æ ‘ï¼Œå¹¶ä¸ä¸€å®šæ˜¯äºŒå‰çš„ï¼‰çš„ç´¢å¼•ã€‚</p><h2 id="ç´¢å¼•çš„ä¼˜ç¼ºç‚¹"><a href="#ç´¢å¼•çš„ä¼˜ç¼ºç‚¹" class="headerlink" title="ç´¢å¼•çš„ä¼˜ç¼ºç‚¹"></a>ç´¢å¼•çš„ä¼˜ç¼ºç‚¹</h2><h3 id="ä¼˜åŠ¿ï¼š"><a href="#ä¼˜åŠ¿ï¼š" class="headerlink" title="ä¼˜åŠ¿ï¼š"></a>ä¼˜åŠ¿ï¼š</h3><p>1ã€å¯ä»¥æé«˜æ•°æ®æ£€ç´¢çš„æ•ˆç‡ï¼Œé™ä½æ•°æ®åº“çš„IOæˆæœ¬ï¼Œç±»ä¼¼äºä¹¦çš„ç›®å½•ã€‚</p><p>2ã€é€šè¿‡ç´¢å¼•åˆ—å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œé™ä½æ•°æ®æ’åºçš„æˆæœ¬ï¼Œé™ä½äº†CPUçš„æ¶ˆè€—ã€‚</p><p>3ã€è¢«ç´¢å¼•çš„åˆ—ä¼šè‡ªåŠ¨è¿›è¡Œæ’åºï¼ŒåŒ…æ‹¬ã€å•åˆ—ç´¢å¼•ã€‘å’Œã€ç»„åˆç´¢å¼•ã€‘ï¼Œåªæ˜¯ç»„åˆç´¢å¼•çš„æ’åºè¦å¤æ‚ä¸€äº›ã€‚å¦‚æœæŒ‰ç…§ç´¢å¼•åˆ—çš„é¡ºåºè¿›è¡Œæ’åºï¼Œå¯¹åº”order byè¯­å¥æ¥è¯´ï¼Œæ•ˆç‡å°±ä¼šæé«˜å¾ˆå¤šã€‚</p><h3 id="åŠ£åŠ¿ï¼š"><a href="#åŠ£åŠ¿ï¼š" class="headerlink" title="åŠ£åŠ¿ï¼š"></a>åŠ£åŠ¿ï¼š</h3><p>1ã€ç´¢å¼•ä¼šå æ®ç£ç›˜ç©ºé—´</p><p>2ã€ç´¢å¼•è™½ç„¶ä¼šæé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œä½†æ˜¯ä¼šé™ä½æ›´æ–°è¡¨çš„æ•ˆç‡ã€‚æ¯”å¦‚æ¯æ¬¡å¯¹è¡¨è¿›è¡Œå¢åˆ æ”¹æ“ä½œï¼ŒMySQLä¸ä»…è¦ä¿å­˜æ•°æ®ï¼Œè¿˜æœ‰ä¿å­˜æˆ–è€…æ›´æ–°å¯¹åº”çš„ç´¢å¼•æ–‡ä»¶ã€‚</p><p><font color=blue>ä¸€ä¸ªè¡¨æœ€å¤šå¯ä»¥åˆ›å»ºå¤šå°‘ä¸ªç´¢å¼•ï¼Ÿ</font> 16ä¸ª</p><h2 id="ç´¢å¼•çš„ç±»å‹"><a href="#ç´¢å¼•çš„ç±»å‹" class="headerlink" title="ç´¢å¼•çš„ç±»å‹"></a>ç´¢å¼•çš„ç±»å‹</h2><h3 id="ä¸»é”®ç´¢å¼•"><a href="#ä¸»é”®ç´¢å¼•" class="headerlink" title="ä¸»é”®ç´¢å¼•"></a>ä¸»é”®ç´¢å¼•</h3><p>ç´¢å¼•åˆ—ä¸­çš„å€¼å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œä¸å…è®¸æœ‰ç©ºå€¼ã€‚InnoDBä¸‹å¼ºçƒˆæ¨èä½¿ç”¨æ•°å€¼ç±»å‹çš„è‡ªå¢ä¸»é”®ã€‚è¿™ä¸ªå’Œb+æ•°çš„æ’åºæœ‰å…³ã€‚</p><h3 id="æ™®é€šç´¢å¼•"><a href="#æ™®é€šç´¢å¼•" class="headerlink" title="æ™®é€šç´¢å¼•"></a>æ™®é€šç´¢å¼•</h3><p>MySQLä¸­åŸºæœ¬ç´¢å¼•ç±»å‹ï¼Œæ²¡æœ‰ä»€ä¹ˆé™åˆ¶ï¼Œå…è®¸åœ¨å®šä¹‰ç´¢å¼•çš„åˆ—ä¸­æ’å…¥é‡å¤å€¼å’Œç©ºå€¼ã€‚</p><h3 id="å”¯ä¸€ç´¢å¼•"><a href="#å”¯ä¸€ç´¢å¼•" class="headerlink" title="å”¯ä¸€ç´¢å¼•"></a>å”¯ä¸€ç´¢å¼•</h3><p>ç´¢å¼•åˆ—ä¸­çš„å€¼å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œä½†æ˜¯å…è®¸ä¸ºç©ºå€¼ã€‚</p><h3 id="å…¨æ–‡ç´¢å¼•"><a href="#å…¨æ–‡ç´¢å¼•" class="headerlink" title="å…¨æ–‡ç´¢å¼•"></a>å…¨æ–‡ç´¢å¼•</h3><p>åªèƒ½åœ¨æ–‡æœ¬ç±»å‹CHAR,VARCHAR,TEXTç±»å‹å­—æ®µä¸Šåˆ›å»ºå…¨æ–‡ç´¢å¼•ã€‚å­—æ®µé•¿åº¦æ¯”è¾ƒå¤§æ—¶ï¼Œå¦‚æœåˆ›å»ºæ™®é€šç´¢å¼•ï¼Œåœ¨è¿›è¡Œlikeæ¨¡ç³ŠæŸ¥è¯¢æ—¶æ•ˆç‡æ¯”è¾ƒä½ï¼Œè¿™æ—¶å¯ä»¥åˆ›å»ºå…¨æ–‡ç´¢å¼•ã€‚MyISAMå’ŒInnoDBä¸­éƒ½å¯ä»¥ä½¿ç”¨å…¨æ–‡ç´¢å¼•ã€‚</p><h3 id="ç©ºé—´ç´¢å¼•"><a href="#ç©ºé—´ç´¢å¼•" class="headerlink" title="ç©ºé—´ç´¢å¼•"></a>ç©ºé—´ç´¢å¼•</h3><p>MySQLåœ¨5.7ä¹‹åçš„ç‰ˆæœ¬æ”¯æŒäº†ç©ºé—´ç´¢å¼•ï¼Œè€Œä¸”æ”¯æŒOpenGISå‡ ä½•æ•°æ®æ¨¡å‹ã€‚MySQLåœ¨ç©ºé—´ç´¢å¼•è¿™æ–¹é¢éµå¾ªOpenGISå‡ ä½•æ•°æ®æ¨¡å‹è§„åˆ™ã€‚</p><h3 id="å‰ç¼€ç´¢å¼•"><a href="#å‰ç¼€ç´¢å¼•" class="headerlink" title="å‰ç¼€ç´¢å¼•"></a>å‰ç¼€ç´¢å¼•</h3><p>åœ¨æ–‡æœ¬ç±»å‹å¦‚CHAR,VARCHAR,TEXTç±»åˆ—ä¸Šåˆ›å»ºç´¢å¼•æ—¶ï¼Œå¯ä»¥æŒ‡å®šç´¢å¼•åˆ—çš„é•¿åº¦ï¼Œä½†æ˜¯æ•°å€¼ç±»å‹ä¸èƒ½æŒ‡å®šã€‚</p><h3 id="ç»„åˆç´¢å¼•"><a href="#ç»„åˆç´¢å¼•" class="headerlink" title="ç»„åˆç´¢å¼•"></a>ç»„åˆç´¢å¼•</h3><p>ç»„åˆç´¢å¼•çš„ä½¿ç”¨ï¼Œéœ€è¦éµå¾ªæœ€å·¦å‰ç¼€åŒ¹é…åŸåˆ™ï¼ˆæœ€å·¦åŒ¹é…åŸåˆ™ï¼‰ã€‚ä¸€èˆ¬æƒ…å†µä¸‹åœ¨æ¡ä»¶å…è®¸çš„æƒ…å†µä¸‹ä½¿ç”¨ç»„åˆç´¢å¼•æ›¿ä»£å¤šä¸ªå•åˆ—ç´¢å¼•ä½¿ç”¨ã€‚</p><h3 id="èšç°‡ç´¢å¼•ï¼ˆèšé›†ç´¢å¼•ï¼‰"><a href="#èšç°‡ç´¢å¼•ï¼ˆèšé›†ç´¢å¼•ï¼‰" class="headerlink" title="èšç°‡ç´¢å¼•ï¼ˆèšé›†ç´¢å¼•ï¼‰"></a>èšç°‡ç´¢å¼•ï¼ˆèšé›†ç´¢å¼•ï¼‰</h3><p>åœ¨MyISAMå­˜å‚¨å¼•æ“ä¸­ï¼Œä¸»é”®ç´¢å¼•ä¸Šå­˜å‚¨çš„æ˜¯æ•°æ®åœ¨ç£ç›˜ä¸Šçš„åœ°å€ã€‚</p><p>åœ¨InnoDBå­˜å‚¨å¼•æ“ä¸­ï¼Œä¸»é”®ç´¢å¼•ä¸Šå­˜å‚¨çš„å°±æ˜¯æ•´è¡Œæ•°æ®ã€‚</p><h3 id="è¾…åŠ©ç´¢å¼•"><a href="#è¾…åŠ©ç´¢å¼•" class="headerlink" title="è¾…åŠ©ç´¢å¼•"></a>è¾…åŠ©ç´¢å¼•</h3><p>åœ¨MyISAMå­˜å‚¨å¼•æ“ä¸­ï¼Œè¾…åŠ©ç´¢å¼•å…¶å®å’Œä¸»é”®ç´¢å¼•ä¸€æ ·ï¼Œä¹Ÿæ˜¯å­˜å‚¨çš„æ•°æ®çš„ç£ç›˜åœ°å€ã€‚åŒºåˆ«åœ¨ä¸»é”®ç´¢å¼•çš„é”®å€¼å¿…é¡»å”¯ä¸€ï¼Œè€Œè¾…åŠ©ç´¢å¼•çš„é”®å€¼å¯ä»¥é‡å¤ã€‚</p><p>åœ¨InnoDBå­˜å‚¨å¼•æ“ä¸­ï¼Œè¾…åŠ©ç´¢å¼•å­˜å‚¨çš„æ˜¯æ•°æ®çš„ä¸»é”®ã€‚æŸ¥åˆ°ä¸»é”®ä¹‹åï¼Œåœ¨æ ¹æ®ä¸»é”®å€¼æŸ¥æ‰¾ä¸»é”®ç´¢å¼•ä¸Šå­˜å‚¨çš„æ•°æ®ã€‚</p><p>è¿™ä¼šå‘ç”Ÿä¸€ç§ç°è±¡å«<strong>å›è¡¨</strong>ï¼Œä¼šå¢åŠ æ€§èƒ½æ¶ˆè€—ï¼Œè§£å†³è¿™ç§é—®é¢˜çš„æ–¹æ³•å°±æ˜¯ <strong>è¦†ç›–ç´¢å¼•</strong>ï¼Œä¹Ÿå°±æ˜¯æŠŠè¦æŸ¥è¯¢çš„å­—æ®µä¹Ÿæ·»åŠ åˆ°ç´¢å¼•ä¸­ã€‚</p><h3 id="è·³è·ƒç´¢å¼•"><a href="#è·³è·ƒç´¢å¼•" class="headerlink" title="è·³è·ƒç´¢å¼•"></a>è·³è·ƒç´¢å¼•</h3><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¦‚æœè¡¨usersæœ‰å¤åˆç´¢å¼•idx_status_create_timeï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå•ç‹¬ç”¨create_timeå»æŸ¥è¯¢ï¼ŒMySQLä¼˜åŒ–å™¨æ˜¯ä¸èµ°ç´¢å¼•ï¼Œæ‰€ä»¥è¿˜éœ€è¦å†åˆ›å»ºä¸€ä¸ªå•åˆ—ç´¢å¼•idx_create_timeã€‚ç”¨è¿‡Oracleçš„åŒå­¦éƒ½çŸ¥é“ï¼Œæ˜¯å¯ä»¥èµ°ç´¢å¼•è·³è·ƒæ‰«æï¼ˆIndex Skip Scanï¼‰ï¼Œåœ¨MySQL 8.0ä¹Ÿå®ç°Oracleç±»ä¼¼çš„ç´¢å¼•è·³è·ƒæ‰«æï¼Œåœ¨ä¼˜åŒ–å™¨é€‰é¡¹ä¹Ÿå¯ä»¥çœ‹åˆ°skip_scan=onã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">|</span> optimizer_switch             <span class="operator">|</span>use_invisible_indexes<span class="operator">=</span>off,skip_scan<span class="operator">=</span><span class="keyword">on</span>,hash_join<span class="operator">=</span><span class="keyword">on</span> <span class="operator">|</span></span><br></pre></td></tr></table></figure><p><strong>é€‚åˆå¤åˆç´¢å¼•å‰å¯¼åˆ—å”¯ä¸€å€¼å°‘ï¼Œåå¯¼åˆ—å”¯ä¸€å€¼å¤šçš„æƒ…å†µï¼Œå¦‚æœå‰å¯¼åˆ—å”¯ä¸€å€¼å˜å¤šäº†ï¼Œåˆ™MySQL CBOä¸ä¼šé€‰æ‹©ç´¢å¼•è·³è·ƒæ‰«æï¼Œå–å†³äºç´¢å¼•åˆ—çš„æ•°æ®åˆ†è¡¨æƒ…å†µã€‚</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> id, user_idï¼Œstatus, phone <span class="keyword">from</span> users <span class="keyword">where</span> create_time <span class="operator">&gt;=</span><span class="string">&#x27;2021-01-02 23:01:00&#x27;</span> <span class="keyword">and</span> create_time <span class="operator">&lt;=</span> <span class="string">&#x27;2021-01-03 23:01:00&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------+-------+------------+------+---------------+------+---------+------+--------+----------+----</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> select_type <span class="operator">|</span> <span class="keyword">table</span> <span class="operator">|</span> partitions <span class="operator">|</span> type <span class="operator">|</span> possible_keys <span class="operator">|</span> key  <span class="operator">|</span> key_len <span class="operator">|</span> <span class="keyword">ref</span>  <span class="operator">|</span> <span class="keyword">rows</span>   <span class="operator">|</span> filtered <span class="operator">|</span> Extra       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------+-------+------------+------+---------------+------+---------+------+--------+----------+----</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> SIMPLE      <span class="operator">|</span> users <span class="operator">|</span> <span class="keyword">NULL</span>       <span class="operator">|</span> <span class="keyword">range</span>  <span class="operator">|</span> idx_status_create_time          <span class="operator">|</span> idx_status_create_time <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="number">15636</span> <span class="operator">|</span>    <span class="number">11.11</span> <span class="operator">|</span> <span class="keyword">Using</span> <span class="keyword">where</span>; <span class="keyword">Using</span> index <span class="keyword">for</span> <span class="keyword">skip</span> scan<span class="operator">|</span></span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥é€šè¿‡ <code>optimizer_switch=&#39;skip_scan=off&#39;</code>æ¥å…³é—­ç´¢å¼•è·³è·ƒæ‰«æç‰¹æ€§ã€‚</p><h2 id="B-Tree"><a href="#B-Tree" class="headerlink" title="B Tree"></a>B Tree</h2><p>Bæ ‘æœ‰ä»€ä¹ˆç‰¹ç‚¹å‘¢ï¼Ÿ</p><p>1ã€æ‰€æœ‰çš„é”®å€¼åˆ†å¸ƒåœ¨æ•´æ£µæ ‘ä¸Šé¢</p><p>2ã€æœç´¢æœ‰å¯èƒ½åœ¨éå¶å­èŠ‚ç‚¹ç»“æŸï¼Œåœ¨å…³é”®å­—å…¨é›†å†…åšä¸€æ¬¡æŸ¥æ‰¾ï¼Œæ€§èƒ½æ¥è¿‘äºäºŒåˆ†æŸ¥æ‰¾</p><p>3ã€æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šæ‹¥æœ‰mä¸ªå­æ ‘ï¼Œæ ¹èŠ‚ç‚¹è‡³å°‘æœ‰2ä¸ªå­æ ‘ï¼Œåˆ†æ”¯èŠ‚ç‚¹è‡³å°‘æ‹¥æœ‰m / 2ä¸ªå­æ ‘ï¼ˆé™¤æ ¹èŠ‚ç‚¹å’Œå¶å­èŠ‚ç‚¹éƒ½æ˜¯åˆ†æ”¯èŠ‚ç‚¹ï¼‰</p><p>4ã€æ‰€æœ‰å¶å­èŠ‚ç‚¹éƒ½åœ¨åŒä¸€å±‚ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ€å¤šå¯ä»¥æœ‰m - 1ä¸ªkeyï¼Œå¹¶ä¸”æŒ‰ç…§å‡åºæ’åº</p><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210825145448549.png" alt="image-20210825145448549"></p><p>B Tree æŒ‡çš„æ˜¯ Balance Treeï¼Œä¹Ÿå°±æ˜¯å¹³è¡¡æ ‘ï¼Œå¹³è¡¡æ ‘æ˜¯ä¸€é¢—æŸ¥æ‰¾æ ‘ï¼Œå¹¶ä¸”æ‰€æœ‰å¶å­èŠ‚ç‚¹ä½äºåŒä¸€å±‚ã€‚</p><h3 id="å›¾ä¾‹è¯´æ˜"><a href="#å›¾ä¾‹è¯´æ˜" class="headerlink" title="å›¾ä¾‹è¯´æ˜"></a>å›¾ä¾‹è¯´æ˜</h3><p>1ã€æ¯ä¸ªèŠ‚ç‚¹å æ®ä¸€ä¸ªç£ç›˜å—ï¼Œä¸€ä¸ªèŠ‚ç‚¹ä¸Šæœ‰ä¸¤ä¸ªå‡åºæ’åºçš„å…³é”®å­—Kå’Œä¸‰ä¸ªæŒ‡å‘å­æ ‘èŠ‚ç‚¹çš„æŒ‡é’ˆPï¼ŒæŒ‡é’ˆPå­˜å‚¨å­èŠ‚ç‚¹æ‰€åœ¨çš„ç£ç›˜å—çš„åœ°å€ã€‚</p><p>2ã€ä¸¤ä¸ªå…³é”®å­—Kåˆ’åˆ†ä¸‰ä¸ªèŒƒå›´åŸŸå¯¹åº”ä¸‰ä¸ªæŒ‡é’ˆæŒ‡å‘å­æ ‘çš„æ•°æ®èŒƒå›´</p><h3 id="æŸ¥æ‰¾å…³é”®å­—çš„è¿‡ç¨‹"><a href="#æŸ¥æ‰¾å…³é”®å­—çš„è¿‡ç¨‹" class="headerlink" title="æŸ¥æ‰¾å…³é”®å­—çš„è¿‡ç¨‹"></a>æŸ¥æ‰¾å…³é”®å­—çš„è¿‡ç¨‹</h3><p>1ã€æ ¹æ®æ ¹èŠ‚ç‚¹æŸ¥æ‰¾ç£ç›˜å—1ï¼Œè¯»å…¥åˆ°å†…å­˜ï¼ˆç¬¬ä¸€æ¬¡ç£ç›˜IOï¼‰</p><p>2ã€æ¯”è¾ƒå…³é”®å­—K22åœ¨ï¼ˆK25ï¼ŒK50ï¼‰åŒºé—´ï¼Œæ‰¾åˆ°ç£ç›˜å—1çš„P2æŒ‡é’ˆ</p><p>3ã€æ ¹æ®ç£ç›˜å—1çš„P2æŒ‡é’ˆæ‰¾åˆ°ç£ç›˜å—3ï¼Œè¯»åˆ°å†…å­˜ï¼ˆç¬¬äºŒæ¬¡ç£ç›˜IOï¼‰</p><p>4ã€ç»§ç»­æ¯”è¾ƒK32,é”å®šåœ¨K30,K38ä¹‹é—´ï¼Œæ‰¾åˆ°ç£ç›˜3çš„P2æŒ‡é’ˆ</p><p>5ã€æ ¹æ®ç£ç›˜å—2çš„P2æŒ‡é’ˆé”å®šç£ç›˜å—8ï¼Œè¯»åˆ°å†…å­˜ï¼ˆç¬¬ä¸‰æ¬¡ç£ç›˜IOï¼‰</p><p>6ã€åœ¨ç£ç›˜å—8çš„å…³é”®å­—åˆ—è¡¨ä¸­æ‰¾åˆ°å…³é”®å­—K32</p><h3 id="Bæ ‘çš„ç¼ºç‚¹"><a href="#Bæ ‘çš„ç¼ºç‚¹" class="headerlink" title="Bæ ‘çš„ç¼ºç‚¹"></a>Bæ ‘çš„ç¼ºç‚¹</h3><p>1ã€æ¯ä¸ªèŠ‚ç‚¹éƒ½å­˜å‚¨keyå’Œæ•°æ®ï¼Œè€Œæ•°æ®ä¸€èˆ¬åˆä¼šå ç”¨ç›¸å¯¹è¾ƒå¤šçš„ç©ºé—´ï¼Œè¿™æ ·å¯¼è‡´æ¯ä¸ªèŠ‚ç‚¹é”å­˜å‚¨çš„å…³é”®å­—æ•°é‡è¾ƒå°‘ï¼Œæœ€ç»ˆå¯¼è‡´æ ‘çš„é«˜åº¦æ¯”è¾ƒé«˜</p><p>2ã€å½“æ•°æ®é‡è¾ƒå¤§çš„æ—¶å€™ï¼Œç”±äºæ ‘çš„é«˜åº¦æ¯”è¾ƒæ·±ï¼Œé€ æˆæŸ¥è¯¢çš„æ€§èƒ½æå·®</p><h2 id="B-Tree-1"><a href="#B-Tree-1" class="headerlink" title="B+Tree"></a>B+Tree</h2><p><strong>æ€è€ƒä¸€ä¸‹é—®é¢˜ğŸ¤”</strong></p><p>ä¸ºä»€ä¹ˆMySQLä½¿ç”¨B+Treeè¿™ç§æ•°æ®ç»“æ„æ¥ä½œä¸ºç´¢å¼•ç»“æ„å‘¢ï¼Ÿ</p><p>ä¸ºä»€ä¹ˆä¸ä½¿ç”¨äºŒå‰æ ‘å‘¢ï¼Ÿä¸ºä»€ä¹ˆä¸ä½¿ç”¨B Treeå‘¢ï¼Ÿ</p><h3 id="B-æ ‘çš„ç‰¹ç‚¹"><a href="#B-æ ‘çš„ç‰¹ç‚¹" class="headerlink" title="B+æ ‘çš„ç‰¹ç‚¹"></a>B+æ ‘çš„ç‰¹ç‚¹</h3><p><strong>B+ Tree æ˜¯ B æ ‘çš„ä¸€ç§å˜å½¢ï¼Œå®ƒæ˜¯åŸºäº B Tree å’Œå¶å­èŠ‚ç‚¹é¡ºåºè®¿é—®æŒ‡é’ˆè¿›è¡Œå®ç°ï¼Œé€šå¸¸ç”¨äºæ•°æ®åº“å’Œæ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿä¸­ã€‚</strong></p><p>1ã€B+ æ ‘æœ‰ä¸¤ç§ç±»å‹çš„èŠ‚ç‚¹ï¼šå†…éƒ¨èŠ‚ç‚¹ï¼ˆä¹Ÿç§°ç´¢å¼•èŠ‚ç‚¹ï¼‰å’Œå¶å­èŠ‚ç‚¹ï¼Œå†…éƒ¨èŠ‚ç‚¹å°±æ˜¯éå¶å­èŠ‚ç‚¹ï¼Œå†…éƒ¨èŠ‚ç‚¹ä¸å­˜å‚¨æ•°æ®ï¼Œåªå­˜å‚¨ç´¢å¼•ï¼Œç›¸å¯¹äºBæ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹å¯ä»¥å­˜å‚¨æ›´å¤šçš„èŠ‚ç‚¹ã€‚è¿™æ ·å¯ä»¥å¤§å¤§é™ä½æ ‘çš„é«˜åº¦ï¼ŒåŒæ—¶æŠŠæ•°æ®èŒƒå›´æ•°æ®éƒ½å­˜åœ¨å¶å­èŠ‚ç‚¹ã€‚</p><p>2ã€å†…éƒ¨èŠ‚ç‚¹ä¸­çš„ key éƒ½æŒ‰ç…§ä»å°åˆ°å¤§çš„é¡ºåºæ’åˆ—ï¼Œå¯¹äºå†…éƒ¨èŠ‚ç‚¹ä¸­çš„ä¸€ä¸ª keyï¼Œå·¦å­æ ‘ä¸­çš„æ‰€æœ‰ key éƒ½å°äºå®ƒï¼Œå³å­æ ‘ä¸­çš„ key éƒ½å¤§äºç­‰äºå®ƒï¼Œå¶å­èŠ‚ç‚¹çš„è®°å½•ä¹Ÿæ˜¯æŒ‰ç…§ä»å°åˆ°å¤§æ’åˆ—çš„ã€‚</p><p>3ã€å¶å­èŠ‚ç‚¹ä¸¤ä¸¤æŒ‡é’ˆäº’ç›¸é“¾æ¥ï¼ˆç¬¦åˆç£ç›˜çš„é¢„è¯»ç‰¹æ€§ï¼‰ï¼Œé¡ºåºæŸ¥è¯¢æ€§èƒ½æ›´é«˜ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210825150633224.png" alt="image-20210825150633224"></p><h3 id="B-æ ‘çš„ä¼˜ç‚¹"><a href="#B-æ ‘çš„ä¼˜ç‚¹" class="headerlink" title="B+æ ‘çš„ä¼˜ç‚¹"></a>B+æ ‘çš„ä¼˜ç‚¹</h3><ul><li>å› ä¸ºä¸å†éœ€è¦è¿›è¡Œå…¨è¡¨æ‰«æï¼Œåªéœ€è¦å¯¹æ ‘è¿›è¡Œæœç´¢å³å¯ï¼Œæ‰€ä»¥æŸ¥æ‰¾é€Ÿåº¦å¿«å¾ˆå¤šã€‚</li><li>å› ä¸º B+ Tree çš„æœ‰åºæ€§ï¼Œæ‰€ä»¥é™¤äº†ç”¨äºæŸ¥æ‰¾ï¼Œè¿˜å¯ä»¥ç”¨äºæ’åºå’Œåˆ†ç»„ã€‚</li><li>å¯ä»¥æŒ‡å®šå¤šä¸ªåˆ—ä½œä¸ºç´¢å¼•åˆ—ï¼Œå¤šä¸ªç´¢å¼•åˆ—å…±åŒç»„æˆé”®ã€‚</li><li>é€‚ç”¨äºå…¨é”®å€¼ã€é”®å€¼èŒƒå›´å’Œé”®å‰ç¼€æŸ¥æ‰¾ï¼Œå…¶ä¸­é”®å‰ç¼€æŸ¥æ‰¾åªé€‚ç”¨äºæœ€å·¦å‰ç¼€æŸ¥æ‰¾ã€‚å¦‚æœä¸æ˜¯æŒ‰ç…§ç´¢å¼•åˆ—çš„é¡ºåºè¿›è¡ŒæŸ¥æ‰¾ï¼Œåˆ™æ— æ³•ä½¿ç”¨ç´¢å¼•ã€‚</li></ul><h2 id="å“ˆå¸Œç´¢å¼•"><a href="#å“ˆå¸Œç´¢å¼•" class="headerlink" title="å“ˆå¸Œç´¢å¼•"></a>å“ˆå¸Œç´¢å¼•</h2><p>å“ˆå¸Œç´¢å¼•èƒ½ä»¥ O(1) æ—¶é—´è¿›è¡ŒæŸ¥æ‰¾ï¼Œä½†æ˜¯å¤±å»äº†æœ‰åºæ€§ï¼š</p><ul><li>æ— æ³•ç”¨äºæ’åºä¸åˆ†ç»„ï¼›</li><li>åªæ”¯æŒç²¾ç¡®æŸ¥æ‰¾ï¼Œæ— æ³•ç”¨äºéƒ¨åˆ†æŸ¥æ‰¾å’ŒèŒƒå›´æŸ¥æ‰¾ã€‚</li></ul><p>InnoDB å­˜å‚¨å¼•æ“æœ‰ä¸€ä¸ªç‰¹æ®Šçš„åŠŸèƒ½å«â€œè‡ªé€‚åº”å“ˆå¸Œç´¢å¼•â€ï¼Œå½“æŸä¸ªç´¢å¼•å€¼è¢«ä½¿ç”¨çš„éå¸¸é¢‘ç¹æ—¶ï¼Œä¼šåœ¨ B+Tree ç´¢å¼•ä¹‹ä¸Šå†åˆ›å»ºä¸€ä¸ªå“ˆå¸Œç´¢å¼•ï¼Œè¿™æ ·å°±è®© B+Tree ç´¢å¼•å…·æœ‰å“ˆå¸Œç´¢å¼•çš„ä¸€äº›ä¼˜ç‚¹ï¼Œæ¯”å¦‚å¿«é€Ÿçš„å“ˆå¸ŒæŸ¥æ‰¾ã€‚</p><h2 id="å…¨æ–‡ç´¢å¼•-1"><a href="#å…¨æ–‡ç´¢å¼•-1" class="headerlink" title="å…¨æ–‡ç´¢å¼•"></a>å…¨æ–‡ç´¢å¼•</h2><p>MyISAM å­˜å‚¨å¼•æ“æ”¯æŒå…¨æ–‡ç´¢å¼•ï¼Œç”¨äºæŸ¥æ‰¾æ–‡æœ¬ä¸­çš„å…³é”®è¯ï¼Œè€Œä¸æ˜¯ç›´æ¥æ¯”è¾ƒæ˜¯å¦ç›¸ç­‰ã€‚</p><p>æŸ¥æ‰¾æ¡ä»¶ä½¿ç”¨ MATCH AGAINSTï¼Œè€Œä¸æ˜¯æ™®é€šçš„ WHEREã€‚</p><p>å…¨æ–‡ç´¢å¼•ä½¿ç”¨å€’æ’ç´¢å¼•å®ç°ï¼Œå®ƒè®°å½•ç€å…³é”®è¯åˆ°å…¶æ‰€åœ¨æ–‡æ¡£çš„æ˜ å°„ã€‚</p><p>InnoDB å­˜å‚¨å¼•æ“åœ¨ MySQL 5.6.4 ç‰ˆæœ¬ä¸­ä¹Ÿå¼€å§‹æ”¯æŒå…¨æ–‡ç´¢å¼•ã€‚</p><h2 id="ç´¢å¼•çš„ä¼˜åŒ–"><a href="#ç´¢å¼•çš„ä¼˜åŒ–" class="headerlink" title="ç´¢å¼•çš„ä¼˜åŒ–"></a>ç´¢å¼•çš„ä¼˜åŒ–</h2><p>1ã€ç´¢å¼•ä¸æ”¯æŒè¡¨è¾¾å¼</p><p>2ã€åœ¨éœ€è¦ä½¿ç”¨å¤šä¸ªå­—æ®µä½œä¸ºæŸ¥è¯¢æ¡ä»¶çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨å¤šåˆ—ç´¢å¼•ï¼Œæ³¨æ„æœ€å·¦åŒ¹é…åŸåˆ™</p><p>3ã€ç´¢å¼•åˆ—çš„é¡ºåºè¦æ³¨æ„ï¼ŒåŒºåˆ†åº¦å¤§çš„åˆ—å†™åœ¨ç´¢å¼•çš„å‰é¢ï¼Œæ•ˆç‡ä¼šæ¯”è¾ƒé«˜</p><p>4ã€å‰ç¼€ç´¢å¼•ï¼Œå¯¹äºBlogï¼ŒTextä¹‹ç±»çš„å¤§å­—æ®µï¼Œå¿…é¡»ä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Œåªç´¢å¼•å¼€å§‹çš„éƒ¨åˆ†å­—ç¬¦ï¼Œå‰ç¼€é•¿åº¦çš„é€‰å–éœ€è¦æ ¹æ®ç´¢å¼•é€‰æ‹©æ€§æ¥ç¡®å®šã€‚</p><p>5ã€è¦†ç›–ç´¢å¼•ï¼ŒæŸ¥è¯¢çš„å­—æ®µå°½é‡ä¿å­˜åœ¨ç´¢å¼•ï¼Œé¿å…å›è¡¨ã€‚</p><h2 id="ç´¢å¼•çš„ä¼˜ç‚¹"><a href="#ç´¢å¼•çš„ä¼˜ç‚¹" class="headerlink" title="ç´¢å¼•çš„ä¼˜ç‚¹"></a>ç´¢å¼•çš„ä¼˜ç‚¹</h2><ul><li>å¤§å¤§å‡å°‘äº†æœåŠ¡å™¨éœ€è¦æ‰«æçš„æ•°æ®è¡Œæ•°ã€‚</li><li>å¸®åŠ©æœåŠ¡å™¨é¿å…è¿›è¡Œæ’åºå’Œåˆ†ç»„ï¼Œä»¥åŠé¿å…åˆ›å»ºä¸´æ—¶è¡¨ï¼ˆB+Tree ç´¢å¼•æ˜¯æœ‰åºçš„ï¼Œå¯ä»¥ç”¨äº ORDER BY å’Œ GROUP BY æ“ä½œã€‚ä¸´æ—¶è¡¨ä¸»è¦æ˜¯åœ¨æ’åºå’Œåˆ†ç»„è¿‡ç¨‹ä¸­åˆ›å»ºï¼Œä¸éœ€è¦æ’åºå’Œåˆ†ç»„ï¼Œä¹Ÿå°±ä¸éœ€è¦åˆ›å»ºä¸´æ—¶è¡¨ï¼‰ã€‚</li><li>å°†éšæœº I/O å˜ä¸ºé¡ºåº I/Oï¼ˆB+Tree ç´¢å¼•æ˜¯æœ‰åºçš„ï¼Œä¼šå°†ç›¸é‚»çš„æ•°æ®éƒ½å­˜å‚¨åœ¨ä¸€èµ·ï¼‰ã€‚</li></ul><h2 id="ç´¢å¼•çš„ä½¿ç”¨æ¡ä»¶"><a href="#ç´¢å¼•çš„ä½¿ç”¨æ¡ä»¶" class="headerlink" title="ç´¢å¼•çš„ä½¿ç”¨æ¡ä»¶"></a>ç´¢å¼•çš„ä½¿ç”¨æ¡ä»¶</h2><ul><li>å¯¹äºéå¸¸å°çš„è¡¨ã€å¤§éƒ¨åˆ†æƒ…å†µä¸‹ç®€å•çš„å…¨è¡¨æ‰«ææ¯”å»ºç«‹ç´¢å¼•æ›´é«˜æ•ˆï¼›</li><li>å¯¹äºä¸­åˆ°å¤§å‹çš„è¡¨ï¼Œç´¢å¼•å°±éå¸¸æœ‰æ•ˆï¼›</li><li>ä½†æ˜¯å¯¹äºç‰¹å¤§å‹çš„è¡¨ï¼Œå»ºç«‹å’Œç»´æŠ¤ç´¢å¼•çš„ä»£ä»·å°†ä¼šéšä¹‹å¢é•¿ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦ç”¨åˆ°ä¸€ç§æŠ€æœ¯å¯ä»¥ç›´æ¥åŒºåˆ†å‡ºéœ€è¦æŸ¥è¯¢çš„ä¸€ç»„æ•°æ®ï¼Œè€Œä¸æ˜¯ä¸€æ¡è®°å½•ä¸€æ¡è®°å½•åœ°åŒ¹é…ï¼Œä¾‹å¦‚å¯ä»¥ä½¿ç”¨åˆ†åŒºæŠ€æœ¯ã€‚</li></ul><p><strong>ä¸ºä»€ä¹ˆå¯¹äºéå¸¸å°çš„è¡¨ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹ç®€å•çš„å…¨è¡¨æ‰«ææ¯”å»ºç«‹ç´¢å¼•æ›´é«˜æ•ˆï¼Ÿ</strong></p><p>å¦‚æœä¸€ä¸ªè¡¨æ¯”è¾ƒå°ï¼Œé‚£ä¹ˆæ˜¾ç„¶ç›´æ¥éå†è¡¨æ¯”èµ°ç´¢å¼•è¦å¿«ï¼ˆå› ä¸ºéœ€è¦å›è¡¨ï¼‰ã€‚</p><p>âš ï¸æ³¨ï¼šé¦–å…ˆï¼Œè¦æ³¨æ„è¿™ä¸ªç­”æ¡ˆéšå«çš„æ¡ä»¶æ˜¯æŸ¥è¯¢çš„æ•°æ®ä¸æ˜¯ç´¢å¼•çš„æ„æˆéƒ¨åˆ†ï¼Œå¦ä¹Ÿä¸éœ€è¦å›è¡¨æ“ä½œã€‚å…¶æ¬¡ï¼ŒæŸ¥è¯¢æ¡ä»¶ä¹Ÿä¸æ˜¯ä¸»é”®ï¼Œå¦åˆ™å¯ä»¥ç›´æ¥ä»èšç°‡ç´¢å¼•ä¸­æ‹¿åˆ°æ•°æ®ã€‚</p><p><a href="https://mp.weixin.qq.com/s/faOaXRQM8p0kwseSHaMCbg">https://mp.weixin.qq.com/s/faOaXRQM8p0kwseSHaMCbg</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;MySQLä¸­æ”¯æŒçš„ç´¢å¼•&quot;&gt;&lt;a href=&quot;#MySQLä¸­æ”¯æŒçš„ç´¢å¼•&quot; class=&quot;headerlink&quot; title=&quot;MySQLä¸­æ”¯æŒçš„ç´¢å¼•&quot;&gt;&lt;/a&gt;MySQLä¸­æ”¯æŒçš„ç´¢å¼•&lt;/h1&gt;&lt;p&gt;ä¹‹å‰é—®è¿‡å­˜å‚¨å¼•æ“æ˜¯æ•°æ®åº“å±‚é¢çš„è¿˜æ˜¯æ•°æ®è¡¨å±‚é¢çš„ï¼Ÿ&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆ</summary>
      
    
    
    
    
    <category term="MySQL" scheme="http://example.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>MySQL-å­˜å‚¨å¼•æ“</title>
    <link href="http://example.com/wiki/MySQL-%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/"/>
    <id>http://example.com/wiki/MySQL-%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/</id>
    <published>2021-08-25T06:19:10.000Z</published>
    <updated>2021-08-25T06:47:19.374Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å­˜å‚¨å¼•æ“"><a href="#å­˜å‚¨å¼•æ“" class="headerlink" title="å­˜å‚¨å¼•æ“"></a>å­˜å‚¨å¼•æ“</h1><p><strong>MySQLæ”¯æŒå¾ˆå¤šç§å­˜å‚¨å¼•æ“ ğŸ‘‡</strong></p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210825143434715.png" style="zoom:50%;" /><p><font color=blue> <strong>æœ‰ä¸€ä¸ªé¢è¯•é¢˜ï¼šå­˜å‚¨å¼•æ“æ˜¯æ•°æ®åº“çº§åˆ«çš„è¿˜æ˜¯æ•°æ®è¡¨çº§åˆ«çš„ï¼Ÿ</strong></font></p><p>çœ‹ä¸Šå›¾åº”è¯¥å°±çŸ¥é“äº†å§ï¼ <strong>æ•°æ®è¡¨</strong>çº§åˆ«çš„</p><h2 id="InnoDB"><a href="#InnoDB" class="headerlink" title="InnoDB"></a>InnoDB</h2><p>InnoDB æ˜¯ MySQL é»˜è®¤çš„äº‹åŠ¡å‹å­˜å‚¨å¼•æ“ï¼Œåªè¦åœ¨éœ€è¦å®ƒä¸æ”¯æŒçš„ç‰¹æ€§æ—¶ï¼Œæ‰è€ƒè™‘ä½¿ç”¨å…¶ä»–å­˜å‚¨å¼•æ“ã€‚</p><p>InnoDB é‡‡ç”¨ <strong>MVCC æ¥æ”¯æŒé«˜å¹¶å‘</strong>ï¼Œå¹¶ä¸”å®ç°äº†å››ä¸ªæ ‡å‡†éš”ç¦»çº§åˆ«(æœªæäº¤è¯»ã€æäº¤è¯»ã€å¯é‡å¤è¯»ã€å¯ä¸²è¡ŒåŒ–)ã€‚å…¶é»˜è®¤çº§åˆ«æ—¶å¯é‡å¤è¯»ï¼ˆREPEATABLE READï¼‰ï¼Œåœ¨å¯é‡å¤è¯»çº§åˆ«ä¸‹ï¼Œé€šè¿‡ MVCC + Next-Key Locking é˜²æ­¢å¹»è¯»ã€‚</p><p>ä¸»ç´¢å¼•æ˜¯<strong>èšç°‡ç´¢å¼•</strong>ï¼Œåœ¨ç´¢å¼•ä¸­ä¿å­˜äº†æ•°æ®ï¼Œä»è€Œé¿å…ç›´æ¥è¯»å–ç£ç›˜ï¼Œå› æ­¤å¯¹ä¸»é”®æŸ¥è¯¢æœ‰å¾ˆé«˜çš„æ€§èƒ½ã€‚</p><p>InnoDB å†…éƒ¨åšäº†å¾ˆå¤šä¼˜åŒ–ï¼ŒåŒ…æ‹¬ä»ç£ç›˜è¯»å–æ•°æ®æ—¶é‡‡ç”¨çš„<strong>å¯é¢„æµ‹æ€§è¯»</strong>ï¼ˆå±€éƒ¨æ€§åŸç†ï¼‰ï¼Œèƒ½å¤Ÿè‡ªåŠ¨åœ¨å†…å­˜ä¸­åˆ›å»º hash ç´¢å¼•ä»¥åŠ é€Ÿè¯»æ“ä½œçš„è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•ï¼Œä»¥åŠèƒ½å¤ŸåŠ é€Ÿæ’å…¥æ“ä½œçš„æ’å…¥ç¼“å†²åŒºç­‰ã€‚</p><p>InnoDB æ”¯æŒçœŸæ­£çš„åœ¨çº¿çƒ­å¤‡ä»½ï¼ŒMySQL å…¶ä»–çš„å­˜å‚¨å¼•æ“ä¸æ”¯æŒåœ¨çº¿çƒ­å¤‡ä»½ï¼Œè¦è·å–ä¸€è‡´æ€§è§†å›¾éœ€è¦åœæ­¢å¯¹æ‰€æœ‰è¡¨çš„å†™å…¥ï¼Œè€Œåœ¨è¯»å†™æ··åˆçš„åœºæ™¯ä¸­ï¼Œåœæ­¢å†™å…¥å¯èƒ½ä¹Ÿæ„å‘³ç€åœæ­¢è¯»å–ã€‚</p><p>æ”¯æŒè¡Œçº§é”ï¼Œé—´éš™é”ã€‚</p><h2 id="MyISAM"><a href="#MyISAM" class="headerlink" title="MyISAM"></a>MyISAM</h2><p>è®¾è®¡ç®€å•ï¼Œæ•°æ®ä»¥ç´§å¯†æ ¼å¼å­˜å‚¨ã€‚å¯¹äºåªè¯»æ•°æ®ï¼Œæˆ–è€…è¡¨æ¯”è¾ƒå°ã€å¯ä»¥å®¹å¿ä¿®å¤æ“ä½œï¼Œåˆ™ä¾ç„¶å¯ä»¥ä½¿ç”¨å®ƒã€‚</p><p>æä¾›äº†å¤§é‡çš„ç‰¹æ€§ï¼ŒåŒ…æ‹¬<strong>å‹ç¼©è¡¨ã€ç©ºé—´æ•°æ®ç´¢å¼•</strong>ç­‰ã€‚</p><p>ä¸æ”¯æŒäº‹åŠ¡ã€‚</p><p>ä¸æ”¯æŒè¡Œçº§é”ï¼Œåªèƒ½å¯¹æ•´å¼ è¡¨åŠ é”ï¼Œè¯»å–æ—¶ä¼šå¯¹éœ€è¦è¯»åˆ°çš„æ‰€æœ‰è¡¨åŠ å…±äº«é”ï¼Œå†™å…¥æ—¶åˆ™å¯¹è¡¨åŠ æ’å®ƒé”ã€‚ä½†åœ¨è¡¨æœ‰è¯»å–æ“ä½œçš„åŒæ—¶ï¼Œä¹Ÿå¯ä»¥å¾€è¡¨ä¸­æ’å…¥æ–°çš„è®°å½•ï¼Œè¿™è¢«ç§°ä¸ºå¹¶å‘æ’å…¥ï¼ˆCONCURRENT INSERTï¼‰ã€‚</p><p>å¯ä»¥æ‰‹å·¥æˆ–è€…è‡ªåŠ¨æ‰§è¡Œæ£€æŸ¥å’Œä¿®å¤æ“ä½œï¼Œä½†æ˜¯å’Œäº‹åŠ¡æ¢å¤ä»¥åŠå´©æºƒæ¢å¤ä¸åŒï¼Œå¯èƒ½å¯¼è‡´ä¸€äº›æ•°æ®ä¸¢å¤±ï¼Œè€Œä¸”ä¿®å¤æ“ä½œæ˜¯éå¸¸æ…¢çš„ã€‚</p><p>å¦‚æœæŒ‡å®šäº† DELAY_KEY_WRITE é€‰é¡¹ï¼Œåœ¨æ¯æ¬¡ä¿®æ”¹æ‰§è¡Œå®Œæˆæ—¶ï¼Œä¸ä¼šç«‹å³å°†ä¿®æ”¹çš„ç´¢å¼•æ•°æ®å†™å…¥ç£ç›˜ï¼Œè€Œæ˜¯ä¼šå†™åˆ°å†…å­˜ä¸­çš„é”®ç¼“å†²åŒºï¼Œåªæœ‰åœ¨æ¸…ç†é”®ç¼“å†²åŒºæˆ–è€…å…³é—­è¡¨çš„æ—¶å€™æ‰ä¼šå°†å¯¹åº”çš„ç´¢å¼•å—å†™å…¥ç£ç›˜ã€‚è¿™ç§æ–¹å¼å¯ä»¥æå¤§çš„æå‡å†™å…¥æ€§èƒ½ï¼Œä½†æ˜¯åœ¨æ•°æ®åº“æˆ–è€…ä¸»æœºå´©æºƒæ—¶ä¼šé€ æˆç´¢å¼•æŸåï¼Œéœ€è¦æ‰§è¡Œä¿®å¤æ“ä½œã€‚</p><h3 id="InnoDB-å’Œ-MyISAM-çš„æ¯”è¾ƒ"><a href="#InnoDB-å’Œ-MyISAM-çš„æ¯”è¾ƒ" class="headerlink" title="InnoDB å’Œ MyISAM çš„æ¯”è¾ƒ"></a>InnoDB å’Œ MyISAM çš„æ¯”è¾ƒ</h3><ul><li>äº‹åŠ¡ï¼šInnoDB æ˜¯äº‹åŠ¡å‹çš„ï¼Œå¯ä»¥ä½¿ç”¨ Commit å’Œ Rollback è¯­å¥ã€‚</li><li>å¹¶å‘ï¼šMyISAM åªæ”¯æŒè¡¨çº§é”ï¼Œè€Œ InnoDB è¿˜æ”¯æŒè¡Œçº§é”ã€‚</li><li>å¤–é”®ï¼šInnoDB æ”¯æŒå¤–é”®ã€‚</li><li>å¤‡ä»½ï¼šInnoDB æ”¯æŒåœ¨çº¿çƒ­å¤‡ä»½ã€‚</li><li>å´©æºƒæ¢å¤ï¼šMyISAM å´©æºƒåå‘ç”ŸæŸåçš„æ¦‚ç‡æ¯” InnoDB é«˜å¾ˆå¤šï¼Œè€Œä¸”æ¢å¤çš„é€Ÿåº¦ä¹Ÿæ›´æ…¢ã€‚</li><li>ç´¢å¼•ï¼šInnoDBæ”¯æŒèšç°‡ç´¢å¼•ï¼ŒMyISAMæ”¯æŒéèšç°‡ç´¢å¼•</li><li>å…¶å®ƒç‰¹æ€§ï¼šMyISAM æ”¯æŒå‹ç¼©è¡¨å’Œç©ºé—´æ•°æ®ç´¢å¼•ã€‚</li></ul><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210825144111190.png" alt="image-20210825144111190"></p><p>ç”±ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼ŒInnoDBçš„å¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯æ•°æ®ï¼Œè€ŒMyISAMçš„å¶å­èŠ‚ç‚¹å­˜æ”¾çš„æ˜¯æ•°æ®æ‰€åœ¨çš„åœ°å€ã€‚</p><p>InnoDBæ˜¯é€šè¿‡B+æ ‘ç»“æ„å¯¹ä¸»é”®åˆ›å»ºç´¢å¼•ï¼Œç„¶åå¶å­èŠ‚ç‚¹ä¸­å­˜å‚¨è®°å½•ï¼Œå¦‚æœæ²¡æœ‰ä¸»é”®ï¼Œåˆ™ä¼šé€‰æ‹©ä¸€ä¸ªå”¯ä¸€é”®ï¼Œå¦‚æœä¹Ÿæ²¡æœ‰å”¯ä¸€é”®ï¼Œåˆ™ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª6ä½æ•°çš„row_idä½œä¸ºä¸»é”®</p><p>å¦‚æœåˆ›å»ºç´¢å¼•çš„é”®æ˜¯å…¶ä»–å­—æ®µï¼Œé‚£ä¹ˆå¶å­èŠ‚ç‚¹ä¸­å­˜å‚¨çš„æ˜¯è¯¥è®°å½•çš„ä¸»é”®ï¼Œé€šè¿‡ä¸»é”®ç´¢å¼•æ‰¾åˆ°å¯¹åº”çš„è®°å½•ï¼Œæ­¤è¿‡ç¨‹ç§°ä¹‹ä¸ºå›è¡¨ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å­˜å‚¨å¼•æ“&quot;&gt;&lt;a href=&quot;#å­˜å‚¨å¼•æ“&quot; class=&quot;headerlink&quot; title=&quot;å­˜å‚¨å¼•æ“&quot;&gt;&lt;/a&gt;å­˜å‚¨å¼•æ“&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;MySQLæ”¯æŒå¾ˆå¤šç§å­˜å‚¨å¼•æ“ ğŸ‘‡&lt;/strong&gt;&lt;/p&gt;
&lt;img src=&quot;https://cdn.j</summary>
      
    
    
    
    
    <category term="MySQL" scheme="http://example.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>MySQLç³»åˆ—åˆé›†</title>
    <link href="http://example.com/wiki/MySQL%E7%B3%BB%E5%88%97%E5%90%88%E9%9B%86/"/>
    <id>http://example.com/wiki/MySQL%E7%B3%BB%E5%88%97%E5%90%88%E9%9B%86/</id>
    <published>2021-08-25T06:18:51.000Z</published>
    <updated>2021-08-27T04:04:27.356Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æŠ€æœ¯ç›®å½•"><a href="#æŠ€æœ¯ç›®å½•" class="headerlink" title="æŠ€æœ¯ç›®å½•"></a>æŠ€æœ¯ç›®å½•</h3><p>MySQLåŸºç¡€çŸ¥è¯†</p><p>MySQLç³»ç»Ÿæ¶æ„</p><p>QueryCacheæ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆMySQL8åºŸå¼ƒäº†ï¼Ÿ</p><p>MySQLæ”¯æŒçš„å­˜å‚¨å¼•æ“ï¼ˆInnoDB&amp;MyISAMï¼‰</p><p>InnoDBåº•å±‚ç»“æ„ä»¥åŠåŸç†</p><p>MySQLäº‹åŠ¡çº§åˆ«ä»¥åŠå®ç°åŸç†</p><p>MySQLæ€§èƒ½è°ƒä¼˜</p><p><a href="https://mp.weixin.qq.com/s/nEmN4S9JOTVGj5IHyfNtCw">SQLè°ƒä¼˜æ€»ç»“</a></p><p>MySQLæ”¯æŒçš„ç´¢å¼•</p><p>MySQLä¸­çš„å„ç§é”ä½ éƒ½çŸ¥é“å—</p><p>ä¸ºä»€ä¹ˆæœ‰MVCCï¼Œè§£å†³äº†ä»€ä¹ˆé—®é¢˜</p><p>æ•°æ®åº“ä¸»ä»åŸç†ä»¥åŠå®ç°</p><p>åˆ†åº“åˆ†è¡¨åŸç†ä»¥åŠå®æˆ˜</p><h3 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h3><p><a href="https://github.com/AobingJava/JavaFamily">https://github.com/AobingJava/JavaFamily</a></p><p><a href="http://simpleframework.net/news/list?t=mysql">http://simpleframework.net/news/list?t=mysql</a></p><h3 id="ä¼˜ç¾ç»“æ„å›¾"><a href="#ä¼˜ç¾ç»“æ„å›¾" class="headerlink" title="ä¼˜ç¾ç»“æ„å›¾"></a>ä¼˜ç¾ç»“æ„å›¾</h3><p><a href="https://www.processon.com/mindmap/6127055f6376896024deffae">https://www.processon.com/mindmap/6127055f6376896024deffae</a></p><p><a href="https://www.processon.com/view/5e4a00f7e4b0369b9163d2c8?fromnew=1">https://www.processon.com/view/5e4a00f7e4b0369b9163d2c8?fromnew=1</a></p><p><a href="https://www.processon.com/view/60af54f21e08531e9c899e74?fromnew=1">https://www.processon.com/view/60af54f21e08531e9c899e74?fromnew=1</a></p><p><a href="https://www.processon.com/view/60c167ac0e3e7468f4c4de93?fromnew=1">https://www.processon.com/view/60c167ac0e3e7468f4c4de93?fromnew=1</a></p><p><a href="https://www.processon.com/view/609bd4041e08533e429e6a42?fromnew=1">https://www.processon.com/view/609bd4041e08533e429e6a42?fromnew=1</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;æŠ€æœ¯ç›®å½•&quot;&gt;&lt;a href=&quot;#æŠ€æœ¯ç›®å½•&quot; class=&quot;headerlink&quot; title=&quot;æŠ€æœ¯ç›®å½•&quot;&gt;&lt;/a&gt;æŠ€æœ¯ç›®å½•&lt;/h3&gt;&lt;p&gt;MySQLåŸºç¡€çŸ¥è¯†&lt;/p&gt;
&lt;p&gt;MySQLç³»ç»Ÿæ¶æ„&lt;/p&gt;
&lt;p&gt;QueryCacheæ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆMySQL8åºŸå¼ƒäº†ï¼Ÿ&lt;</summary>
      
    
    
    
    
    <category term="MySQL" scheme="http://example.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>Redis-Keyè¿‡æœŸç›‘å¬å™¨</title>
    <link href="http://example.com/wiki/Redis-Key%E8%BF%87%E6%9C%9F%E7%9B%91%E5%90%AC%E5%99%A8/"/>
    <id>http://example.com/wiki/Redis-Key%E8%BF%87%E6%9C%9F%E7%9B%91%E5%90%AC%E5%99%A8/</id>
    <published>2021-08-25T03:40:30.000Z</published>
    <updated>2021-08-25T04:10:01.516Z</updated>
    
    <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œæˆ‘åœ¨æŸå¹³å°å‘å¸ƒäº†ä¸€ç‰‡æ–‡ç« ï¼Œéœ€è¦åˆ¤æ–­è¿™ç‰‡æ–‡ç« åœ¨å‘å¸ƒä¹‹åï¼Œ10minï¼Œ30minï¼Œ1hï¼Œ3hï¼Œ1dï¼Œ3dæ—¶é—´ç‚¹çš„ç‚¹èµæ•°é‡å’Œå…³æ³¨æ•°é‡ï¼Œä½†æ˜¯å‘¢ï¼Œå¹³å°æ²¡æœ‰æä¾›ä¿¡æ¯ç»Ÿè®¡çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆåªèƒ½æˆ‘å®šæœŸå»æŸ¥çœ‹ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•å®ç°è¿™ä¸ªåŠŸèƒ½æˆ–è€…éœ€æ±‚å‘¢ï¼Ÿ</p><p>å½“æ—¶é¦–å…ˆæƒ³åˆ°çš„æ˜¯å®šæ—¶ä»»åŠ¡è½®è®­ï¼Œè¿™ç§æ–¹å¼å…¶å®æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯æ‚æ•°æ®åº“ï¼Œåˆ¤æ–­æ—¶é—´å°±å®Œäº‹äº†ï¼ŒåŒæ—¶è®°å½•è¿™ç‰‡æ–‡ç« å®šæ—¶ä»»åŠ¡æ‰§è¡Œäº†å¤šå°‘æ¬¡ï¼Œè¶…è¿‡ä¸€å®šæ¬¡æ•°ä¹‹åï¼Œè®¾ç½®æ ‡å¿—ä½ï¼Œé‚£ä¹ˆä¸‹æ¬¡å°±ä¸éœ€è¦ç­›é€‰è¿™äº›æ–‡ç« äº†ã€‚</p><p>ä½†æ˜¯è¿™ç§æ–¹å¼çš„ç¼ºç‚¹å¾ˆæ˜æ˜¾ï¼Œé¦–å…ˆå®šæ—¶ä»»åŠ¡æ‰§è¡Œçš„é¢‘ç‡æ”¹å¦‚ä½•è®¾ç½®å‘¢ï¼Œåº”è¯¥æ˜¯æœ€å°æ—¶é—´10minã€‚ä¹Ÿå°±æ˜¯æ¯10minæ‚ä¸€æ¬¡åº“ï¼ŒæŸ¥å‡ºæ¥çš„æ•°æ®ï¼Œå†å»æ‰§è¡Œä¸šåŠ¡é€»è¾‘ã€‚å½“æ•°æ®é‡å¾ˆå¤§çš„æ—¶å€™ï¼Œè¿™ä¸ªå®šæ—¶ä»»åŠ¡å°±ä¼šæ˜¾å¾—æ¯”è¾ƒé‡äº†ã€‚</p><p>äºæ˜¯æˆ‘æƒ³åˆ°äº†åŸºäºäº‹ä»¶è§¦å‘çš„æ–¹å¼å»è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚å»¶æ—¶é˜Ÿåˆ—ï¼Œredisè¿‡æœŸç­–ç•¥å•Šç­‰ç­‰ï¼Œåº”è¯¥æœ‰å¾ˆå¤šã€‚</p><p>è¿™é‡Œè¯´åˆ°å»¶æ—¶é˜Ÿåˆ—ï¼Œä¸ºä»€ä¹ˆæˆ‘æ²¡æœ‰ç”¨JDKè‡ªå¸¦çš„DelayQueueå‘¢ï¼Œæ¯•ç«Ÿè¿™äº›æ•°æ®éƒ½æ˜¯æ”¾åœ¨å†…å­˜ä¸­ï¼Œè¿˜æ˜¯è§£å†³ä¸äº†å†…å­˜çš„é—®é¢˜ã€‚</p><p>è¿˜æœ‰é€šè¿‡redisçš„sort setæ•°æ®ç»“æœæ¥åšçš„æ–¹å¼ï¼Œscoreå­˜çš„æ˜¯æ—¶é—´æˆ³ï¼Œè¿™ç§æ–¹å¼å…¶å®è¦æ¯”ç›´æ¥æ‚æ•°æ®åº“è¦å¥½çš„å¤šã€‚</p><p>æœ€åæˆ‘é€‰æ‹©ä½¿ç”¨redisè¿‡æœŸç›‘å¬ç­–ç•¥æ¥å®ç°è¿™ä¸ªéœ€æ±‚ï¼Œå„ä½å¤§ä½¬ä»¬æœ‰ä»€ä¹ˆåˆ«çš„æ–¹æ¡ˆå‘¢ï¼Ÿ</p><h2 id="redisè¿‡æœŸç›‘å¬"><a href="#redisè¿‡æœŸç›‘å¬" class="headerlink" title="redisè¿‡æœŸç›‘å¬"></a>redisè¿‡æœŸç›‘å¬</h2><h3 id="é¦–å…ˆè®¾ç½®ä¸€ä¸‹redisçš„é€šçŸ¥äº‹ä»¶"><a href="#é¦–å…ˆè®¾ç½®ä¸€ä¸‹redisçš„é€šçŸ¥äº‹ä»¶" class="headerlink" title="é¦–å…ˆè®¾ç½®ä¸€ä¸‹redisçš„é€šçŸ¥äº‹ä»¶"></a>é¦–å…ˆè®¾ç½®ä¸€ä¸‹redisçš„é€šçŸ¥äº‹ä»¶</h3><p>éœ€è¦è®¾ç½®redisé…ç½®æ–‡ä»¶ <code>notify-keyspace-events Ex</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> For instance <span class="keyword">if</span> keyspace events notification is enabled, and a client</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> performs a DEL operation on key <span class="string">&quot;foo&quot;</span> stored <span class="keyword">in</span> the Database 0, two</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> messages will be published via Pub/Sub:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="bash"><span class="comment"># PUBLISH __keyspace@0__:foo del</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> PUBLISH __keyevent@0__:del foo</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  K     Keyspace events, published with __keyspace@&lt;db&gt;__ prefix.</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  E     Keyevent events, published with __keyevent@&lt;db&gt;__ prefix.</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  g     Generic commands (non-type specific) like DEL, EXPIRE, RENAME, ...</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  $     String commands</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  l     List commands</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  s     Set commands</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  h     Hash commands</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  z     Sorted <span class="built_in">set</span> commands</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  x     Expired events (events generated every time a key expires)</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  e     Evicted events (events generated when a key is evicted <span class="keyword">for</span> maxmemory)</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  t     Stream commands</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  d     Module key <span class="built_in">type</span> events</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  m     Key-miss events (Note: It is not included <span class="keyword">in</span> the <span class="string">&#x27;A&#x27;</span> class)</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  A     Alias <span class="keyword">for</span> g<span class="variable">$lshzxetd</span>, so that the <span class="string">&quot;AKE&quot;</span> string means all the events</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        (Except key-miss events <span class="built_in">which</span> are excluded from <span class="string">&#x27;A&#x27;</span> due to their</span></span><br><span class="line"><span class="meta">#</span><span class="bash">         unique nature).</span></span><br></pre></td></tr></table></figure><p>æˆ–è€…ä½¿ç”¨å‘½ä»¤ <code>CONFIG set notify-keyspace-events Ex</code></p><h3 id="Springboot-é›†æˆredis"><a href="#Springboot-é›†æˆredis" class="headerlink" title="Springboot é›†æˆredis"></a>Springboot é›†æˆredis</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Primary</span></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function">RedisTemplate&lt;String, T&gt; <span class="title">getRedisTemplate</span><span class="params">(RedisConnectionFactory redisConnectionFactory)</span> </span>&#123;</span><br><span class="line">        RedisTemplate&lt;String, T&gt; redisTemplate = <span class="keyword">new</span> RedisTemplate&lt;&gt;();</span><br><span class="line">        redisTemplate.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">        redisTemplate.setKeySerializer(<span class="keyword">new</span> StringRedisSerializer());</span><br><span class="line">        redisTemplate.setValueSerializer(<span class="keyword">new</span> GenericFastJsonRedisSerializer());</span><br><span class="line">        redisTemplate.setHashKeySerializer(<span class="keyword">new</span> StringRedisSerializer());</span><br><span class="line">        redisTemplate.setHashValueSerializer(<span class="keyword">new</span> GenericFastJsonRedisSerializer());</span><br><span class="line">        <span class="keyword">return</span> redisTemplate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RedisTemplate&lt;Object, Object&gt; <span class="title">redisTemplate</span><span class="params">(RedisConnectionFactory redisConnectionFactory)</span> </span>&#123;</span><br><span class="line">        RedisTemplate&lt;Object, Object&gt; redisTemplate = <span class="keyword">new</span> RedisTemplate&lt;&gt;();</span><br><span class="line">        redisTemplate.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">        redisTemplate.setKeySerializer(<span class="keyword">new</span> StringRedisSerializer());</span><br><span class="line">        redisTemplate.setValueSerializer(<span class="keyword">new</span> GenericFastJsonRedisSerializer());</span><br><span class="line">        redisTemplate.setHashKeySerializer(<span class="keyword">new</span> StringRedisSerializer());</span><br><span class="line">        redisTemplate.setHashValueSerializer(<span class="keyword">new</span> GenericFastJsonRedisSerializer());</span><br><span class="line">        <span class="keyword">return</span> redisTemplate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> StringRedisTemplate <span class="title">stringRedisTemplate</span><span class="params">(RedisConnectionFactory redisConnectionFactory)</span> </span>&#123;</span><br><span class="line">        StringRedisTemplate stringRedisTemplate = <span class="keyword">new</span> StringRedisTemplate();</span><br><span class="line">        stringRedisTemplate.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RedisScript&lt;Boolean&gt; <span class="title">hitMaxScript</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        DefaultRedisScript&lt;Boolean&gt; redisScript = <span class="keyword">new</span> DefaultRedisScript&lt;&gt;();</span><br><span class="line">        redisScript.setScriptSource(<span class="keyword">new</span> ResourceScriptSource(<span class="keyword">new</span> ClassPathResource(<span class="string">&quot;scripts/hitmax.lua&quot;</span>)));</span><br><span class="line">        redisScript.setResultType(Boolean.class);</span><br><span class="line">        <span class="keyword">return</span> redisScript;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function">RedisMessageListenerContainer <span class="title">container</span><span class="params">(RedisConnectionFactory redisConnectionFactory)</span> </span>&#123;</span><br><span class="line">        RedisMessageListenerContainer container = <span class="keyword">new</span> RedisMessageListenerContainer();</span><br><span class="line">        container.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">        container.setTaskExecutor(executor());</span><br><span class="line">        Topic topic = <span class="keyword">new</span> PatternTopic(RedisKeyExpirationListener.LISTENER_PATTERN);</span><br><span class="line">        container.addMessageListener(<span class="keyword">new</span> RedisKeyExpirationListener(), topic);</span><br><span class="line">        <span class="keyword">return</span> container;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Executor <span class="title">executor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ThreadPoolTaskExecutor executor = <span class="keyword">new</span> ThreadPoolTaskExecutor();</span><br><span class="line">        executor.setCorePoolSize(<span class="number">10</span>);</span><br><span class="line">        executor.setMaxPoolSize(<span class="number">20</span>);</span><br><span class="line">        executor.setQueueCapacity(<span class="number">100</span>);</span><br><span class="line">        executor.setKeepAliveSeconds(<span class="number">60</span>);</span><br><span class="line">        executor.setThreadNamePrefix(<span class="string">&quot;V-Thread&quot;</span>);</span><br><span class="line">        executor.setRejectedExecutionHandler(<span class="keyword">new</span> ThreadPoolExecutor.CallerRunsPolicy());</span><br><span class="line">        executor.initialize();</span><br><span class="line">        <span class="keyword">return</span> executor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è‡ªå®šä¹‰ç›‘å¬å™¨é‡å†™onMessageæ–¹æ³•"><a href="#è‡ªå®šä¹‰ç›‘å¬å™¨é‡å†™onMessageæ–¹æ³•" class="headerlink" title="è‡ªå®šä¹‰ç›‘å¬å™¨é‡å†™onMessageæ–¹æ³•"></a>è‡ªå®šä¹‰ç›‘å¬å™¨é‡å†™onMessageæ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisKeyExpirationListener</span> <span class="keyword">implements</span> <span class="title">MessageListener</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String LISTENER_PATTERN = <span class="string">&quot;__key*@*__:*&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(Message message, <span class="keyword">byte</span>[] pattern)</span> </span>&#123;</span><br><span class="line">        System.err.println(<span class="string">&quot;è§¦å‘ç›‘å¬å™¨ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">        String body = <span class="keyword">new</span> String(message.getBody());</span><br><span class="line">        String channel = <span class="keyword">new</span> String(message.getChannel());</span><br><span class="line">        System.out.println(<span class="string">&quot;onMessageÂ &gt;&gt;Â &quot;</span>+String.format(<span class="string">&quot;channel:Â %s,Â body:Â %s,Â bytes:Â %s&quot;</span>,channel,body,<span class="keyword">new</span> String(pattern)));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210825120806260.png" alt="image-20210825120806260"></p><p><strong>é¡¹ç›®æ§åˆ¶å°ï¼š</strong></p><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210825120841859.png" alt="image-20210825120841859"></p><p>âš ï¸ ç›‘å¬keyè¿‡æœŸæ—¶é—´æ˜¯ä¸èƒ½è·å–keyçš„valueçš„ï¼Œå› ä¸ºè¿™ä¸ªæ—¶é—´æ˜¯keyè¿‡æœŸæ‰è§¦å‘çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠå…³é”®ä¿¡æ¯æ”¾åˆ°keyä¸Šå°±è¡Œäº†</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h2&gt;&lt;p&gt;æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œæˆ‘åœ¨æŸå¹³å°å‘å¸ƒäº†ä¸€ç‰‡æ–‡ç« ï¼Œéœ€è¦åˆ¤æ–­è¿™ç‰‡æ–‡ç« åœ¨å‘å¸ƒä¹‹åï¼Œ10minï¼Œ30minï¼Œ1hï¼Œ3hï¼Œ1dï¼Œ3dæ—¶é—´ç‚¹çš„ç‚¹èµæ•°é‡å’Œå…³æ³¨æ•°é‡ï¼Œ</summary>
      
    
    
    
    
    <category term="Redis" scheme="http://example.com/tags/Redis/"/>
    
  </entry>
  
  <entry>
    <title>Webå¼€å‘åŸºç¡€-Servlet</title>
    <link href="http://example.com/wiki/Web%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80-Servlet/"/>
    <id>http://example.com/wiki/Web%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80-Servlet/</id>
    <published>2021-08-24T08:00:44.000Z</published>
    <updated>2021-08-24T10:00:32.561Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1ã€ä»€ä¹ˆæ˜¯servlet"><a href="#1ã€ä»€ä¹ˆæ˜¯servlet" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯servlet"></a>1ã€ä»€ä¹ˆæ˜¯servlet</h2><p><strong>ä»€ä¹ˆæ˜¯Serlvetï¼Ÿ</strong></p><p>Servletå…¶å®å°±æ˜¯ä¸€ä¸ª<strong>éµå¾ªServletå¼€å‘çš„javaç±»</strong>ã€‚Serlvetæ˜¯<strong>ç”±æœåŠ¡å™¨è°ƒç”¨çš„</strong>ï¼Œ<strong>è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯</strong>ã€‚</p><p>æˆ‘ä»¬ç¼–å†™javaç¨‹åºæƒ³è¦åœ¨ç½‘ä¸Šå®ç° èŠå¤©ã€å‘å¸–ã€è¿™æ ·ä¸€äº›çš„äº¤äº’åŠŸèƒ½ï¼Œ<strong>æ™®é€šçš„javaæŠ€æœ¯æ˜¯éå¸¸éš¾å®Œæˆçš„</strong>ã€‚sunå…¬å¸å°±æä¾›äº†Serlvetè¿™ç§æŠ€æœ¯ä¾›æˆ‘ä»¬ä½¿ç”¨ã€‚</p><h2 id="2ã€servletç”Ÿå‘½å‘¨æœŸ"><a href="#2ã€servletç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="2ã€servletç”Ÿå‘½å‘¨æœŸ"></a>2ã€servletç”Ÿå‘½å‘¨æœŸ</h2><p><strong>Servletç”Ÿå‘½å‘¨æœŸå¯åˆ†ä¸º5ä¸ªæ­¥éª¤</strong></p><ol><li><strong>åŠ è½½Servlet</strong>ã€‚å½“Tomcatç¬¬ä¸€æ¬¡è®¿é—®Servletçš„æ—¶å€™ï¼Œ<strong>Tomcatä¼šè´Ÿè´£åˆ›å»ºServletçš„å®ä¾‹</strong></li><li><strong>åˆå§‹åŒ–</strong>ã€‚å½“Servletè¢«å®ä¾‹åŒ–åï¼ŒTomcatä¼š<strong>è°ƒç”¨init()æ–¹æ³•åˆå§‹åŒ–è¿™ä¸ªå¯¹è±¡</strong></li><li><strong>å¤„ç†æœåŠ¡</strong>ã€‚å½“æµè§ˆå™¨<strong>è®¿é—®Servlet</strong>çš„æ—¶å€™ï¼ŒServlet <strong>ä¼šè°ƒç”¨service()æ–¹æ³•å¤„ç†è¯·æ±‚</strong></li><li><strong>é”€æ¯</strong>ã€‚å½“Tomcatå…³é—­æ—¶æˆ–è€…æ£€æµ‹åˆ°Servletè¦ä»Tomcatåˆ é™¤çš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨destroy()æ–¹æ³•ï¼Œ<strong>è®©è¯¥å®ä¾‹é‡Šæ”¾æ‰æ‰€å çš„èµ„æº</strong>ã€‚ä¸€ä¸ªServletå¦‚æœé•¿æ—¶é—´ä¸è¢«ä½¿ç”¨çš„è¯ï¼Œä¹Ÿä¼šè¢«Tomcatè‡ªåŠ¨é”€æ¯</li><li><strong>å¸è½½</strong>ã€‚å½“Servletè°ƒç”¨å®Œdestroy()æ–¹æ³•åï¼Œç­‰å¾…åƒåœ¾å›æ”¶ã€‚å¦‚æœ<strong>æœ‰éœ€è¦å†æ¬¡ä½¿ç”¨è¿™ä¸ªServletï¼Œä¼šé‡æ–°è°ƒç”¨init()æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–æ“ä½œ</strong>ã€‚</li></ol><ul><li>ç®€å•æ€»ç»“ï¼š<strong>åªè¦è®¿é—®Servletï¼Œservice()å°±ä¼šè¢«è°ƒç”¨ã€‚init()åªæœ‰ç¬¬ä¸€æ¬¡è®¿é—®Servletçš„æ—¶å€™æ‰ä¼šè¢«è°ƒç”¨ã€‚ destroy()åªæœ‰åœ¨Tomcatå…³é—­çš„æ—¶å€™æ‰ä¼šè¢«è°ƒç”¨ã€‚</strong></li></ul><h2 id="3ã€servletè°ƒç”¨æµç¨‹"><a href="#3ã€servletè°ƒç”¨æµç¨‹" class="headerlink" title="3ã€servletè°ƒç”¨æµç¨‹"></a>3ã€servletè°ƒç”¨æµç¨‹</h2><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210824161820602.png" alt="image-20210824161820602"></p><h2 id="4ã€Servletæ˜¯å•ä¾‹çš„"><a href="#4ã€Servletæ˜¯å•ä¾‹çš„" class="headerlink" title="4ã€Servletæ˜¯å•ä¾‹çš„"></a>4ã€Servletæ˜¯å•ä¾‹çš„</h2><h3 id="4-1-ä¸ºä»€ä¹ˆServletæ˜¯å•ä¾‹çš„"><a href="#4-1-ä¸ºä»€ä¹ˆServletæ˜¯å•ä¾‹çš„" class="headerlink" title="4.1 ä¸ºä»€ä¹ˆServletæ˜¯å•ä¾‹çš„"></a>4.1 ä¸ºä»€ä¹ˆServletæ˜¯å•ä¾‹çš„</h3><p><strong>æµè§ˆå™¨å¤šæ¬¡å¯¹Servletçš„è¯·æ±‚</strong>ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ<strong>æœåŠ¡å™¨åªåˆ›å»ºä¸€ä¸ªServletå¯¹è±¡</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒServletå¯¹è±¡<strong>ä¸€æ—¦åˆ›å»ºäº†</strong>ï¼Œå°±ä¼š<strong>é©»ç•™åœ¨å†…å­˜ä¸­ï¼Œä¸ºåç»­çš„è¯·æ±‚åšæœåŠ¡ï¼Œç›´åˆ°æœåŠ¡å™¨å…³é—­</strong>ã€‚</p><h3 id="4-2-æ¯æ¬¡è®¿é—®è¯·æ±‚å¯¹è±¡å’Œå“åº”å¯¹è±¡éƒ½æ˜¯æ–°çš„"><a href="#4-2-æ¯æ¬¡è®¿é—®è¯·æ±‚å¯¹è±¡å’Œå“åº”å¯¹è±¡éƒ½æ˜¯æ–°çš„" class="headerlink" title="4.2 æ¯æ¬¡è®¿é—®è¯·æ±‚å¯¹è±¡å’Œå“åº”å¯¹è±¡éƒ½æ˜¯æ–°çš„"></a>4.2 æ¯æ¬¡è®¿é—®è¯·æ±‚å¯¹è±¡å’Œå“åº”å¯¹è±¡éƒ½æ˜¯æ–°çš„</h3><p>å¯¹äº<strong>æ¯æ¬¡è®¿é—®è¯·æ±‚</strong>ï¼ŒServletå¼•æ“éƒ½ä¼š<strong>åˆ›å»ºä¸€ä¸ªæ–°çš„HttpServletRequestè¯·æ±‚å¯¹è±¡å’Œä¸€ä¸ªæ–°çš„HttpServletResponseå“åº”å¯¹è±¡</strong>ï¼Œç„¶åå°†è¿™ä¸¤<strong>ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’ç»™å®ƒè°ƒç”¨çš„Servletçš„service()æ–¹æ³•</strong>ï¼Œ<strong>serviceæ–¹æ³•å†æ ¹æ®è¯·æ±‚æ–¹å¼åˆ†åˆ«è°ƒç”¨doXXXæ–¹æ³•</strong>ã€‚</p><h3 id="4-3-çº¿ç¨‹å®‰å…¨é—®é¢˜"><a href="#4-3-çº¿ç¨‹å®‰å…¨é—®é¢˜" class="headerlink" title="4.3 çº¿ç¨‹å®‰å…¨é—®é¢˜"></a>4.3 çº¿ç¨‹å®‰å…¨é—®é¢˜</h3><p>å½“å¤šä¸ªç”¨æˆ·è®¿é—®Servletçš„æ—¶å€™ï¼Œ<strong>æœåŠ¡å™¨ä¼šä¸ºæ¯ä¸ªç”¨æˆ·åˆ›å»ºä¸€ä¸ªçº¿ç¨‹</strong>ã€‚<strong>å½“å¤šä¸ªç”¨æˆ·å¹¶å‘è®¿é—®Servletå…±äº«èµ„æºçš„æ—¶å€™å°±ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜</strong>ã€‚</p><p>åŸåˆ™ï¼š</p><ol><li>å¦‚æœä¸€ä¸ª<strong>å˜é‡éœ€è¦å¤šä¸ªç”¨æˆ·å…±äº«</strong>ï¼Œåˆ™åº”å½“åœ¨è®¿é—®è¯¥å˜é‡çš„æ—¶å€™ï¼Œ<strong>åŠ åŒæ­¥æœºåˆ¶synchronized (å¯¹è±¡){}</strong></li><li>å¦‚æœä¸€ä¸ªå˜é‡<strong>ä¸éœ€è¦å…±äº«</strong>ï¼Œåˆ™<strong>ç›´æ¥åœ¨ doGet() æˆ–è€… doPost()å®šä¹‰</strong>.è¿™æ ·ä¸ä¼šå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜</li></ol><h2 id="5ã€ServletConfigå¯¹è±¡"><a href="#5ã€ServletConfigå¯¹è±¡" class="headerlink" title="5ã€ServletConfigå¯¹è±¡"></a>5ã€ServletConfigå¯¹è±¡</h2><h3 id="5-1-ServletConfigå¯¹è±¡æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#5-1-ServletConfigå¯¹è±¡æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="5.1 ServletConfigå¯¹è±¡æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>5.1 ServletConfigå¯¹è±¡æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><blockquote><p>é€šè¿‡æ­¤å¯¹è±¡å¯ä»¥è¯»å–web.xmlä¸­é…ç½®çš„åˆå§‹åŒ–å‚æ•°ã€‚</p></blockquote><p>ç°åœ¨é—®é¢˜æ¥äº†ï¼Œ<strong>ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦æŠŠå‚æ•°ä¿¡æ¯æ”¾åˆ°web.xmlæ–‡ä»¶ä¸­å‘¢</strong>ï¼Ÿæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ç¨‹åºä¸­éƒ½å¯ä»¥å®šä¹‰å‚æ•°ä¿¡æ¯ï¼Œ<strong>æåˆ°web.xmlæ–‡ä»¶ä¸­åˆæœ‰ä»€ä¹ˆå¥½å¤„å‘¢</strong>ï¼Ÿ</p><p>å¥½å¤„å°±æ˜¯ï¼š<strong>èƒ½å¤Ÿè®©ä½ çš„ç¨‹åºæ›´åŠ çµæ´»</strong>ã€æ›´æ¢éœ€æ±‚ï¼Œæ›´æ”¹é…ç½®æ–‡ä»¶web.xmlå³å¯ï¼Œç¨‹åºä»£ç ä¸ç”¨æ”¹ã€‘</p><h3 id="5-2-è·å–web-xmlæ–‡ä»¶é…ç½®çš„å‚æ•°ä¿¡æ¯"><a href="#5-2-è·å–web-xmlæ–‡ä»¶é…ç½®çš„å‚æ•°ä¿¡æ¯" class="headerlink" title="5.2 è·å–web.xmlæ–‡ä»¶é…ç½®çš„å‚æ•°ä¿¡æ¯"></a>5.2 è·å–web.xmlæ–‡ä»¶é…ç½®çš„å‚æ•°ä¿¡æ¯</h3><p>ä¸ºDemo1è¿™ä¸ªServleté…ç½®ä¸€ä¸ªå‚æ•°ï¼Œå‚æ•°åæ˜¯nameï¼Œå€¼æ˜¯zhongfucheng</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>Demo1<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>zhongfucheng.web.Demo1<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">init-param</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>name<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>zhongfucheng<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>Demo1<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/Demo1<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨Servletä¸­è·å–ServletConfigå¯¹è±¡ï¼Œé€šè¿‡ServletConfigå¯¹è±¡è·å–åœ¨web.xmlæ–‡ä»¶é…ç½®çš„å‚æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ServletConfig config = <span class="keyword">this</span>.getServletConfig();</span><br><span class="line">String name = config.getInitParameter(<span class="string">&quot;name&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="6ã€ServletContextå¯¹è±¡"><a href="#6ã€ServletContextå¯¹è±¡" class="headerlink" title="6ã€ServletContextå¯¹è±¡"></a>6ã€ServletContextå¯¹è±¡</h2><h3 id="6-1-ä»€ä¹ˆæ˜¯ServletContextå¯¹è±¡ï¼Ÿ"><a href="#6-1-ä»€ä¹ˆæ˜¯ServletContextå¯¹è±¡ï¼Ÿ" class="headerlink" title="6.1 ä»€ä¹ˆæ˜¯ServletContextå¯¹è±¡ï¼Ÿ"></a>6.1 ä»€ä¹ˆæ˜¯ServletContextå¯¹è±¡ï¼Ÿ</h3><p>å½“Tomcatå¯åŠ¨çš„æ—¶å€™ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªServletContextå¯¹è±¡ã€‚å®ƒ<strong>ä»£è¡¨ç€å½“å‰webç«™ç‚¹</strong></p><h3 id="6-2-ServletContextæœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#6-2-ServletContextæœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="6.2 ServletContextæœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>6.2 ServletContextæœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><ol><li>ServletContextæ—¢ç„¶ä»£è¡¨ç€å½“å‰webç«™ç‚¹ï¼Œé‚£ä¹ˆ<strong>æ‰€æœ‰Servletéƒ½å…±äº«ç€ä¸€ä¸ªServletContextå¯¹è±¡</strong>ï¼Œæ‰€ä»¥<strong>Servletä¹‹é—´å¯ä»¥é€šè¿‡ServletContextå®ç°é€šè®¯</strong>ã€‚</li><li>ServletConfigè·å–çš„æ˜¯é…ç½®çš„æ˜¯å•ä¸ªServletçš„å‚æ•°ä¿¡æ¯ï¼Œ<strong>ServletContextå¯ä»¥è·å–çš„æ˜¯é…ç½®æ•´ä¸ªwebç«™ç‚¹çš„å‚æ•°ä¿¡æ¯</strong></li><li><strong>åˆ©ç”¨ServletContextè¯»å–webç«™ç‚¹çš„èµ„æºæ–‡ä»¶</strong></li><li>å®ç°Servletçš„è½¬å‘ã€ç”¨ServletContextè½¬å‘ä¸å¤šï¼Œä¸»è¦ç”¨requestè½¬å‘ã€‘</li></ol><h2 id="7ã€ä»€ä¹ˆæ˜¯ä¼šè¯æŠ€æœ¯"><a href="#7ã€ä»€ä¹ˆæ˜¯ä¼šè¯æŠ€æœ¯" class="headerlink" title="7ã€ä»€ä¹ˆæ˜¯ä¼šè¯æŠ€æœ¯"></a>7ã€ä»€ä¹ˆæ˜¯ä¼šè¯æŠ€æœ¯</h2><blockquote><p>åŸºæœ¬æ¦‚å¿µ: æŒ‡ç”¨æˆ·å¼€ä¸€ä¸ªæµè§ˆå™¨ï¼Œ<strong>è®¿é—®ä¸€ä¸ªç½‘ç«™,åªè¦ä¸å…³é—­è¯¥æµè§ˆå™¨ï¼Œä¸ç®¡è¯¥ç”¨æˆ·ç‚¹å‡»å¤šå°‘ä¸ªè¶…é“¾æ¥ï¼Œè®¿é—®å¤šå°‘èµ„æºï¼Œç›´åˆ°ç”¨æˆ·å…³é—­æµè§ˆå™¨ï¼Œæ•´ä¸ªè¿™ä¸ªè¿‡ç¨‹æˆ‘ä»¬ç§°ä¸ºä¸€æ¬¡ä¼šè¯</strong>.</p></blockquote><h3 id="7-1-ä»€ä¹ˆæ˜¯Cookie"><a href="#7-1-ä»€ä¹ˆæ˜¯Cookie" class="headerlink" title="7.1 ä»€ä¹ˆæ˜¯Cookie"></a>7.1 ä»€ä¹ˆæ˜¯Cookie</h3><blockquote><p>Cookieæ˜¯ç”±W3Cç»„ç»‡æå‡ºï¼Œæœ€æ—©ç”±netscapeç¤¾åŒºå‘å±•çš„ä¸€ç§æœºåˆ¶</p></blockquote><ul><li>ç½‘é¡µä¹‹é—´çš„<strong>äº¤äº’æ˜¯é€šè¿‡HTTPåè®®ä¼ è¾“æ•°æ®çš„ï¼Œ</strong>è€ŒHttpåè®®æ˜¯<strong>æ— çŠ¶æ€çš„åè®®</strong>ã€‚æ— çŠ¶æ€çš„åè®®æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ<strong>ä¸€æ—¦æ•°æ®æäº¤å®Œåï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨çš„è¿æ¥å°±ä¼šå…³é—­ï¼Œå†æ¬¡äº¤äº’çš„æ—¶å€™éœ€è¦é‡æ–°å»ºç«‹æ–°çš„è¿æ¥</strong>ã€‚</li><li>æœåŠ¡å™¨æ— æ³•ç¡®è®¤ç”¨æˆ·çš„ä¿¡æ¯ï¼Œäºæ˜¯ä¹ï¼ŒW3Cå°±æå‡ºäº†ï¼š<strong>ç»™æ¯ä¸€ä¸ªç”¨æˆ·éƒ½å‘ä¸€ä¸ªé€šè¡Œè¯ï¼Œæ— è®ºè°è®¿é—®çš„æ—¶å€™éƒ½éœ€è¦æºå¸¦é€šè¡Œè¯ï¼Œè¿™æ ·æœåŠ¡å™¨å°±å¯ä»¥ä»é€šè¡Œè¯ä¸Šç¡®è®¤ç”¨æˆ·çš„ä¿¡æ¯</strong>ã€‚é€šè¡Œè¯å°±æ˜¯Cookie</li></ul><h4 id="7-11-Cookieçš„æµç¨‹"><a href="#7-11-Cookieçš„æµç¨‹" class="headerlink" title="7.11 Cookieçš„æµç¨‹"></a>7.11 Cookieçš„æµç¨‹</h4><p>æµè§ˆå™¨è®¿é—®æœåŠ¡å™¨ï¼Œ<strong>å¦‚æœæœåŠ¡å™¨éœ€è¦è®°å½•è¯¥ç”¨æˆ·çš„çŠ¶æ€ï¼Œå°±ä½¿ç”¨responseå‘æµè§ˆå™¨å‘é€ä¸€ä¸ªCookieï¼Œæµè§ˆå™¨ä¼šæŠŠCookieä¿å­˜èµ·æ¥ã€‚å½“æµè§ˆå™¨å†æ¬¡è®¿é—®æœåŠ¡å™¨çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šæŠŠè¯·æ±‚çš„ç½‘å€è¿åŒCookieä¸€åŒäº¤ç»™æœåŠ¡å™¨</strong>ã€‚</p><h4 id="7-1-2-Cookie-API"><a href="#7-1-2-Cookie-API" class="headerlink" title="7.1.2 Cookie API"></a>7.1.2 Cookie API</h4><ul><li>Cookieç±»ç”¨äºåˆ›å»ºä¸€ä¸ªCookieå¯¹è±¡</li><li>responseæ¥å£ä¸­å®šä¹‰äº†ä¸€ä¸ªaddCookieæ–¹æ³•ï¼Œå®ƒç”¨äºåœ¨å…¶å“åº”å¤´ä¸­å¢åŠ ä¸€ä¸ªç›¸åº”çš„Set-Cookieå¤´å­—æ®µ</li><li>requestæ¥å£ä¸­å®šä¹‰äº†ä¸€ä¸ªgetCookiesæ–¹æ³•ï¼Œå®ƒç”¨äºè·å–å®¢æˆ·ç«¯æäº¤çš„Cookie</li></ul><p><strong>å¸¸ç”¨çš„Cookieæ–¹æ³•ï¼š</strong></p><ul><li>public Cookie(String name,String value)</li><li>setValueä¸getValueæ–¹æ³•</li><li>setMaxAgeä¸getMaxAgeæ–¹æ³•</li><li>setPathä¸getPathæ–¹æ³•</li><li>setDomainä¸getDomainæ–¹æ³•</li><li>getNameæ–¹æ³•</li></ul><h4 id="7-1-3-cookieä½¿ç”¨æ–¹å¼"><a href="#7-1-3-cookieä½¿ç”¨æ–¹å¼" class="headerlink" title="7.1.3 cookieä½¿ç”¨æ–¹å¼"></a>7.1.3 cookieä½¿ç”¨æ–¹å¼</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">response.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line">Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;zhongfucheng&quot;</span>);</span><br><span class="line">cookie.setMaxAge(<span class="number">1000</span>);</span><br><span class="line">response.addCookie(cookie);</span><br><span class="line">response.getWriter().write(<span class="string">&quot;æˆ‘å·²ç»å‘æµè§ˆå™¨å‘é€äº†ä¸€ä¸ªCookie&quot;</span>);</span><br></pre></td></tr></table></figure><h4 id="7-1-4-Cookieä¸å¯è·¨åŸŸåæ€§"><a href="#7-1-4-Cookieä¸å¯è·¨åŸŸåæ€§" class="headerlink" title="7.1.4 Cookieä¸å¯è·¨åŸŸåæ€§"></a>7.1.4 Cookieä¸å¯è·¨åŸŸåæ€§</h4><ul><li>å¾ˆå¤šäººåœ¨åˆå­¦çš„æ—¶å€™å¯èƒ½æœ‰ä¸€ä¸ªç–‘é—®ï¼šåœ¨è®¿é—®Servletçš„æ—¶å€™æµè§ˆå™¨<strong>æ˜¯ä¸æ˜¯æŠŠæ‰€æœ‰çš„Cookieéƒ½å¸¦è¿‡å»ç»™æœåŠ¡å™¨</strong>ï¼Œ<strong>ä¼šä¸ä¼šä¿®æ”¹äº†åˆ«çš„ç½‘ç«™çš„Cookie</strong></li><li>ç­”æ¡ˆæ˜¯å¦å®šçš„ã€‚Cookieå…·æœ‰ä¸å¯è·¨åŸŸåæ€§ã€‚æµè§ˆå™¨åˆ¤æ–­<strong>ä¸€ä¸ªç½‘ç«™æ˜¯å¦èƒ½æ“ä½œå¦ä¸€ä¸ªç½‘ç«™çš„Cookieçš„ä¾æ®æ˜¯åŸŸå</strong>ã€‚æ‰€ä»¥ä¸€èˆ¬æ¥è¯´ï¼Œ<strong>å½“æˆ‘è®¿é—®baiduçš„æ—¶å€™ï¼Œæµè§ˆå™¨åªä¼šæŠŠbaidué¢å‘çš„Cookieå¸¦è¿‡å»ï¼Œè€Œä¸ä¼šå¸¦ä¸Šgoogleçš„Cookieã€‚</strong></li></ul><h4 id="7-1-5-Cookieçš„æœ‰æ•ˆæœŸ"><a href="#7-1-5-Cookieçš„æœ‰æ•ˆæœŸ" class="headerlink" title="7.1.5 Cookieçš„æœ‰æ•ˆæœŸ"></a>7.1.5 Cookieçš„æœ‰æ•ˆæœŸ</h4><p><strong>Cookieçš„æœ‰æ•ˆæœŸæ˜¯é€šè¿‡setMaxAge()æ¥è®¾ç½®çš„</strong>ã€‚</p><ul><li>å¦‚æœMaxAgeä¸º<strong>æ­£æ•°</strong>ï¼Œ<strong>æµè§ˆå™¨ä¼šæŠŠCookieå†™åˆ°ç¡¬ç›˜ä¸­ï¼Œåªè¦è¿˜åœ¨MaxAgeç§’ä¹‹å‰ï¼Œç™»é™†ç½‘ç«™æ—¶è¯¥Cookieå°±æœ‰æ•ˆ</strong>ã€ä¸è®ºå…³é—­äº†æµè§ˆå™¨è¿˜æ˜¯ç”µè„‘ã€‘</li><li>å¦‚æœMaxAgeä¸º<strong>è´Ÿæ•°</strong>ï¼Œ<strong>Cookieæ˜¯ä¸´æ—¶æ€§çš„ï¼Œä»…åœ¨æœ¬æµè§ˆå™¨å†…æœ‰æ•ˆ</strong>ï¼Œå…³é—­æµè§ˆå™¨Cookieå°±å¤±æ•ˆäº†ï¼ŒCookieä¸ä¼šå†™åˆ°ç¡¬ç›˜ä¸­ã€‚Cookieé»˜è®¤å€¼å°±æ˜¯-1ã€‚è¿™ä¹Ÿå°±ä¸ºä»€ä¹ˆåœ¨æˆ‘ç¬¬ä¸€ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœæˆ‘æ²¡è®¾ç½®Cookieçš„æœ‰æ•ˆæœŸï¼Œåœ¨ç¡¬ç›˜ä¸­å°±æ‰¾ä¸åˆ°å¯¹åº”çš„æ–‡ä»¶ã€‚</li><li>å¦‚æœMaxAgeä¸º<strong>0</strong>ï¼Œåˆ™è¡¨ç¤º<strong>åˆ é™¤è¯¥Cookie</strong>ã€‚Cookieæœºåˆ¶æ²¡æœ‰æä¾›åˆ é™¤Cookieå¯¹åº”çš„æ–¹æ³•ï¼ŒæŠŠMaxAgeè®¾ç½®ä¸º0ç­‰åŒäºåˆ é™¤Cookie</li></ul><h4 id="7-1-6-Cookieçš„åŸŸå"><a href="#7-1-6-Cookieçš„åŸŸå" class="headerlink" title="7.1.6 Cookieçš„åŸŸå"></a>7.1.6 Cookieçš„åŸŸå</h4><p>Cookieçš„<strong>domainå±æ€§å†³å®šè¿è¡Œè®¿é—®Cookieçš„åŸŸåã€‚domainçš„å€¼è§„å®šä¸ºâ€œ.åŸŸåâ€</strong></p><p>Cookieçš„éšç§å®‰å…¨æœºåˆ¶å†³å®šCookieæ˜¯ä¸å¯è·¨åŸŸåçš„ã€‚ä¹Ÿå°±æ˜¯è¯´<a href="http://www.baidu.comå’Œwww.google.comä¹‹é—´çš„cookieæ˜¯äº’ä¸äº¤æ¥çš„.**å³ä½¿æ˜¯åŒä¸€çº§åŸŸå,ä¸åŒäºŒçº§åŸŸåä¹Ÿä¸èƒ½äº¤æ¥**./">www.baidu.comå’Œwww.google.comä¹‹é—´çš„Cookieæ˜¯äº’ä¸äº¤æ¥çš„ã€‚**å³ä½¿æ˜¯åŒä¸€çº§åŸŸåï¼Œä¸åŒäºŒçº§åŸŸåä¹Ÿä¸èƒ½äº¤æ¥**ã€‚</a></p><h3 id="7-2-ä»€ä¹ˆæ˜¯Session"><a href="#7-2-ä»€ä¹ˆæ˜¯Session" class="headerlink" title="7.2 ä»€ä¹ˆæ˜¯Session"></a>7.2 ä»€ä¹ˆæ˜¯Session</h3><p>Session æ˜¯å¦ä¸€ç§è®°å½•æµè§ˆå™¨çŠ¶æ€çš„æœºåˆ¶ã€‚ä¸åŒçš„æ˜¯Cookieä¿å­˜åœ¨æµè§ˆå™¨ä¸­ï¼ŒSessionä¿å­˜åœ¨æœåŠ¡å™¨ä¸­ã€‚ç”¨æˆ·ä½¿ç”¨æµè§ˆå™¨è®¿é—®æœåŠ¡å™¨çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨æŠŠç”¨æˆ·çš„ä¿¡æ¯ä»¥æŸç§çš„å½¢å¼è®°å½•åœ¨æœåŠ¡å™¨ï¼Œè¿™å°±æ˜¯Sessionã€‚</p><h4 id="7-2-1-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨SessionæŠ€æœ¯ï¼Ÿ"><a href="#7-2-1-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨SessionæŠ€æœ¯ï¼Ÿ" class="headerlink" title="7.2.1 ä¸ºä»€ä¹ˆè¦ä½¿ç”¨SessionæŠ€æœ¯ï¼Ÿ"></a>7.2.1 ä¸ºä»€ä¹ˆè¦ä½¿ç”¨SessionæŠ€æœ¯ï¼Ÿ</h4><p><strong>Sessionæ¯”Cookieä½¿ç”¨æ–¹ä¾¿ï¼ŒSessionå¯ä»¥è§£å†³Cookieè§£å†³ä¸äº†çš„äº‹æƒ…ã€Sessionå¯ä»¥å­˜å‚¨å¯¹è±¡ï¼ŒCookieåªèƒ½å­˜å‚¨å­—ç¬¦ä¸²ã€‚ã€‘ã€‚</strong></p><h4 id="7-2-2-Session-API"><a href="#7-2-2-Session-API" class="headerlink" title="7.2.2 Session API"></a>7.2.2 Session API</h4><ul><li>long getCreationTime();ã€è·å–Sessionè¢«åˆ›å»ºæ—¶é—´ã€‘</li><li><strong>String getId();ã€è·å–Sessionçš„idã€‘</strong></li><li>long getLastAccessedTime();ã€è¿”å›Sessionæœ€åæ´»è·ƒçš„æ—¶é—´ã€‘</li><li>ServletContext getServletContext();ã€è·å–ServletContextå¯¹è±¡ã€‘</li><li><strong>void setMaxInactiveInterval(int var1);ã€è®¾ç½®Sessionè¶…æ—¶æ—¶é—´ã€‘</strong></li><li><strong>int getMaxInactiveInterval();ã€è·å–Sessionè¶…æ—¶æ—¶é—´ã€‘</strong></li><li><strong>Object getAttribute(String var1);ã€è·å–Sessionå±æ€§</strong>ã€‘</li><li>Enumeration getAttributeNames();ã€è·å–Sessionæ‰€æœ‰çš„å±æ€§åã€‘</li><li><strong>void setAttribute(String var1, Object var2);ã€è®¾ç½®Sessionå±æ€§ã€‘</strong></li><li><strong>void removeAttribute(String var1);ã€ç§»é™¤Sessionå±æ€§ã€‘</strong></li><li><strong>void invalidate();ã€é”€æ¯è¯¥Sessionã€‘</strong></li><li>boolean isNew();ã€è¯¥Sessionæ˜¯å¦ä¸ºæ–°çš„ã€‘</li></ul><h4 id="7-2-3-sessionä½œä¸ºåŸŸå¯¹è±¡"><a href="#7-2-3-sessionä½œä¸ºåŸŸå¯¹è±¡" class="headerlink" title="7.2.3 sessionä½œä¸ºåŸŸå¯¹è±¡"></a>7.2.3 sessionä½œä¸ºåŸŸå¯¹è±¡</h4><p>Sessionæœ‰ç€requestå’ŒServletContextç±»ä¼¼çš„æ–¹æ³•ã€‚å…¶å®<strong>Sessionä¹Ÿæ˜¯ä¸€ä¸ªåŸŸå¯¹è±¡</strong>ã€‚Sessionä½œä¸ºä¸€ç§è®°å½•æµè§ˆå™¨çŠ¶æ€çš„æœºåˆ¶ï¼Œ<strong>åªè¦Sessionå¯¹è±¡æ²¡æœ‰è¢«é”€æ¯ï¼ŒServletä¹‹é—´å°±å¯ä»¥é€šè¿‡Sessionå¯¹è±¡å®ç°é€šè®¯</strong></p><p>ä¸€èˆ¬æ¥è®²ï¼Œå½“æˆ‘ä»¬è¦å­˜è¿›çš„æ˜¯<strong>ç”¨æˆ·çº§åˆ«çš„æ•°æ®å°±ç”¨Session</strong>ï¼Œé‚£ä»€ä¹ˆæ˜¯ç”¨æˆ·çº§åˆ«å‘¢ï¼Ÿ<strong>åªè¦æµè§ˆå™¨ä¸å…³é—­ï¼Œå¸Œæœ›æ•°æ®è¿˜åœ¨ï¼Œå°±ä½¿ç”¨Sessionæ¥ä¿å­˜</strong>ã€‚</p><h4 id="7-2-4-sessionç”Ÿå‘½å‘¨æœŸ"><a href="#7-2-4-sessionç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="7.2.4 sessionç”Ÿå‘½å‘¨æœŸ"></a>7.2.4 sessionç”Ÿå‘½å‘¨æœŸ</h4><p><strong>Sessionçš„ç”Ÿå‘½å‘¨æœŸå’Œæœ‰æ•ˆæœŸ</strong></p><ul><li><p>Sessionåœ¨ç”¨æˆ·<strong>ç¬¬ä¸€æ¬¡è®¿é—®æœåŠ¡å™¨Servletï¼Œjspç­‰åŠ¨æ€èµ„æºå°±ä¼šè¢«è‡ªåŠ¨åˆ›å»ºï¼ŒSessionå¯¹è±¡ä¿å­˜åœ¨å†…å­˜é‡Œ</strong>ï¼Œè¿™ä¹Ÿå°±ä¸ºä»€ä¹ˆä¸Šé¢çš„ä¾‹å­å¯ä»¥<strong>ç›´æ¥ä½¿ç”¨requestå¯¹è±¡è·å–å¾—åˆ°Sessionå¯¹è±¡</strong>ã€‚</p></li><li><p>å¦‚æœè®¿é—®HTML,IMAGEç­‰é™æ€èµ„æºSessionä¸ä¼šè¢«åˆ›å»ºã€‚</p></li><li><p>Sessionç”Ÿæˆåï¼Œåªè¦ç”¨æˆ·ç»§ç»­è®¿é—®ï¼ŒæœåŠ¡å™¨å°±ä¼šæ›´æ–°Sessionçš„æœ€åè®¿é—®æ—¶é—´ï¼Œæ— è®º<strong>æ˜¯å¦å¯¹Sessionè¿›è¡Œè¯»å†™ï¼ŒæœåŠ¡å™¨éƒ½ä¼šè®¤ä¸ºSessionæ´»è·ƒäº†ä¸€æ¬¡</strong>ã€‚</p></li><li><p>ç”±äºä¼šæœ‰è¶Šæ¥è¶Šå¤šçš„ç”¨æˆ·è®¿é—®æœåŠ¡å™¨ï¼Œå› æ­¤Sessionä¹Ÿä¼šè¶Šæ¥è¶Šå¤šã€‚<strong>ä¸ºäº†é˜²æ­¢å†…å­˜æº¢å‡ºï¼ŒæœåŠ¡å™¨ä¼šæŠŠé•¿æ—¶é—´æ²¡æœ‰æ´»è·ƒçš„Sessionä»å†…å­˜ä¸­åˆ é™¤ï¼Œè¿™ä¸ªæ—¶é—´ä¹Ÿå°±æ˜¯Sessionçš„è¶…æ—¶æ—¶é—´</strong>ã€‚</p></li><li><p>Sessionçš„è¶…æ—¶æ—¶é—´é»˜è®¤æ˜¯30åˆ†é’Ÿï¼Œæœ‰ä¸‰ç§æ–¹å¼å¯ä»¥å¯¹Sessionçš„è¶…æ—¶æ—¶é—´è¿›è¡Œä¿®æ”¹</p><p>1ã€ä¿®æ”¹tomcatçš„web.xml</p><p>2ã€ä¿®æ”¹é¡¹ç›®çš„web.xml</p><p>3ã€<code>httpSession.setMaxInactiveInterval(60);</code></p></li></ul><h3 id="7-3-Sessionå’ŒCookieçš„åŒºåˆ«"><a href="#7-3-Sessionå’ŒCookieçš„åŒºåˆ«" class="headerlink" title="7.3 Sessionå’ŒCookieçš„åŒºåˆ«"></a>7.3 Sessionå’ŒCookieçš„åŒºåˆ«</h3><ul><li><p><strong>ä»å­˜å‚¨æ–¹å¼ä¸Šæ¯”è¾ƒ</strong></p></li><li><ul><li>Cookieåªèƒ½å­˜å‚¨å­—ç¬¦ä¸²ï¼Œå¦‚æœè¦å­˜å‚¨éASCIIå­—ç¬¦ä¸²è¿˜è¦å¯¹å…¶ç¼–ç ã€‚</li><li>Sessionå¯ä»¥å­˜å‚¨ä»»ä½•ç±»å‹çš„æ•°æ®ï¼Œå¯ä»¥æŠŠSessionçœ‹æˆæ˜¯ä¸€ä¸ªå®¹å™¨</li></ul></li><li><p><strong>ä»éšç§å®‰å…¨ä¸Šæ¯”è¾ƒ</strong></p></li><li><ul><li><strong>Cookieå­˜å‚¨åœ¨æµè§ˆå™¨ä¸­ï¼Œå¯¹å®¢æˆ·ç«¯æ˜¯å¯è§çš„</strong>ã€‚ä¿¡æ¯å®¹æ˜“æ³„éœ²å‡ºå»ã€‚å¦‚æœä½¿ç”¨Cookieï¼Œæœ€å¥½å°†CookieåŠ å¯†</li><li><strong>Sessionå­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šï¼Œå¯¹å®¢æˆ·ç«¯æ˜¯é€æ˜çš„</strong>ã€‚ä¸å­˜åœ¨æ•æ„Ÿä¿¡æ¯æ³„éœ²é—®é¢˜ã€‚</li></ul></li><li><p><strong>ä»æœ‰æ•ˆæœŸä¸Šæ¯”è¾ƒ</strong></p></li><li><ul><li>Cookieä¿å­˜åœ¨ç¡¬ç›˜ä¸­ï¼Œåªéœ€è¦è®¾ç½®maxAgeå±æ€§ä¸ºæ¯”è¾ƒå¤§çš„æ­£æ•´æ•°ï¼Œå³ä½¿å…³é—­æµè§ˆå™¨ï¼ŒCookieè¿˜æ˜¯å­˜åœ¨çš„</li><li><strong>Sessionçš„ä¿å­˜åœ¨æœåŠ¡å™¨ä¸­ï¼Œè®¾ç½®maxInactiveIntervalå±æ€§å€¼æ¥ç¡®å®šSessionçš„æœ‰æ•ˆæœŸã€‚å¹¶ä¸”Sessionä¾èµ–äºåä¸ºJSESSIONIDçš„Cookieï¼Œè¯¥Cookieé»˜è®¤çš„maxAgeå±æ€§ä¸º-1ã€‚å¦‚æœå…³é—­äº†æµè§ˆå™¨ï¼Œè¯¥Sessionè™½ç„¶æ²¡æœ‰ä»æœåŠ¡å™¨ä¸­æ¶ˆäº¡ï¼Œä½†ä¹Ÿå°±å¤±æ•ˆäº†ã€‚</strong></li></ul></li><li><p><strong>ä»å¯¹æœåŠ¡å™¨çš„è´Ÿæ‹…æ¯”è¾ƒ</strong></p></li><li><ul><li>Sessionæ˜¯ä¿å­˜åœ¨æœåŠ¡å™¨çš„ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªSessionï¼Œå¦‚æœæ˜¯å¹¶å‘è®¿é—®çš„ç”¨æˆ·éå¸¸å¤šï¼Œæ˜¯ä¸èƒ½ä½¿ç”¨Sessionçš„ï¼ŒSessionä¼šæ¶ˆè€—å¤§é‡çš„å†…å­˜ã€‚</li><li>Cookieæ˜¯ä¿å­˜åœ¨å®¢æˆ·ç«¯çš„ã€‚ä¸å ç”¨æœåŠ¡å™¨çš„èµ„æºã€‚åƒbaiduã€Sinaè¿™æ ·çš„å¤§å‹ç½‘ç«™ï¼Œä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨Cookieæ¥è¿›è¡Œä¼šè¯è·Ÿè¸ªã€‚</li></ul></li><li><p><strong>ä»æµè§ˆå™¨çš„æ”¯æŒä¸Šæ¯”è¾ƒ</strong></p></li><li><ul><li>å¦‚æœæµè§ˆå™¨ç¦ç”¨äº†Cookieï¼Œé‚£ä¹ˆCookieæ˜¯æ— ç”¨çš„äº†ï¼</li><li>å¦‚æœæµè§ˆå™¨ç¦ç”¨äº†Cookieï¼ŒSessionå¯ä»¥é€šè¿‡URLåœ°å€é‡å†™æ¥è¿›è¡Œä¼šè¯è·Ÿè¸ªã€‚</li></ul></li><li><p><strong>ä»è·¨åŸŸåä¸Šæ¯”è¾ƒ</strong></p></li><li><ul><li>Cookieå¯ä»¥è®¾ç½®domainå±æ€§æ¥å®ç°è·¨åŸŸå</li><li>Sessionåªåœ¨å½“å‰çš„åŸŸåå†…æœ‰æ•ˆï¼Œä¸å¯è·¨åŸŸå</li></ul></li></ul><h2 id="8ã€forwardå’Œredirectçš„åŒºåˆ«"><a href="#8ã€forwardå’Œredirectçš„åŒºåˆ«" class="headerlink" title="8ã€forwardå’Œredirectçš„åŒºåˆ«"></a>8ã€forwardå’Œredirectçš„åŒºåˆ«</h2><h3 id="8-1-å®é™…å‘ç”Ÿä½ç½®ä¸åŒï¼Œåœ°å€æ ä¸åŒ"><a href="#8-1-å®é™…å‘ç”Ÿä½ç½®ä¸åŒï¼Œåœ°å€æ ä¸åŒ" class="headerlink" title="8.1 å®é™…å‘ç”Ÿä½ç½®ä¸åŒï¼Œåœ°å€æ ä¸åŒ"></a>8.1 <strong>å®é™…å‘ç”Ÿä½ç½®ä¸åŒï¼Œåœ°å€æ ä¸åŒ</strong></h3><p>1ã€è½¬å‘æ˜¯å‘ç”Ÿåœ¨æœåŠ¡å™¨çš„<br>2ã€è½¬å‘æ˜¯ç”±æœåŠ¡å™¨è¿›è¡Œè·³è½¬çš„ï¼Œç»†å¿ƒçš„æœ‹å‹ä¼šå‘ç°ï¼Œåœ¨è½¬å‘çš„æ—¶å€™ï¼Œæµè§ˆå™¨çš„åœ°å€æ æ˜¯æ²¡æœ‰å‘ç”Ÿå˜åŒ–çš„ï¼Œåœ¨æˆ‘è®¿é—®Servlet111çš„æ—¶å€™ï¼Œå³ä½¿è·³è½¬åˆ°äº†Servlet222çš„é¡µé¢ï¼Œæµè§ˆå™¨çš„åœ°å€è¿˜æ˜¯Servlet111çš„ã€‚ä¹Ÿå°±æ˜¯è¯´æµè§ˆå™¨æ˜¯ä¸çŸ¥é“è¯¥è·³è½¬çš„åŠ¨ä½œï¼Œè½¬å‘æ˜¯å¯¹æµè§ˆå™¨é€æ˜çš„ã€‚é€šè¿‡ä¸Šé¢çš„è½¬å‘æ—¶åºå›¾æˆ‘ä»¬ä¹Ÿå¯ä»¥å‘ç°ï¼Œå®ç°è½¬å‘åªæ˜¯ä¸€æ¬¡çš„httpè¯·æ±‚ï¼Œä¸€æ¬¡è½¬å‘ä¸­requestå’Œresponseå¯¹è±¡éƒ½æ˜¯åŒä¸€ä¸ªã€‚è¿™ä¹Ÿè§£é‡Šäº†ï¼Œä¸ºä»€ä¹ˆå¯ä»¥ä½¿ç”¨requestä½œä¸ºåŸŸå¯¹è±¡è¿›è¡ŒServletä¹‹é—´çš„é€šè®¯ã€‚<br>3ã€é‡å®šå‘æ˜¯å‘ç”Ÿåœ¨æµè§ˆå™¨çš„ - é‡å®šå‘æ˜¯ç”±æµè§ˆå™¨è¿›è¡Œè·³è½¬çš„ï¼Œè¿›è¡Œé‡å®šå‘è·³è½¬çš„æ—¶å€™ï¼Œæµè§ˆå™¨çš„åœ°å€ä¼šå‘ç”Ÿå˜åŒ–çš„ã€‚æ›¾ç»ä»‹ç»è¿‡ï¼šå®ç°é‡å®šå‘çš„åŸç†æ˜¯ç”±responseçš„çŠ¶æ€ç å’ŒLocationå¤´ç»„åˆè€Œå®ç°çš„ã€‚è¿™æ˜¯ç”±æµè§ˆå™¨è¿›è¡Œçš„é¡µé¢è·³è½¬å®ç°é‡å®šå‘ä¼šå‘å‡ºä¸¤ä¸ªhttpè¯·æ±‚ï¼ŒrequeståŸŸå¯¹è±¡æ˜¯æ— æ•ˆçš„ï¼Œå› ä¸ºå®ƒä¸æ˜¯åŒä¸€ä¸ªrequestå¯¹è±¡</p><h3 id="8-2-ç”¨æ³•ä¸åŒ"><a href="#8-2-ç”¨æ³•ä¸åŒ" class="headerlink" title="8.2 ç”¨æ³•ä¸åŒ"></a>8.2 ç”¨æ³•ä¸åŒ</h3><p>å¾ˆå¤šäººéƒ½æä¸æ¸…æ¥šè½¬å‘å’Œé‡å®šå‘çš„æ—¶å€™ï¼Œèµ„æºåœ°å€ç©¶ç«Ÿæ€ä¹ˆå†™ã€‚æœ‰çš„æ—¶å€™è¦æŠŠåº”ç”¨åå†™ä¸Šï¼Œæœ‰çš„æ—¶å€™ä¸ç”¨æŠŠåº”ç”¨åå†™ä¸Šã€‚å¾ˆå®¹æ˜“æŠŠäººææ™•ã€‚è®°ä½ä¸€ä¸ªåŸåˆ™ï¼š <strong>ç»™æœåŠ¡å™¨ç”¨çš„ç›´æ¥ä»èµ„æºåå¼€å§‹å†™ï¼Œç»™æµè§ˆå™¨ç”¨çš„è¦æŠŠåº”ç”¨åå†™ä¸Š</strong></p><p><code>request.getRequestDispatcher(&quot;/èµ„æºå URI&quot;).forward(request,response)</code><br>è½¬å‘æ—¶â€/â€œä»£è¡¨çš„æ˜¯æœ¬åº”ç”¨ç¨‹åºçš„æ ¹ç›®å½•ã€zhongfuchengã€‘<br><code>response.send(&quot;/webåº”ç”¨/èµ„æºå URI&quot;); </code><br>é‡å®šå‘æ—¶â€/â€œä»£è¡¨çš„æ˜¯webappsç›®å½•  </p><h3 id="8-3-èƒ½å¤Ÿå»å¾€çš„URLçš„èŒƒå›´ä¸ä¸€æ ·"><a href="#8-3-èƒ½å¤Ÿå»å¾€çš„URLçš„èŒƒå›´ä¸ä¸€æ ·" class="headerlink" title="8.3 èƒ½å¤Ÿå»å¾€çš„URLçš„èŒƒå›´ä¸ä¸€æ ·"></a>8.3 èƒ½å¤Ÿå»å¾€çš„URLçš„èŒƒå›´ä¸ä¸€æ ·</h3><p>è½¬å‘æ˜¯æœåŠ¡å™¨è·³è½¬åªèƒ½å»å¾€å½“å‰webåº”ç”¨çš„èµ„æº<br>é‡å®šå‘æ˜¯æœåŠ¡å™¨è·³è½¬ï¼Œå¯ä»¥å»å¾€ä»»ä½•çš„èµ„æº</p><h3 id="8-4-ä¼ é€’æ•°æ®çš„ç±»å‹ä¸åŒ"><a href="#8-4-ä¼ é€’æ•°æ®çš„ç±»å‹ä¸åŒ" class="headerlink" title="8.4 ä¼ é€’æ•°æ®çš„ç±»å‹ä¸åŒ"></a>8.4 ä¼ é€’æ•°æ®çš„ç±»å‹ä¸åŒ</h3><p>è½¬å‘çš„requestå¯¹è±¡å¯ä»¥ä¼ é€’å„ç§ç±»å‹çš„æ•°æ®ï¼ŒåŒ…æ‹¬å¯¹è±¡<br>é‡å®šå‘åªèƒ½ä¼ é€’å­—ç¬¦ä¸²</p><h3 id="8-5-è·³è½¬çš„æ—¶é—´ä¸åŒ"><a href="#8-5-è·³è½¬çš„æ—¶é—´ä¸åŒ" class="headerlink" title="8.5 è·³è½¬çš„æ—¶é—´ä¸åŒ"></a>8.5 è·³è½¬çš„æ—¶é—´ä¸åŒ</h3><p>è½¬å‘æ—¶ï¼šæ‰§è¡Œåˆ°è·³è½¬è¯­å¥æ—¶å°±ä¼šç«‹åˆ»è·³è½¬<br>é‡å®šå‘ï¼šæ•´ä¸ªé¡µé¢æ‰§è¡Œå®Œä¹‹åæ‰æ‰§è¡Œè·³è½¬</p><p><strong>é‚£ä¹ˆè½¬å‘(forward)å’Œé‡å®šå‘(redirect)ä½¿ç”¨å“ªä¸€ä¸ªï¼Ÿ</strong></p><p>æ ¹æ®ä¸Šé¢è¯´æ˜äº†è½¬å‘å’Œé‡å®šå‘çš„åŒºåˆ«ä¹Ÿå¯ä»¥å¾ˆå®¹æ˜“æ¦‚æ‹¬å‡ºæ¥<strong>ã€‚è½¬å‘æ˜¯å¸¦ç€è½¬å‘å‰çš„è¯·æ±‚çš„å‚æ•°çš„ã€‚é‡å®šå‘æ˜¯æ–°çš„è¯·æ±‚</strong>ã€‚</p><h3 id="8-6-å…¸å‹çš„åº”ç”¨åœºæ™¯ï¼š"><a href="#8-6-å…¸å‹çš„åº”ç”¨åœºæ™¯ï¼š" class="headerlink" title="8.6 å…¸å‹çš„åº”ç”¨åœºæ™¯ï¼š"></a>8.6 å…¸å‹çš„åº”ç”¨åœºæ™¯ï¼š</h3><ol><li>è½¬å‘: è®¿é—® Servlet å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œç„¶å forward åˆ° jsp æ˜¾ç¤ºå¤„ç†ç»“æœï¼Œæµè§ˆå™¨é‡Œ URL ä¸å˜</li><li>é‡å®šå‘: æäº¤è¡¨å•ï¼Œå¤„ç†æˆåŠŸå redirect åˆ°å¦ä¸€ä¸ª jspï¼Œé˜²æ­¢è¡¨å•é‡å¤æäº¤ï¼Œæµè§ˆå™¨é‡Œ URL å˜äº†</li></ol><p><a href="https://mp.weixin.qq.com/s?__biz=MzI4Njg5MDA5NA==&mid=2247484755&idx=7&sn=fb35232f3c15e2b4336498ac9f8804f1&chksm=ebd74452dca0cd44942721a159088a2f286d4e5c5f2bcdc7e264f0dccc8f9928d66858e475d4###rd">Servletç¬¬å…­ç¯‡ã€Sessionä»‹ç»ã€APIã€ç”Ÿå‘½å‘¨æœŸã€åº”ç”¨ã€ä¸CookieåŒºåˆ«ã€‘(ä¿®è®¢ç‰ˆ)</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1ã€ä»€ä¹ˆæ˜¯servlet&quot;&gt;&lt;a href=&quot;#1ã€ä»€ä¹ˆæ˜¯servlet&quot; class=&quot;headerlink&quot; title=&quot;1ã€ä»€ä¹ˆæ˜¯servlet&quot;&gt;&lt;/a&gt;1ã€ä»€ä¹ˆæ˜¯servlet&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;ä»€ä¹ˆæ˜¯Serlvetï¼Ÿ&lt;/strong&gt;&lt;/</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>æœåŠ¡å‘ç°çš„åŸºæœ¬åŸç†</title>
    <link href="http://example.com/wiki/%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/"/>
    <id>http://example.com/wiki/%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/</id>
    <published>2021-08-24T06:30:25.000Z</published>
    <updated>2021-08-24T06:33:06.315Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://juejin.cn/post/6844903580999090183">https://juejin.cn/post/6844903580999090183</a></p><p><a href="https://blog.didispace.com/consul-service-discovery-exp/">ä½¿ç”¨ConsulåšæœåŠ¡å‘ç°çš„è‹¥å¹²å§¿åŠ¿</a></p><p><a href="https://laravelacademy.org/post/21214">æ³¨å†Œä¸­å¿ƒç¯‡ï¼ˆä¸‰ï¼‰ï¼šConsul æœåŠ¡å‘ç°çš„åº•å±‚å®ç°</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‚è€ƒèµ„æ–™&quot;&gt;&lt;a href=&quot;#å‚è€ƒèµ„æ–™&quot; class=&quot;headerlink&quot; title=&quot;å‚è€ƒèµ„æ–™&quot;&gt;&lt;/a&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://juejin.cn/post/6844903580999090183&quot;&gt;https://j</summary>
      
    
    
    
    
    <category term="æœåŠ¡å‘ç°" scheme="http://example.com/tags/%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/"/>
    
  </entry>
  
  <entry>
    <title>JVM-æ€§èƒ½è°ƒä¼˜</title>
    <link href="http://example.com/wiki/JVM-%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/"/>
    <id>http://example.com/wiki/JVM-%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/</id>
    <published>2021-08-23T02:13:43.000Z</published>
    <updated>2021-08-23T02:16:21.575Z</updated>
    
    <content type="html"><![CDATA[<p>1ã€</p><p><a href="https://mikechen.cc/3321.html">JVMæ€§èƒ½è°ƒä¼˜çš„6å¤§æ­¥éª¤ï¼ŒåŠå…³é”®è°ƒä¼˜å‚æ•°è¯¦è§£</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;1ã€&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://mikechen.cc/3321.html&quot;&gt;JVMæ€§èƒ½è°ƒä¼˜çš„6å¤§æ­¥éª¤ï¼ŒåŠå…³é”®è°ƒä¼˜å‚æ•°è¯¦è§£&lt;/a&gt;&lt;/p&gt;
</summary>
      
    
    
    
    
    <category term="JVM" scheme="http://example.com/tags/JVM/"/>
    
  </entry>
  
  <entry>
    <title>Arthas-Javaè¯Šæ–­ç¥å™¨</title>
    <link href="http://example.com/wiki/Arthas-Java%E8%AF%8A%E6%96%AD%E7%A5%9E%E5%99%A8/"/>
    <id>http://example.com/wiki/Arthas-Java%E8%AF%8A%E6%96%AD%E7%A5%9E%E5%99%A8/</id>
    <published>2021-08-20T08:28:32.000Z</published>
    <updated>2021-08-20T10:02:17.096Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Arthas-Javaè¯Šæ–­ç¥å™¨"><a href="#Arthas-Javaè¯Šæ–­ç¥å™¨" class="headerlink" title="Arthas-Javaè¯Šæ–­ç¥å™¨"></a>Arthas-Javaè¯Šæ–­ç¥å™¨</h2><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210820172620815.png" alt="image-20210820172620815" style="zoom:50%;"/><p>å®˜æ–¹æ–‡æ¡£åœ°å€ ğŸ‘‰    <a href="https://arthas.aliyun.com/doc/index.html#">https://arthas.aliyun.com/doc/index.html#</a></p><h3 id="1-å®‰è£…arthas"><a href="#1-å®‰è£…arthas" class="headerlink" title="1. å®‰è£…arthas"></a>1. å®‰è£…arthas</h3><p><code>wget https://arthas.aliyun.com/arthas-boot.jar </code></p><p><code>java -jar arthas-boot.jar --target-ip 0.0.0.0</code></p><p>å¦‚æœä½ çš„æœºå™¨æ²¡æœ‰ä»»ä½•javaè¿›ç¨‹åœ¨è¿è¡Œï¼Œä¼šæç¤ºå¦‚ä¸‹é”™è¯¯ ğŸ‘‡</p><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210820165717792.png" alt="image-20210820165717792"></p><p><strong>æ­£å¸¸å¯åŠ¨å¦‚ä¸‹ï¼š</strong></p><p>âš ï¸ ç”±äºæˆ‘ä»¬ä»…ä»…å¯åŠ¨äº†ä¸€ä¸ªjavaè¿›ç¨‹ï¼Œæ‰€æœ‰è¿™é‡Œå°±åªæœ‰ä¸€ä¸ªã€‚è¾“å…¥1å›è½¦å³å¯ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210820165953801.png" alt="image-20210820165953801"></p><p><strong>42423å°±æ˜¯æˆ‘ä»¬çš„javaè¿›ç¨‹å·</strong></p><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210820170112574.png" alt="image-20210820170112574"></p><h3 id="2-æŸ¥çœ‹JVMä¿¡æ¯"><a href="#2-æŸ¥çœ‹JVMä¿¡æ¯" class="headerlink" title="2. æŸ¥çœ‹JVMä¿¡æ¯"></a>2. æŸ¥çœ‹JVMä¿¡æ¯</h3><h4 id="2-1-sysprop"><a href="#2-1-sysprop" class="headerlink" title="2.1 sysprop"></a>2.1 sysprop</h4><p><code>sysprop</code> å¯ä»¥æ‰“å°æ‰€æœ‰çš„System Propertiesä¿¡æ¯ã€‚</p><p>ä¹Ÿå¯ä»¥æŒ‡å®šå•ä¸ªkeyï¼š <code>sysprop java.version</code></p><p>ä¹Ÿå¯ä»¥é€šè¿‡<code>grep</code>æ¥è¿‡æ»¤ï¼š <code>sysprop | grep user</code></p><p>å¯ä»¥è®¾ç½®æ–°çš„valueï¼š <code>sysprop testKey testValue</code></p><h4 id="2-2-sysenv"><a href="#2-2-sysenv" class="headerlink" title="2.2 sysenv"></a>2.2 sysenv</h4><p><code>sysenv</code> å‘½ä»¤å¯ä»¥è·å–åˆ°ç¯å¢ƒå˜é‡ã€‚å’Œ<code>sysprop</code>å‘½ä»¤ç±»ä¼¼ã€‚</p><h4 id="2-3-jvm"><a href="#2-3-jvm" class="headerlink" title="2.3 jvm"></a>2.3 jvm</h4><p><code>jvm</code> å‘½ä»¤ä¼šæ‰“å°å‡º<code>JVM</code>çš„å„ç§è¯¦ç»†ä¿¡æ¯ã€‚</p><h4 id="2-4-dashboard"><a href="#2-4-dashboard" class="headerlink" title="2.4 dashboard"></a>2.4 dashboard</h4><p><code>dashboard</code> å‘½ä»¤å¯ä»¥æŸ¥çœ‹å½“å‰ç³»ç»Ÿçš„å®æ—¶æ•°æ®é¢æ¿ã€‚</p><p>è¾“å…¥ <code>Q</code> æˆ–è€… <code>Ctrl+C</code> å¯ä»¥é€€å‡ºdashboardå‘½ä»¤ã€‚</p><h3 id="3-æŸ¥çœ‹çº¿ç¨‹ç›¸å…³"><a href="#3-æŸ¥çœ‹çº¿ç¨‹ç›¸å…³" class="headerlink" title="3. æŸ¥çœ‹çº¿ç¨‹ç›¸å…³"></a>3. æŸ¥çœ‹çº¿ç¨‹ç›¸å…³</h3><h4 id="3-1-æŸ¥çœ‹çº¿ç¨‹åˆ—è¡¨"><a href="#3-1-æŸ¥çœ‹çº¿ç¨‹åˆ—è¡¨" class="headerlink" title="3.1 æŸ¥çœ‹çº¿ç¨‹åˆ—è¡¨"></a>3.1 æŸ¥çœ‹çº¿ç¨‹åˆ—è¡¨</h4><p><code>thread</code> </p><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210820163125277.png" alt="image-20210820163125277"></p><h4 id="3-2-æŸ¥çœ‹çº¿ç¨‹æ ˆä¿¡æ¯"><a href="#3-2-æŸ¥çœ‹çº¿ç¨‹æ ˆä¿¡æ¯" class="headerlink" title="3.2 æŸ¥çœ‹çº¿ç¨‹æ ˆä¿¡æ¯"></a>3.2 <strong>æŸ¥çœ‹çº¿ç¨‹æ ˆä¿¡æ¯</strong></h4><p><code>thread 18</code> </p><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210820163518891.png" alt="image-20210820163518891"></p><h4 id="3-3-æŸ¥çœ‹5ç§’å†…çš„CPUä½¿ç”¨ç‡top-nçº¿ç¨‹æ ˆ"><a href="#3-3-æŸ¥çœ‹5ç§’å†…çš„CPUä½¿ç”¨ç‡top-nçº¿ç¨‹æ ˆ" class="headerlink" title="3.3 æŸ¥çœ‹5ç§’å†…çš„CPUä½¿ç”¨ç‡top nçº¿ç¨‹æ ˆ"></a>3.3 æŸ¥çœ‹5ç§’å†…çš„CPUä½¿ç”¨ç‡top nçº¿ç¨‹æ ˆ</h4><p><code>thread -n 3 -i 5000 </code></p><h4 id="3-4-æŸ¥æ‰¾çº¿ç¨‹æ˜¯å¦æœ‰é˜»å¡"><a href="#3-4-æŸ¥æ‰¾çº¿ç¨‹æ˜¯å¦æœ‰é˜»å¡" class="headerlink" title="3.4 æŸ¥æ‰¾çº¿ç¨‹æ˜¯å¦æœ‰é˜»å¡"></a>3.4 æŸ¥æ‰¾çº¿ç¨‹æ˜¯å¦æœ‰é˜»å¡</h4><p><code>thread -b</code></p><h3 id="4-sc-sm-æŸ¥çœ‹å·²åŠ è½½çš„ç±»"><a href="#4-sc-sm-æŸ¥çœ‹å·²åŠ è½½çš„ç±»" class="headerlink" title="4. sc/sm æŸ¥çœ‹å·²åŠ è½½çš„ç±»"></a>4. sc/sm æŸ¥çœ‹å·²åŠ è½½çš„ç±»</h3><p>ä¸‹é¢ä»‹ç»Arthasé‡ŒæŸ¥æ‰¾å·²åŠ è½½ç±»çš„å‘½ä»¤ã€‚</p><h3 id="4-1-sc-æŸ¥æ‰¾åˆ°æ‰€æœ‰JVMå·²ç»åŠ è½½åˆ°çš„ç±»"><a href="#4-1-sc-æŸ¥æ‰¾åˆ°æ‰€æœ‰JVMå·²ç»åŠ è½½åˆ°çš„ç±»" class="headerlink" title="4.1 sc æŸ¥æ‰¾åˆ°æ‰€æœ‰JVMå·²ç»åŠ è½½åˆ°çš„ç±»"></a>4.1 sc æŸ¥æ‰¾åˆ°<strong>æ‰€æœ‰JVMå·²ç»åŠ è½½åˆ°çš„ç±»</strong></h3><p>å¦‚æœæœç´¢çš„æ˜¯æ¥å£ï¼Œè¿˜ä¼šæœç´¢æ‰€æœ‰çš„å®ç°ç±»ã€‚æ¯”å¦‚æŸ¥çœ‹æ‰€æœ‰çš„<code>Filter</code>å®ç°ç±»ï¼š</p><p><code>sc javax.servlet.Filter</code></p><p>é€šè¿‡<code>-d</code>å‚æ•°ï¼Œå¯ä»¥æ‰“å°å‡ºç±»åŠ è½½çš„å…·ä½“ä¿¡æ¯ï¼Œå¾ˆæ–¹ä¾¿æŸ¥æ‰¾ç±»åŠ è½½é—®é¢˜ã€‚</p><p><code>sc -d javax.servlet.Filter</code></p><p><code>sc</code>æ”¯æŒé€šé…ï¼Œæ¯”å¦‚æœç´¢æ‰€æœ‰çš„<code>StringUtils</code>ï¼š</p><p><code>sc *StringUtils</code></p><h3 id="4-2-sm-æŸ¥æ‰¾ç±»çš„å…·ä½“å‡½æ•°"><a href="#4-2-sm-æŸ¥æ‰¾ç±»çš„å…·ä½“å‡½æ•°" class="headerlink" title="4.2 sm æŸ¥æ‰¾ç±»çš„å…·ä½“å‡½æ•°"></a>4.2 sm æŸ¥æ‰¾ç±»çš„<strong>å…·ä½“å‡½æ•°</strong></h3><p><code>sm java.math.RoundingMode</code></p><p>é€šè¿‡<code>-d</code>å‚æ•°å¯ä»¥æ‰“å°å‡½æ•°çš„å…·ä½“å±æ€§ï¼š</p><p><code>sm -d java.math.RoundingMode</code></p><p>ä¹Ÿå¯ä»¥æŸ¥æ‰¾ç‰¹å®šçš„å‡½æ•°ï¼Œæ¯”å¦‚æŸ¥æ‰¾æ„é€ å‡½æ•°ï¼š</p><p><code>sm java.math.RoundingMode &lt;init&gt;</code></p><h3 id="5-Jadåç¼–è¯‘"><a href="#5-Jadåç¼–è¯‘" class="headerlink" title="5. Jadåç¼–è¯‘"></a>5. Jadåç¼–è¯‘</h3><p>å¯ä»¥é€šè¿‡ <code>jad</code> å‘½ä»¤æ¥åç¼–è¯‘ä»£ç ï¼š</p><p><code>jad com.example.demo.arthas.user.UserController</code></p><p>é€šè¿‡<code>--source-only</code>å‚æ•°å¯ä»¥åªæ‰“å°å‡ºåœ¨åç¼–è¯‘çš„æºä»£ç ï¼š</p><p><code>jad --source-only com.example.demo.arthas.user.UserController</code></p><h3 id="6-OgnlåŠ¨æ€ä»£ç "><a href="#6-OgnlåŠ¨æ€ä»£ç " class="headerlink" title="6. OgnlåŠ¨æ€ä»£ç "></a>6. OgnlåŠ¨æ€ä»£ç </h3><p>åœ¨Arthasé‡Œï¼Œæœ‰ä¸€ä¸ªå•ç‹¬çš„<code>ognl</code>å‘½ä»¤ï¼Œå¯ä»¥åŠ¨æ€æ‰§è¡Œä»£ç ã€‚</p><h4 id="6-1-è°ƒç”¨staticå‡½æ•°"><a href="#6-1-è°ƒç”¨staticå‡½æ•°" class="headerlink" title="6.1 è°ƒç”¨staticå‡½æ•°"></a>6.1 è°ƒç”¨staticå‡½æ•°</h4><p><code>ognl &#39;@java.lang.System@out.println(&quot;hello ognl&quot;)&#39;</code></p><p>å¯ä»¥æ£€æŸ¥<code>Terminal</code>é‡Œçš„è¿›ç¨‹è¾“å‡ºï¼Œå¯ä»¥å‘ç°æ‰“å°å‡ºäº†<code>hello ognl</code>ã€‚</p><h4 id="6-2-æŸ¥æ‰¾UserControllerçš„ClassLoader"><a href="#6-2-æŸ¥æ‰¾UserControllerçš„ClassLoader" class="headerlink" title="6.2 æŸ¥æ‰¾UserControllerçš„ClassLoader"></a>6.2 æŸ¥æ‰¾UserControllerçš„ClassLoader</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sc -d com.example.demo.arthas.user.UserController | grep classLoaderHash</span><br><span class="line"><span class="meta">$</span><span class="bash"> sc -d com.example.demo.arthas.user.UserController | grep classLoaderHash</span></span><br><span class="line"> classLoaderHash   1be6f5c3</span><br></pre></td></tr></table></figure><p>æ³¨æ„hashcodeæ˜¯å˜åŒ–çš„ï¼Œéœ€è¦å…ˆæŸ¥çœ‹å½“å‰çš„ClassLoaderä¿¡æ¯ï¼Œæå–å¯¹åº”ClassLoaderçš„hashcodeã€‚</p><p>å¦‚æœä½ ä½¿ç”¨<code>-c</code>ï¼Œä½ éœ€è¦æ‰‹åŠ¨è¾“å…¥hashcodeï¼š<code>-c &lt;hashcode&gt;</code></p><p><code>$ ognl -c 1be6f5c3 @com.example.demo.arthas.user.UserController@logger</code></p><p>å¯¹äºåªæœ‰å”¯ä¸€å®ä¾‹çš„ClassLoaderå¯ä»¥é€šè¿‡<code>--classLoaderClass</code>æŒ‡å®šclass nameï¼Œä½¿ç”¨èµ·æ¥æ›´åŠ æ–¹ä¾¿ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ ognl --classLoaderClass org.springframework.boot.loader.LaunchedURLClassLoader  @org.springframework.boot.SpringApplication@logger</span><br><span class="line">@Slf4jLocationAwareLog[</span><br><span class="line">    FQCN=@String[org.apache.commons.logging.LogAdapter<span class="variable">$Slf4jLocationAwareLog</span>],</span><br><span class="line">    name=@String[org.springframework.boot.SpringApplication],</span><br><span class="line">    logger=@Logger[Logger[org.springframework.boot.SpringApplication]],</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p><code>--classLoaderClass</code> çš„å€¼æ˜¯ClassLoaderçš„ç±»åï¼Œåªæœ‰åŒ¹é…åˆ°å”¯ä¸€çš„ClassLoaderå®ä¾‹æ—¶æ‰èƒ½å·¥ä½œï¼Œç›®çš„æ˜¯æ–¹ä¾¿è¾“å…¥é€šç”¨å‘½ä»¤ï¼Œè€Œ<code>-c &lt;hashcode&gt;</code>æ˜¯åŠ¨æ€å˜åŒ–çš„ã€‚</p><h4 id="6-3-è·å–é™æ€ç±»çš„é™æ€å­—æ®µ"><a href="#6-3-è·å–é™æ€ç±»çš„é™æ€å­—æ®µ" class="headerlink" title="6.3 è·å–é™æ€ç±»çš„é™æ€å­—æ®µ"></a>6.3 è·å–é™æ€ç±»çš„é™æ€å­—æ®µ</h4><p>è·å–<code>UserController</code>ç±»é‡Œçš„<code>logger</code>å­—æ®µï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ognl --classLoaderClass org.springframework.boot.loader.LaunchedURLClassLoader @com.example.demo.arthas.user.UserController@logger</span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥é€šè¿‡<code>-x</code>å‚æ•°æ§åˆ¶è¿”å›å€¼çš„å±•å¼€å±‚æ•°ã€‚æ¯”å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ognl --classLoaderClass org.springframework.boot.loader.LaunchedURLClassLoader -x 2 @com.example.demo.arthas.user.UserController@logger</span><br></pre></td></tr></table></figure><h4 id="6-4-æ‰§è¡Œå¤šè¡Œè¡¨è¾¾å¼ï¼Œèµ‹å€¼ç»™ä¸´æ—¶å˜é‡ï¼Œè¿”å›ä¸€ä¸ªList"><a href="#6-4-æ‰§è¡Œå¤šè¡Œè¡¨è¾¾å¼ï¼Œèµ‹å€¼ç»™ä¸´æ—¶å˜é‡ï¼Œè¿”å›ä¸€ä¸ªList" class="headerlink" title="6.4 æ‰§è¡Œå¤šè¡Œè¡¨è¾¾å¼ï¼Œèµ‹å€¼ç»™ä¸´æ—¶å˜é‡ï¼Œè¿”å›ä¸€ä¸ªList"></a>6.4 æ‰§è¡Œå¤šè¡Œè¡¨è¾¾å¼ï¼Œèµ‹å€¼ç»™ä¸´æ—¶å˜é‡ï¼Œè¿”å›ä¸€ä¸ªList</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ognl &#x27;#value1=@System@getProperty(&quot;java.home&quot;), #value2=@System@getProperty(&quot;java.runtime.name&quot;), &#123;#value1, #value2&#125;&#x27;</span><br><span class="line">$ ognl &#x27;#value1=@System@getProperty(&quot;java.home&quot;), #value2=@System@getProperty(&quot;java.runtime.name&quot;), &#123;#value1, #value2&#125;&#x27;</span><br><span class="line">@ArrayList[</span><br><span class="line">    @String[/Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/jre],</span><br><span class="line">    @String[Java(TM) SE Runtime Environment],</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h4 id="6-5-æ›´å¤š"><a href="#6-5-æ›´å¤š" class="headerlink" title="6.5 æ›´å¤š"></a>6.5 æ›´å¤š</h4><p>åœ¨Arthasé‡Œ<code>ognl</code>è¡¨è¾¾å¼æ˜¯å¾ˆé‡è¦çš„åŠŸèƒ½ï¼Œåœ¨å¾ˆå¤šå‘½ä»¤é‡Œéƒ½å¯ä»¥ä½¿ç”¨<code>ognl</code>è¡¨è¾¾å¼ã€‚</p><p>ä¸€äº›æ›´å¤æ‚çš„ç”¨æ³•ï¼Œå¯ä»¥å‚è€ƒï¼š</p><ul><li>OGNLç‰¹æ®Šç”¨æ³•è¯·å‚è€ƒï¼š<a href="https://github.com/alibaba/arthas/issues/71">https://github.com/alibaba/arthas/issues/71</a></li><li>OGNLè¡¨è¾¾å¼å®˜æ–¹æŒ‡å—ï¼š<a href="https://commons.apache.org/proper/commons-ognl/language-guide.html">https://commons.apache.org/proper/commons-ognl/language-guide.html</a></li></ul><h3 id="7-WatchæŸ¥çœ‹å‘½ä»¤"><a href="#7-WatchæŸ¥çœ‹å‘½ä»¤" class="headerlink" title="7. WatchæŸ¥çœ‹å‘½ä»¤"></a>7. WatchæŸ¥çœ‹å‘½ä»¤</h3><h4 id="7-1-å¦‚ä½•ä½¿ç”¨"><a href="#7-1-å¦‚ä½•ä½¿ç”¨" class="headerlink" title="7.1 å¦‚ä½•ä½¿ç”¨"></a>7.1 å¦‚ä½•ä½¿ç”¨</h4><p><code>watch com.example.demo.arthas.user.UserController * &#39;&#123;params, throwExp&#125;&#39;</code></p><p>æ‰§è¡Œå®Œä¹‹åï¼Œä¼šé˜»å¡ï¼Œæ­¤æ—¶å¦‚æœæœ‰è¯·æ±‚è¿›æ¥ï¼Œå‘ç”Ÿä¸€åœºçš„è¯ï¼Œå°±ä¼šçœ‹åˆ°å¼‚å¸¸ä¿¡æ¯ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210820171343673.png" alt="image-20210820171343673"></p><p>å¦‚æœæƒ³æŠŠè·å–åˆ°çš„ç»“æœå±•å¼€ï¼Œå¯ä»¥ç”¨<code>-x</code>å‚æ•°ï¼š</p><p><code>watch com.example.demo.arthas.user.UserController * &#39;&#123;params, throwExp&#125;&#39; -x 2</code></p><h4 id="7-2-è¿”å›å€¼è¡¨è¾¾å¼"><a href="#7-2-è¿”å›å€¼è¡¨è¾¾å¼" class="headerlink" title="7.2 è¿”å›å€¼è¡¨è¾¾å¼"></a>7.2 è¿”å›å€¼è¡¨è¾¾å¼</h4><p>åœ¨ä¸Šé¢çš„ä¾‹å­é‡Œï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯<code>è¿”å›å€¼è¡¨è¾¾å¼</code>ï¼Œå®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ª<code>ognl</code>è¡¨è¾¾å¼ï¼Œå®ƒæ”¯æŒä¸€äº›å†…ç½®å¯¹è±¡ï¼š</p><ul><li>loader</li><li>clazz</li><li>method</li><li>target</li><li>params</li><li>returnObj</li><li>throwExp</li><li>isBefore</li><li>isThrow</li><li>isReturn</li></ul><p>ä½ å¯ä»¥åˆ©ç”¨è¿™äº›å†…ç½®å¯¹è±¡æ¥ç»„æˆä¸åŒçš„è¡¨è¾¾å¼ã€‚æ¯”å¦‚è¿”å›ä¸€ä¸ªæ•°ç»„ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">watch com.example.demo.arthas.user.UserController * &#x27;&#123;params[0], target, returnObj&#125;&#x27;</span><br></pre></td></tr></table></figure><p>æ›´å¤šå‚è€ƒï¼š <a href="https://arthas.aliyun.com/doc/advice-class.html">https://arthas.aliyun.com/doc/advice-class.html</a></p><h4 id="7-3-æ¡ä»¶è¡¨è¾¾å¼"><a href="#7-3-æ¡ä»¶è¡¨è¾¾å¼" class="headerlink" title="7.3 æ¡ä»¶è¡¨è¾¾å¼"></a>7.3 æ¡ä»¶è¡¨è¾¾å¼</h4><p><code>watch</code>å‘½ä»¤æ”¯æŒåœ¨ç¬¬4ä¸ªå‚æ•°é‡Œå†™æ¡ä»¶è¡¨è¾¾å¼ï¼Œæ¯”å¦‚ï¼š</p><p><code>watch com.example.demo.arthas.user.UserController * returnObj &#39;params[0] &gt; 100&#39;</code></p><p>å½“è®¿é—® <code>localhost:80/user/1</code>æ—¶ï¼Œ<code>watch</code>å‘½ä»¤æ²¡æœ‰è¾“å‡º</p><p>å½“è®¿é—®<code>localhost:80/user/101</code>æ—¶ï¼Œ<code>watch</code>ä¼šæ‰“å°å‡ºç»“æœã€‚</p><h4 id="7-4-å½“å¼‚å¸¸æ—¶æ•è·"><a href="#7-4-å½“å¼‚å¸¸æ—¶æ•è·" class="headerlink" title="7.4 å½“å¼‚å¸¸æ—¶æ•è·"></a>7.4 å½“å¼‚å¸¸æ—¶æ•è·</h4><p><code>watch</code>å‘½ä»¤æ”¯æŒ<code>-e</code>é€‰é¡¹ï¼Œè¡¨ç¤ºåªæ•è·æŠ›å‡ºå¼‚å¸¸æ—¶çš„è¯·æ±‚ï¼š</p><p><code>watch com.example.demo.arthas.user.UserController * &quot;&#123;params[0],throwExp&#125;&quot; -e</code></p><h4 id="7-5-æŒ‰ç…§è€—æ—¶è¿›è¡Œè¿‡æ»¤"><a href="#7-5-æŒ‰ç…§è€—æ—¶è¿›è¡Œè¿‡æ»¤" class="headerlink" title="7.5 æŒ‰ç…§è€—æ—¶è¿›è¡Œè¿‡æ»¤"></a>7.5 æŒ‰ç…§è€—æ—¶è¿›è¡Œè¿‡æ»¤</h4><p>watchå‘½ä»¤æ”¯æŒæŒ‰è¯·æ±‚è€—æ—¶è¿›è¡Œè¿‡æ»¤ï¼Œæ¯”å¦‚ï¼š</p><p><code>watch com.example.demo.arthas.user.UserController * &#39;&#123;params, returnObj&#125;&#39; &#39;#cost&gt;200&#39;</code></p><h3 id="8-çƒ­æ›´æ–°ä»£ç "><a href="#8-çƒ­æ›´æ–°ä»£ç " class="headerlink" title="8. çƒ­æ›´æ–°ä»£ç "></a>8. çƒ­æ›´æ–°ä»£ç </h3><p>ä¸‹é¢ä»‹ç»é€šè¿‡<code>jad</code>/<code>mc</code>/<code>redefine</code> å‘½ä»¤å®ç°åŠ¨æ€æ›´æ–°ä»£ç çš„åŠŸèƒ½ã€‚</p><p>ç›®å‰ï¼Œè®¿é—® <a href="http://localhost/user/0">http://localhost/user/0</a> ï¼Œä¼šè¿”å›500å¼‚å¸¸ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl http:<span class="comment">//localhost/user/0</span></span><br><span class="line">&#123;<span class="string">&quot;timestamp&quot;</span>:<span class="number">1550223186170</span>,<span class="string">&quot;status&quot;</span>:<span class="number">500</span>,<span class="string">&quot;error&quot;</span>:<span class="string">&quot;Internal Server Error&quot;</span>,<span class="string">&quot;exception&quot;</span>:<span class="string">&quot;java.lang.IllegalArgumentException&quot;</span>,<span class="string">&quot;message&quot;</span>:<span class="string">&quot;id &lt; 1&quot;</span>,<span class="string">&quot;path&quot;</span>:<span class="string">&quot;/user/0&quot;</span>&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢é€šè¿‡çƒ­æ›´æ–°ä»£ç ï¼Œä¿®æ”¹è¿™ä¸ªé€»è¾‘ã€‚</p><h4 id="8-1-jadåç¼–è¯‘UserController"><a href="#8-1-jadåç¼–è¯‘UserController" class="headerlink" title="8.1 jadåç¼–è¯‘UserController"></a>8.1 jadåç¼–è¯‘UserController</h4><p><strong>åœ¨arthasä¸­æ‰§è¡Œjadå‘½ä»¤ ğŸ‘‡</strong></p><p><code>jad --source-only com.example.demo.arthas.user.UserController &gt; /tmp/UserController.java</code></p><p>jadåç¼–è¯‘çš„ç»“æœä¿å­˜åœ¨ <code>/tmp/UserController.java</code>æ–‡ä»¶é‡Œäº†ã€‚</p><p>åœ¨ã€ æœºå™¨ ã€‘ä¸Šç„¶åç”¨vimæ¥ç¼–è¾‘<code>/tmp/UserController.java</code>ï¼š</p><p><code>vim /tmp/UserController.java</code></p><p>æ¯”å¦‚å½“ user id å°äº1æ—¶ï¼Œä¹Ÿæ­£å¸¸è¿”å›ï¼Œä¸æŠ›å‡ºå¼‚å¸¸ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(value=&#123;&quot;/user/&#123;id&#125;&quot;&#125;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> User <span class="title">findUserById</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span> </span>&#123;</span><br><span class="line">    logger.info(<span class="string">&quot;id: &#123;&#125;&quot;</span>, (Object)id);</span><br><span class="line">    <span class="keyword">if</span> (id != <span class="keyword">null</span> &amp;&amp; id &lt; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> User(id, <span class="string">&quot;name&quot;</span> + id);</span><br><span class="line">        <span class="comment">// throw new IllegalArgumentException(&quot;id &lt; 1&quot;);</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> User(id.intValue(), <span class="string">&quot;name&quot;</span> + id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="8-2-scæŸ¥æ‰¾åŠ è½½UserControllerçš„ClassLoader"><a href="#8-2-scæŸ¥æ‰¾åŠ è½½UserControllerçš„ClassLoader" class="headerlink" title="8.2 scæŸ¥æ‰¾åŠ è½½UserControllerçš„ClassLoader"></a>8.2 scæŸ¥æ‰¾åŠ è½½UserControllerçš„ClassLoader</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sc -d *UserController | grep classLoaderHash</span><br><span class="line">$ sc -d *UserController | grep classLoaderHash</span><br><span class="line"> classLoaderHash   1be6f5c3</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°æ˜¯ <code>springbootLaunchedURLClassLoader@1be6f5c3</code> åŠ è½½çš„ã€‚</p><p>è®°ä¸‹classLoaderHashï¼Œåé¢éœ€è¦ä½¿ç”¨å®ƒã€‚åœ¨è¿™é‡Œï¼Œå®ƒæ˜¯ <code>1be6f5c3</code>ã€‚</p><h4 id="8-3-mcç¼–è¯‘javaæ–‡ä»¶"><a href="#8-3-mcç¼–è¯‘javaæ–‡ä»¶" class="headerlink" title="8.3 mcç¼–è¯‘javaæ–‡ä»¶"></a>8.3 mcç¼–è¯‘javaæ–‡ä»¶</h4><p>ç¼–è¯‘javaæ–‡ä»¶ï¼Œç±»ä¼¼äºjavacã€‚</p><p>ä¿å­˜å¥½<code>/tmp/UserController.java</code>ä¹‹åï¼Œä½¿ç”¨<code>mc</code>(Memory Compiler)å‘½ä»¤æ¥ç¼–è¯‘ï¼Œå¹¶ä¸”é€šè¿‡<code>-c</code>æˆ–è€…<code>--classLoaderClass</code>å‚æ•°æŒ‡å®šClassLoaderï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mc --classLoaderClass org.springframework.boot.loader.LaunchedURLClassLoader /tmp/UserController.java -d /tmp</span><br><span class="line">$ mc --classLoaderClass org.springframework.boot.loader.LaunchedURLClassLoader /tmp/UserController.java -d /tmp</span><br><span class="line">Memory compiler output:</span><br><span class="line">/tmp/com/example/demo/arthas/user/UserController.class</span><br><span class="line">Affect(row-cnt:1) cost in 346 ms</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥é€šè¿‡<code>mc -c &lt;classLoaderHash&gt; /tmp/UserController.java -d /tmp</code>ï¼Œä½¿ç”¨<code>-c</code>å‚æ•°æŒ‡å®šClassLoaderHash:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mc -c 1be6f5c3 /tmp/UserController.java -d /tmp</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210820172201737.png" alt="image-20210820172201737"></p><h4 id="8-4-redefineåŠ è½½classæ–‡ä»¶"><a href="#8-4-redefineåŠ è½½classæ–‡ä»¶" class="headerlink" title="8.4 redefineåŠ è½½classæ–‡ä»¶"></a>8.4 redefineåŠ è½½classæ–‡ä»¶</h4><p>å†ä½¿ç”¨<code>redefine</code>å‘½ä»¤é‡æ–°åŠ è½½æ–°ç¼–è¯‘å¥½çš„<code>UserController.class</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">redefine /tmp/com/example/demo/arthas/user/UserController.class</span><br><span class="line">$ redefine /tmp/com/example/demo/arthas/user/UserController.class</span><br><span class="line">redefine success, size: 1</span><br></pre></td></tr></table></figure><h4 id="8-5-çƒ­ä¿®æ”¹ä»£ç ç»“æœ"><a href="#8-5-çƒ­ä¿®æ”¹ä»£ç ç»“æœ" class="headerlink" title="8.5 çƒ­ä¿®æ”¹ä»£ç ç»“æœ"></a>8.5 çƒ­ä¿®æ”¹ä»£ç ç»“æœ</h4><p><code>redefine</code>æˆåŠŸä¹‹åï¼Œå†æ¬¡è®¿é—® <code>localhost:80/user/0</code> ï¼Œç»“æœæ˜¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;id&quot;: 0,</span><br><span class="line">  &quot;name&quot;: &quot;name0&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="9-Exit-Stop"><a href="#9-Exit-Stop" class="headerlink" title="9. Exit/Stop"></a>9. Exit/Stop</h3><h4 id="9-1-reset"><a href="#9-1-reset" class="headerlink" title="9.1 reset"></a>9.1 reset</h4><p>Arthasåœ¨ watch/trace ç­‰å‘½ä»¤æ—¶ï¼Œå®é™…ä¸Šæ˜¯ä¿®æ”¹äº†åº”ç”¨çš„å­—èŠ‚ç ï¼Œæ’å…¥å¢å¼ºçš„ä»£ç ã€‚æ˜¾å¼æ‰§è¡Œ <code>reset</code> å‘½ä»¤ï¼Œå¯ä»¥æ¸…é™¤æ‰è¿™äº›å¢å¼ºä»£ç ã€‚</p><h4 id="9-2-é€€å‡ºArthas"><a href="#9-2-é€€å‡ºArthas" class="headerlink" title="9.2 é€€å‡ºArthas"></a>9.2 é€€å‡ºArthas</h4><p>ç”¨ <code>exit</code> æˆ–è€… <code>quit</code> å‘½ä»¤å¯ä»¥é€€å‡ºArthasã€‚</p><p>é€€å‡ºArthasä¹‹åï¼Œè¿˜å¯ä»¥å†æ¬¡ç”¨ <code>java -jar arthas-boot.jar</code> æ¥è¿æ¥ã€‚</p><h4 id="9-3-å½»åº•é€€å‡ºArthas"><a href="#9-3-å½»åº•é€€å‡ºArthas" class="headerlink" title="9.3 å½»åº•é€€å‡ºArthas"></a>9.3 å½»åº•é€€å‡ºArthas</h4><p><code>exit/quit</code>å‘½ä»¤åªæ˜¯é€€å‡ºå½“å‰sessionï¼Œarthas serverè¿˜åœ¨ç›®æ ‡è¿›ç¨‹ä¸­è¿è¡Œã€‚</p><p>æƒ³å®Œå…¨é€€å‡ºArthasï¼Œå¯ä»¥æ‰§è¡Œ <code>stop</code> å‘½ä»¤ã€‚</p><h3 id="10-arthas-bootæ”¯æŒçš„å‚æ•°"><a href="#10-arthas-bootæ”¯æŒçš„å‚æ•°" class="headerlink" title="10. arthas-bootæ”¯æŒçš„å‚æ•°"></a>10. arthas-bootæ”¯æŒçš„å‚æ•°</h3><p><code>arthas-boot.jar</code> æ”¯æŒå¾ˆå¤šå‚æ•°ï¼Œå¯ä»¥æ‰§è¡Œ <code>java -jar arthas-boot.jar -h</code> æ¥æŸ¥çœ‹ã€‚</p><h4 id="10-1-å…è®¸å¤–éƒ¨è®¿é—®"><a href="#10-1-å…è®¸å¤–éƒ¨è®¿é—®" class="headerlink" title="10.1 å…è®¸å¤–éƒ¨è®¿é—®"></a>10.1 å…è®¸å¤–éƒ¨è®¿é—®</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ arthas serverä¾¦å¬çš„æ˜¯ <code>127.0.0.1</code> è¿™ä¸ªIPï¼Œå¦‚æœå¸Œæœ›è¿œç¨‹å¯ä»¥è®¿é—®ï¼Œå¯ä»¥ä½¿ç”¨<code>--target-ip</code>çš„å‚æ•°ã€‚</p><p><code>java -jar arthas-boot.jar --target-ip</code></p><h4 id="10-2-åˆ—å‡ºæ‰€æœ‰çš„ç‰ˆæœ¬"><a href="#10-2-åˆ—å‡ºæ‰€æœ‰çš„ç‰ˆæœ¬" class="headerlink" title="10.2 åˆ—å‡ºæ‰€æœ‰çš„ç‰ˆæœ¬"></a>10.2 åˆ—å‡ºæ‰€æœ‰çš„ç‰ˆæœ¬</h4><p><code>java -jar arthas-boot.jar --versions</code></p><p>ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬ï¼š</p><p><code>java -jar arthas-boot.jar --use-version 3.1.0</code></p><h4 id="10-3-åªä¾¦å¬Telnetç«¯å£ï¼Œä¸ä¾¦å¬HTTPç«¯å£"><a href="#10-3-åªä¾¦å¬Telnetç«¯å£ï¼Œä¸ä¾¦å¬HTTPç«¯å£" class="headerlink" title="10.3 åªä¾¦å¬Telnetç«¯å£ï¼Œä¸ä¾¦å¬HTTPç«¯å£"></a>10.3 åªä¾¦å¬Telnetç«¯å£ï¼Œä¸ä¾¦å¬HTTPç«¯å£</h4><p><code>java -jar arthas-boot.jar --telnet-port 9999 --http-port -1</code></p><h4 id="10-4-æ‰“å°è¿è¡Œçš„è¯¦æƒ…"><a href="#10-4-æ‰“å°è¿è¡Œçš„è¯¦æƒ…" class="headerlink" title="10.4 æ‰“å°è¿è¡Œçš„è¯¦æƒ…"></a>10.4 æ‰“å°è¿è¡Œçš„è¯¦æƒ…</h4><p><code>java -jar arthas-boot.jar -v</code></p><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210820164916567.png" alt="image-20210820164916567"></p><h3 id="11-Web-Console"><a href="#11-Web-Console" class="headerlink" title="11. Web Console"></a>11. Web Console</h3><p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210820173816512.png" alt="image-20210820173816512"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Arthas-Javaè¯Šæ–­ç¥å™¨&quot;&gt;&lt;a href=&quot;#Arthas-Javaè¯Šæ–­ç¥å™¨&quot; class=&quot;headerlink&quot; title=&quot;Arthas-Javaè¯Šæ–­ç¥å™¨&quot;&gt;&lt;/a&gt;Arthas-Javaè¯Šæ–­ç¥å™¨&lt;/h2&gt;&lt;img src=&quot;https://cdn</summary>
      
    
    
    
    
    <category term="Linux" scheme="http://example.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>LeetCode-åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—</title>
    <link href="http://example.com/wiki/LeetCode-%E5%8F%AA%E5%87%BA%E7%8E%B0%E4%B8%80%E6%AC%A1%E7%9A%84%E6%95%B0%E5%AD%97/"/>
    <id>http://example.com/wiki/LeetCode-%E5%8F%AA%E5%87%BA%E7%8E%B0%E4%B8%80%E6%AC%A1%E7%9A%84%E6%95%B0%E5%AD%97/</id>
    <published>2021-08-19T13:12:54.000Z</published>
    <updated>2021-08-19T13:17:19.158Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—"><a href="#åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—" class="headerlink" title="åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—"></a>åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—</h1><p><a href="https://leetcode-cn.com/leetbook/read/top-interview-questions-easy/x21ib6/">https://leetcode-cn.com/leetbook/read/top-interview-questions-easy/x21ib6/</a></p><p>ç»™å®šä¸€ä¸ªéç©ºæ•´æ•°æ•°ç»„ï¼Œé™¤äº†æŸä¸ªå…ƒç´ åªå‡ºç°ä¸€æ¬¡ä»¥å¤–ï¼Œå…¶ä½™æ¯ä¸ªå…ƒç´ å‡å‡ºç°ä¸¤æ¬¡ã€‚æ‰¾å‡ºé‚£ä¸ªåªå‡ºç°äº†ä¸€æ¬¡çš„å…ƒç´ ã€‚</p><p>è¯´æ˜ï¼š</p><p>ä½ çš„ç®—æ³•åº”è¯¥å…·æœ‰çº¿æ€§æ—¶é—´å¤æ‚åº¦ã€‚ ä½ å¯ä»¥ä¸ä½¿ç”¨é¢å¤–ç©ºé—´æ¥å®ç°å—ï¼Ÿ</p><p>ç¤ºä¾‹ 1:</p><p>è¾“å…¥: [2,2,1]<br>è¾“å‡º: 1<br>ç¤ºä¾‹ 2:</p><p>è¾“å…¥: [4,1,2,1,2]<br>è¾“å‡º: 4<br>ç›¸å…³æ ‡ç­¾<br>ä½è¿ç®—</p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>ä»…ä»…å‡ºç°ä¸€ä¸ªï¼Œå¾ˆæ˜¾ç„¶ï¼Œè¿™ä¸ªæ•°å’Œå‰åéƒ½ä¸ä¸€æ ·ï¼Œç„¶åç‰¹æ®Šåˆ¤æ–­ä¸€ä¸‹å¤´éƒ¨å’Œå°¾éƒ¨å°±å¯ä»¥äº†ã€‚</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">singleNumber</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(nums.length == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> nums[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        Arrays.sort(nums);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; nums.length; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[i - <span class="number">2</span>] != nums[i - <span class="number">1</span>] &amp;&amp; nums[i - <span class="number">1</span>] != nums[i])&#123;</span><br><span class="line">                <span class="keyword">return</span> nums[i - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(i == nums.length - <span class="number">1</span> &amp;&amp; nums[i] != nums[i - <span class="number">1</span>])&#123;</span><br><span class="line">                <span class="keyword">return</span> nums[i];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(i == <span class="number">2</span> &amp;&amp; nums[i - <span class="number">2</span>] != nums[i - <span class="number">1</span>])&#123;</span><br><span class="line">                <span class="keyword">return</span> nums[i - <span class="number">2</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åˆ†æäºŒ"><a href="#åˆ†æäºŒ" class="headerlink" title="åˆ†æäºŒ"></a>åˆ†æäºŒ</h2><p>ä½¿ç”¨å¼‚æˆ–è¿ç®—ï¼Œå°†æ‰€æœ‰å€¼è¿›è¡Œå¼‚æˆ–<br>å¼‚æˆ–è¿ç®—ï¼Œç›¸å¼‚ä¸ºçœŸï¼Œç›¸åŒä¸ºå‡ï¼Œæ‰€ä»¥<code> a^a = 0 ;0^a = a</code><br>å› ä¸ºå¼‚æˆ–è¿ç®— æ»¡è¶³äº¤æ¢å¾‹ <code>a^b^a = a^a^b = b </code>æ‰€ä»¥æ•°ç»„ç»è¿‡å¼‚æˆ–è¿ç®—ï¼Œå•ç‹¬çš„å€¼å°±å‰©ä¸‹äº†</p><p><a href="https://leetcode-cn.com/leetbook/read/top-interview-questions-easy/x21ib6/?discussion=Mo9fKT">https://leetcode-cn.com/leetbook/read/top-interview-questions-easy/x21ib6/?discussion=Mo9fKT</a></p><h2 id="ä»£ç äºŒ"><a href="#ä»£ç äºŒ" class="headerlink" title="ä»£ç äºŒ"></a>ä»£ç äºŒ</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">singleNumber</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> reduce = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> num : nums) &#123;</span><br><span class="line">            reduce =  reduce ^ num;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> reduce;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—&quot;&gt;&lt;a href=&quot;#åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—&quot; class=&quot;headerlink&quot; title=&quot;åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—&quot;&gt;&lt;/a&gt;åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://leetcode-cn.com/leetbook/read</summary>
      
    
    
    
    
    <category term="ç®€å•" scheme="http://example.com/tags/%E7%AE%80%E5%8D%95/"/>
    
    <category term="æ•°ç»„" scheme="http://example.com/tags/%E6%95%B0%E7%BB%84/"/>
    
    <category term="ä½è¿ç®—" scheme="http://example.com/tags/%E4%BD%8D%E8%BF%90%E7%AE%97/"/>
    
  </entry>
  
  <entry>
    <title>LeetCode-å­˜åœ¨é‡å¤å…ƒç´ </title>
    <link href="http://example.com/wiki/LeetCode-%E5%AD%98%E5%9C%A8%E9%87%8D%E5%A4%8D%E5%85%83%E7%B4%A0/"/>
    <id>http://example.com/wiki/LeetCode-%E5%AD%98%E5%9C%A8%E9%87%8D%E5%A4%8D%E5%85%83%E7%B4%A0/</id>
    <published>2021-08-19T12:57:35.000Z</published>
    <updated>2021-08-19T13:04:26.139Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å­˜åœ¨é‡å¤å…ƒç´ "><a href="#å­˜åœ¨é‡å¤å…ƒç´ " class="headerlink" title="å­˜åœ¨é‡å¤å…ƒç´ "></a>å­˜åœ¨é‡å¤å…ƒç´ </h1><p><a href="https://leetcode-cn.com/leetbook/read/top-interview-questions-easy/x248f5/">https://leetcode-cn.com/leetbook/read/top-interview-questions-easy/x248f5/</a></p><p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨é‡å¤å…ƒç´ ã€‚</p><p>å¦‚æœå­˜åœ¨ä¸€å€¼åœ¨æ•°ç»„ä¸­å‡ºç°è‡³å°‘ä¸¤æ¬¡ï¼Œå‡½æ•°è¿”å› true ã€‚å¦‚æœæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ éƒ½ä¸ç›¸åŒï¼Œåˆ™è¿”å› false ã€‚</p><p>ç¤ºä¾‹ 1:</p><p>è¾“å…¥: [1,2,3,1]<br>è¾“å‡º: true<br>ç¤ºä¾‹ 2:</p><p>è¾“å…¥: [1,2,3,4]<br>è¾“å‡º: false<br>ç¤ºä¾‹ 3:</p><p>è¾“å…¥: [1,1,1,3,3,4,3,2,4,2]<br>è¾“å‡º: true</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p><strong>1ã€åŒé‡å¾ªç¯æ˜¯å¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œä½†æ˜¯ä¼šè¶…å‡ºæ—¶é—´é™åˆ¶</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">containsDuplicate</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; nums.length ; j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(nums[i] == nums[j])&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2ã€å…ˆæ’åºï¼Œç„¶ååˆ¤æ–­ç›¸é‚»ä¸¤ä¸ªå…ƒç´ æ˜¯å¦ç›¸ç­‰</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">containsDuplicate</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">    Arrays.sort(nums);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums[i] == nums[i - <span class="number">1</span>]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å­˜åœ¨é‡å¤å…ƒç´ &quot;&gt;&lt;a href=&quot;#å­˜åœ¨é‡å¤å…ƒç´ &quot; class=&quot;headerlink&quot; title=&quot;å­˜åœ¨é‡å¤å…ƒç´ &quot;&gt;&lt;/a&gt;å­˜åœ¨é‡å¤å…ƒç´ &lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://leetcode-cn.com/leetbook/read/top-int</summary>
      
    
    
    
    
    <category term="ç®€å•" scheme="http://example.com/tags/%E7%AE%80%E5%8D%95/"/>
    
    <category term="æ•°ç»„" scheme="http://example.com/tags/%E6%95%B0%E7%BB%84/"/>
    
    <category term="å“ˆå¸Œè¡¨" scheme="http://example.com/tags/%E5%93%88%E5%B8%8C%E8%A1%A8/"/>
    
    <category term="æ’åº" scheme="http://example.com/tags/%E6%8E%92%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>LeetCode-ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºII</title>
    <link href="http://example.com/wiki/LeetCode-%E4%B9%B0%E5%8D%96%E8%82%A1%E7%A5%A8%E7%9A%84%E6%9C%80%E4%BD%B3%E6%97%B6%E6%9C%BAII/"/>
    <id>http://example.com/wiki/LeetCode-%E4%B9%B0%E5%8D%96%E8%82%A1%E7%A5%A8%E7%9A%84%E6%9C%80%E4%BD%B3%E6%97%B6%E6%9C%BAII/</id>
    <published>2021-08-19T12:35:49.000Z</published>
    <updated>2021-08-19T12:41:01.474Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºII"><a href="#ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºII" class="headerlink" title="ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºII"></a>ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºII</h1><p><a href="https://leetcode-cn.com/leetbook/read/top-interview-questions-easy/x2zsx1/">https://leetcode-cn.com/leetbook/read/top-interview-questions-easy/x2zsx1/</a></p><p>ç»™å®šä¸€ä¸ªæ•°ç»„ prices ï¼Œå…¶ä¸­ prices[i] æ˜¯ä¸€æ”¯ç»™å®šè‚¡ç¥¨ç¬¬ i å¤©çš„ä»·æ ¼ã€‚</p><p>è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥è®¡ç®—ä½ æ‰€èƒ½è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚ä½ å¯ä»¥å°½å¯èƒ½åœ°å®Œæˆæ›´å¤šçš„äº¤æ˜“ï¼ˆå¤šæ¬¡ä¹°å–ä¸€æ”¯è‚¡ç¥¨ï¼‰ã€‚</p><p>æ³¨æ„ï¼šä½ ä¸èƒ½åŒæ—¶å‚ä¸å¤šç¬”äº¤æ˜“ï¼ˆä½ å¿…é¡»åœ¨å†æ¬¡è´­ä¹°å‰å‡ºå”®æ‰ä¹‹å‰çš„è‚¡ç¥¨ï¼‰ã€‚</p><p>ç¤ºä¾‹ 1:</p><p>è¾“å…¥: <code>prices = [7,1,5,3,6,4]</code><br>è¾“å‡º: 7<br>è§£é‡Š: åœ¨ç¬¬ 2 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 1ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 3 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 5ï¼‰çš„æ—¶å€™å–å‡º, è¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ = 5-1 = 4 ã€‚<br>     éšåï¼Œåœ¨ç¬¬ 4 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 3ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 5 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 6ï¼‰çš„æ—¶å€™å–å‡º, è¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ = 6-3 = 3 ã€‚<br>ç¤ºä¾‹ 2:</p><p>è¾“å…¥: <code>prices = [1,2,3,4,5]</code><br>è¾“å‡º: 4<br>è§£é‡Š: åœ¨ç¬¬ 1 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 1ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 5 å¤© ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 5ï¼‰çš„æ—¶å€™å–å‡º, è¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ = 5-1 = 4 ã€‚<br>     æ³¨æ„ä½ ä¸èƒ½åœ¨ç¬¬ 1 å¤©å’Œç¬¬ 2 å¤©æ¥è¿è´­ä¹°è‚¡ç¥¨ï¼Œä¹‹åå†å°†å®ƒä»¬å–å‡ºã€‚å› ä¸ºè¿™æ ·å±äºåŒæ—¶å‚ä¸äº†å¤šç¬”äº¤æ˜“ï¼Œä½ å¿…é¡»åœ¨å†æ¬¡è´­ä¹°å‰å‡ºå”®æ‰ä¹‹å‰çš„è‚¡ç¥¨ã€‚<br>ç¤ºä¾‹ 3:</p><p>è¾“å…¥: <code>prices = [7,6,4,3,1]</code><br>è¾“å‡º: 0<br>è§£é‡Š: åœ¨è¿™ç§æƒ…å†µä¸‹, æ²¡æœ‰äº¤æ˜“å®Œæˆ, æ‰€ä»¥æœ€å¤§åˆ©æ¶¦ä¸º 0ã€‚</p><p>â°æç¤ºï¼š</p><p><code>1 &lt;= prices.length &lt;= 3 * 104</code><br><code>0 &lt;= prices[i] &lt;= 104</code></p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p><code>[7,1,5,3,6,4]</code><br><code>[1,2,3,4,5]</code></p><p>å…¶å®è§„å¾‹å¾ˆç®€å•ï¼Œå°±æ¯”è¾ƒå½“å¤©å’Œå‰ä¸€å¤©çš„å¤§å°å…³ç³»å°±å¥½äº†ï¼Œä¸€æ¬¡å¾ªç¯å°±ä¸‹æ¥äº†ã€‚</p><p>ä¸€å¼€å§‹æƒ³çš„æ¯”è¾ƒå¤æ‚ï¼Œç”¨çš„æŒ‡é’ˆæ»‘åŠ¨ï¼Œæ¯”å¦‚1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5è¿™ç§ï¼Œä¸€å¼€å§‹æƒ³çš„æ˜¯ <code>5 - 1</code> ï¼Œå…¶å® 1 + 1 + 1 + 1å°±è¡Œäº†ã€‚</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span>[] prices)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(prices == <span class="keyword">null</span> || prices.length == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(prices.length == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// [7,1,5,3,6,4]</span></span><br><span class="line">        <span class="comment">// [1,2,3,4,5]</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; prices.length ; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(prices[i] &gt; prices[i - <span class="number">1</span>])&#123;</span><br><span class="line">                count += prices[i] - prices[i - <span class="number">1</span>];</span><br><span class="line">            &#125;        </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºII&quot;&gt;&lt;a href=&quot;#ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºII&quot; class=&quot;headerlink&quot; title=&quot;ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºII&quot;&gt;&lt;/a&gt;ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºII&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://leetcode-cn.com/l</summary>
      
    
    
    
    
    <category term="ç®€å•" scheme="http://example.com/tags/%E7%AE%80%E5%8D%95/"/>
    
    <category term="æ•°ç»„" scheme="http://example.com/tags/%E6%95%B0%E7%BB%84/"/>
    
    <category term="è´ªå¿ƒ" scheme="http://example.com/tags/%E8%B4%AA%E5%BF%83/"/>
    
    <category term="åŠ¨æ€è§„åˆ’" scheme="http://example.com/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
  </entry>
  
  <entry>
    <title>LeetCode-åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹</title>
    <link href="http://example.com/wiki/LeetCode-%E5%88%A0%E9%99%A4%E6%8E%92%E5%BA%8F%E6%95%B0%E7%BB%84%E4%B8%AD%E7%9A%84%E9%87%8D%E5%A4%8D%E9%A1%B9/"/>
    <id>http://example.com/wiki/LeetCode-%E5%88%A0%E9%99%A4%E6%8E%92%E5%BA%8F%E6%95%B0%E7%BB%84%E4%B8%AD%E7%9A%84%E9%87%8D%E5%A4%8D%E9%A1%B9/</id>
    <published>2021-08-19T11:28:03.000Z</published>
    <updated>2021-08-19T11:52:25.170Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹"><a href="#åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹" class="headerlink" title="åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹"></a>åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹</h1><p><a href="https://leetcode-cn.com/leetbook/read/top-interview-questions-easy/x2gy9m/">https://leetcode-cn.com/leetbook/read/top-interview-questions-easy/x2gy9m/</a></p><p>ç»™ä½ ä¸€ä¸ªæœ‰åºæ•°ç»„ nums ï¼Œè¯·ä½  åŸåœ° åˆ é™¤é‡å¤å‡ºç°çš„å…ƒç´ ï¼Œä½¿æ¯ä¸ªå…ƒç´  åªå‡ºç°ä¸€æ¬¡ ï¼Œè¿”å›åˆ é™¤åæ•°ç»„çš„æ–°é•¿åº¦ã€‚</p><p>ä¸è¦ä½¿ç”¨é¢å¤–çš„æ•°ç»„ç©ºé—´ï¼Œä½ å¿…é¡»åœ¨ åŸåœ° ä¿®æ”¹è¾“å…¥æ•°ç»„ å¹¶åœ¨ä½¿ç”¨ O(1) é¢å¤–ç©ºé—´çš„æ¡ä»¶ä¸‹å®Œæˆã€‚ </p><p>è¯´æ˜:</p><p>ä¸ºä»€ä¹ˆè¿”å›æ•°å€¼æ˜¯æ•´æ•°ï¼Œä½†è¾“å‡ºçš„ç­”æ¡ˆæ˜¯æ•°ç»„å‘¢?</p><p>è¯·æ³¨æ„ï¼Œè¾“å…¥æ•°ç»„æ˜¯ä»¥ã€Œå¼•ç”¨ã€æ–¹å¼ä¼ é€’çš„ï¼Œè¿™æ„å‘³ç€åœ¨å‡½æ•°é‡Œä¿®æ”¹è¾“å…¥æ•°ç»„å¯¹äºè°ƒç”¨è€…æ˜¯å¯è§çš„ã€‚</p><p>ä½ å¯ä»¥æƒ³è±¡å†…éƒ¨æ“ä½œå¦‚ä¸‹:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// nums æ˜¯ä»¥â€œå¼•ç”¨â€æ–¹å¼ä¼ é€’çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å¯¹å®å‚åšä»»ä½•æ‹·è´</span></span><br><span class="line"><span class="keyword">int</span> len = removeDuplicates(nums);</span><br><span class="line"><span class="comment">// åœ¨å‡½æ•°é‡Œä¿®æ”¹è¾“å…¥æ•°ç»„å¯¹äºè°ƒç”¨è€…æ˜¯å¯è§çš„ã€‚</span></span><br><span class="line"><span class="comment">// æ ¹æ®ä½ çš„å‡½æ•°è¿”å›çš„é•¿åº¦, å®ƒä¼šæ‰“å°å‡ºæ•°ç»„ä¸­ è¯¥é•¿åº¦èŒƒå›´å†… çš„æ‰€æœ‰å…ƒç´ ã€‚</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">    print(nums[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ 1ï¼š</p><p>è¾“å…¥ï¼šnums = [1,1,2]<br>è¾“å‡ºï¼š2, nums = [1,2]<br>è§£é‡Šï¼šå‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 2 ï¼Œå¹¶ä¸”åŸæ•°ç»„ nums çš„å‰ä¸¤ä¸ªå…ƒç´ è¢«ä¿®æ”¹ä¸º 1, 2 ã€‚ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚<br>ç¤ºä¾‹ 2ï¼š</p><p>è¾“å…¥ï¼šnums = [0,0,1,1,1,2,2,3,3,4]<br>è¾“å‡ºï¼š5, nums = [0,1,2,3,4]<br>è§£é‡Šï¼šå‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 5 ï¼Œ å¹¶ä¸”åŸæ•°ç»„ nums çš„å‰äº”ä¸ªå…ƒç´ è¢«ä¿®æ”¹ä¸º 0, 1, 2, 3, 4 ã€‚ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚</p><p>æç¤ºï¼š</p><p>0 &lt;= nums.length &lt;= 3 * 104<br>-104 &lt;= nums[i] &lt;= 104<br>nums å·²æŒ‰å‡åºæ’åˆ—</p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>å‡å¦‚è¾“å…¥ <code>[0,0,1,1,1,2,2,3,3,4]</code></p><p>æœ€ç»ˆçš„ç»“æœåº”è¯¥æ˜¯<code>[0,1,2,3,4,2,2,3,3,4]</code></p><p><strong>count</strong> å˜é‡ç”¨æ¥å­˜å‚¨ä¸é‡å¤æ•°ç»„çš„ä¸ªæ•°</p><p><strong>offset</strong> ä½œä¸ºå½“å‰æ¸¸æ ‡è®°å½•åˆ¤æ–­ä¹‹åä¸é‡å¤çš„æ•°æ®çš„ä½ç½®</p><img src="https://cdn.jsdelivr.net/gh/zabernism/image@main/gao/image-20210819194952616.png" style="zoom:33%;" /><h2 id="è§£æ³•"><a href="#è§£æ³•" class="headerlink" title="è§£æ³•"></a>è§£æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">removeDuplicates</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> result = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> offset = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i&lt;nums.length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[i] == nums[i - <span class="number">1</span>])&#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            nums[offset] = nums[i];</span><br><span class="line">            offset++;</span><br><span class="line">            result++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹&quot;&gt;&lt;a href=&quot;#åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹&quot; class=&quot;headerlink&quot; title=&quot;åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹&quot;&gt;&lt;/a&gt;åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://leetcode-cn.com/l</summary>
      
    
    
    
    
    <category term="ç®€å•" scheme="http://example.com/tags/%E7%AE%80%E5%8D%95/"/>
    
    <category term="æ•°ç»„" scheme="http://example.com/tags/%E6%95%B0%E7%BB%84/"/>
    
    <category term="åŒæŒ‡é’ˆ" scheme="http://example.com/tags/%E5%8F%8C%E6%8C%87%E9%92%88/"/>
    
  </entry>
  
</feed>
