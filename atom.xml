<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>GeekIBLi</title>
  
  <subtitle>For Coder</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2021-07-14T15:37:17.354Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>gaolei</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>å¯åŠ¨ELKè„šæœ¬å‘½ä»¤</title>
    <link href="http://example.com/wiki/%E5%90%AF%E5%8A%A8ELK%E8%84%9A%E6%9C%AC%E5%91%BD%E4%BB%A4/"/>
    <id>http://example.com/wiki/%E5%90%AF%E5%8A%A8ELK%E8%84%9A%E6%9C%AC%E5%91%BD%E4%BB%A4/</id>
    <published>2021-07-14T15:37:17.000Z</published>
    <updated>2021-07-14T15:37:17.354Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><blockquote><ul><li><a href=""></a></li><li><a href=""></a></li></ul></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‚è€ƒèµ„æ–™&quot;&gt;&lt;a href=&quot;#å‚è€ƒèµ„æ–™&quot; class=&quot;headerlink&quot; title=&quot;å‚è€ƒèµ„æ–™&quot;&gt;&lt;/a&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;&quot;&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;&quot;&gt;&lt;/a&gt;&lt;/l</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>elasticsearchè°ƒä¼˜å®è·µ</title>
    <link href="http://example.com/wiki/elasticsearch%E8%B0%83%E4%BC%98%E5%AE%9E%E8%B7%B5-0/"/>
    <id>http://example.com/wiki/elasticsearch%E8%B0%83%E4%BC%98%E5%AE%9E%E8%B7%B5-0/</id>
    <published>2021-07-14T15:12:16.000Z</published>
    <updated>2021-07-15T03:32:07.375Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä»æ€§èƒ½å’Œç¨³å®šæ€§ä¸¤æ–¹é¢ï¼Œä»linuxå‚æ•°è°ƒä¼˜ã€ESèŠ‚ç‚¹é…ç½®å’ŒESä½¿ç”¨æ–¹å¼ä¸‰ä¸ªè§’åº¦å…¥æ‰‹ï¼Œä»‹ç»ESè°ƒä¼˜çš„åŸºæœ¬æ–¹æ¡ˆã€‚å½“ç„¶ï¼ŒESçš„è°ƒä¼˜ç»ä¸èƒ½ä¸€æ¦‚è€Œè®ºï¼Œéœ€è¦æ ¹æ®å®é™…ä¸šåŠ¡åœºæ™¯åšé€‚å½“çš„å–èˆå’Œè°ƒæ•´</p></blockquote><h2 id="Linuxä¼˜åŒ–"><a href="#Linuxä¼˜åŒ–" class="headerlink" title="Linuxä¼˜åŒ–"></a>Linuxä¼˜åŒ–</h2><h3 id="å…³é—­äº¤æ¢åˆ†åŒºï¼Œé˜²æ­¢å†…å­˜ç½®æ¢é™ä½æ€§èƒ½ã€‚"><a href="#å…³é—­äº¤æ¢åˆ†åŒºï¼Œé˜²æ­¢å†…å­˜ç½®æ¢é™ä½æ€§èƒ½ã€‚" class="headerlink" title="å…³é—­äº¤æ¢åˆ†åŒºï¼Œé˜²æ­¢å†…å­˜ç½®æ¢é™ä½æ€§èƒ½ã€‚"></a>å…³é—­äº¤æ¢åˆ†åŒºï¼Œé˜²æ­¢å†…å­˜ç½®æ¢é™ä½æ€§èƒ½ã€‚</h3><p>å°† <code>/etc/fstab</code> æ–‡ä»¶ä¸­åŒ…å«swapçš„è¡Œæ³¨é‡Šæ‰<br><code>sed -i &#39;/swap/s/^/#/&#39; /etc/fstabswapoff -a</code></p><h3 id="ç£ç›˜æŒ‚è½½é€‰é¡¹"><a href="#ç£ç›˜æŒ‚è½½é€‰é¡¹" class="headerlink" title="ç£ç›˜æŒ‚è½½é€‰é¡¹"></a>ç£ç›˜æŒ‚è½½é€‰é¡¹</h3><p>noatimeï¼šç¦æ­¢è®°å½•è®¿é—®æ—¶é—´æˆ³ï¼Œæé«˜æ–‡ä»¶ç³»ç»Ÿè¯»å†™æ€§èƒ½<br>data=writebackï¼š ä¸è®°å½•data journalï¼Œæé«˜æ–‡ä»¶ç³»ç»Ÿå†™å…¥æ€§èƒ½<br>barrier=0ï¼šbarrierä¿è¯journalå…ˆäºdataåˆ·åˆ°ç£ç›˜ï¼Œä¸Šé¢å…³é—­äº†journalï¼Œè¿™é‡Œçš„barrierä¹Ÿå°±æ²¡å¿…è¦å¼€å¯äº†<br>nobhï¼šå…³é—­buffer_headï¼Œé˜²æ­¢å†…æ ¸æ‰“æ–­å¤§å—æ•°æ®çš„IOæ“ä½œ<br>mount -o noatime,data=writeback,barrier=0,nobh /dev/sda /es_data</p><h3 id="å¯¹äºSSDç£ç›˜ï¼Œé‡‡ç”¨ç”µæ¢¯è°ƒåº¦ç®—æ³•"><a href="#å¯¹äºSSDç£ç›˜ï¼Œé‡‡ç”¨ç”µæ¢¯è°ƒåº¦ç®—æ³•" class="headerlink" title="å¯¹äºSSDç£ç›˜ï¼Œé‡‡ç”¨ç”µæ¢¯è°ƒåº¦ç®—æ³•"></a>å¯¹äºSSDç£ç›˜ï¼Œé‡‡ç”¨ç”µæ¢¯è°ƒåº¦ç®—æ³•</h3><p>å› ä¸ºSSDæä¾›äº†æ›´æ™ºèƒ½çš„è¯·æ±‚è°ƒåº¦ç®—æ³•ï¼Œä¸éœ€è¦å†…æ ¸å»åšå¤šä½™çš„è°ƒæ•´ (ä»…ä¾›å‚è€ƒ)<br><code>echo noop &gt; /sys/block/sda/queue/scheduler</code></p><h2 id="ESèŠ‚ç‚¹é…ç½®"><a href="#ESèŠ‚ç‚¹é…ç½®" class="headerlink" title="ESèŠ‚ç‚¹é…ç½®"></a>ESèŠ‚ç‚¹é…ç½®</h2><p>conf/elasticsearch.ymlæ–‡ä»¶ï¼š</p><h3 id="é€‚å½“å¢å¤§å†™å…¥bufferå’Œbulké˜Ÿåˆ—é•¿åº¦ï¼Œæé«˜å†™å…¥æ€§èƒ½å’Œç¨³å®šæ€§"><a href="#é€‚å½“å¢å¤§å†™å…¥bufferå’Œbulké˜Ÿåˆ—é•¿åº¦ï¼Œæé«˜å†™å…¥æ€§èƒ½å’Œç¨³å®šæ€§" class="headerlink" title="é€‚å½“å¢å¤§å†™å…¥bufferå’Œbulké˜Ÿåˆ—é•¿åº¦ï¼Œæé«˜å†™å…¥æ€§èƒ½å’Œç¨³å®šæ€§"></a>é€‚å½“å¢å¤§å†™å…¥bufferå’Œbulké˜Ÿåˆ—é•¿åº¦ï¼Œæé«˜å†™å…¥æ€§èƒ½å’Œç¨³å®šæ€§</h3><p><code>indices.memory.index_buffer_size: 15%</code><br><code>thread_pool.bulk.queue_size: 1024</code></p><h3 id="è®¡ç®—diskä½¿ç”¨é‡æ—¶ï¼Œä¸è€ƒè™‘æ­£åœ¨æ¬è¿çš„shard"><a href="#è®¡ç®—diskä½¿ç”¨é‡æ—¶ï¼Œä¸è€ƒè™‘æ­£åœ¨æ¬è¿çš„shard" class="headerlink" title="è®¡ç®—diskä½¿ç”¨é‡æ—¶ï¼Œä¸è€ƒè™‘æ­£åœ¨æ¬è¿çš„shard"></a>è®¡ç®—diskä½¿ç”¨é‡æ—¶ï¼Œä¸è€ƒè™‘æ­£åœ¨æ¬è¿çš„shard</h3><p>åœ¨è§„æ¨¡æ¯”è¾ƒå¤§çš„é›†ç¾¤ä¸­ï¼Œå¯ä»¥é˜²æ­¢æ–°å»ºshardæ—¶æ‰«ææ‰€æœ‰shardçš„å…ƒæ•°æ®ï¼Œæå‡shardåˆ†é…é€Ÿåº¦ã€‚<br><code>cluster.routing.allocation.disk.include_relocations: false</code></p><h2 id="ä¸‰-ESä½¿ç”¨æ–¹å¼"><a href="#ä¸‰-ESä½¿ç”¨æ–¹å¼" class="headerlink" title="ä¸‰ ESä½¿ç”¨æ–¹å¼"></a>ä¸‰ ESä½¿ç”¨æ–¹å¼</h2><h3 id="æ§åˆ¶å­—æ®µçš„å­˜å‚¨é€‰é¡¹"><a href="#æ§åˆ¶å­—æ®µçš„å­˜å‚¨é€‰é¡¹" class="headerlink" title="æ§åˆ¶å­—æ®µçš„å­˜å‚¨é€‰é¡¹"></a>æ§åˆ¶å­—æ®µçš„å­˜å‚¨é€‰é¡¹</h3><p>ESåº•å±‚ä½¿ç”¨Luceneå­˜å‚¨æ•°æ®ï¼Œä¸»è¦åŒ…æ‹¬è¡Œå­˜ï¼ˆStoreFiledï¼‰ã€åˆ—å­˜ï¼ˆDocValuesï¼‰å’Œå€’æ’ç´¢å¼•ï¼ˆInvertIndexï¼‰ä¸‰éƒ¨åˆ†ã€‚ å¤§å¤šæ•°ä½¿ç”¨åœºæ™¯ä¸­ï¼Œæ²¡æœ‰å¿…è¦åŒæ—¶å­˜å‚¨è¿™ä¸‰ä¸ªéƒ¨åˆ†ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å‚æ•°æ¥åšé€‚å½“è°ƒæ•´ï¼š</p><h4 id="StoreFiled"><a href="#StoreFiled" class="headerlink" title="StoreFiled"></a>StoreFiled</h4><p>è¡Œå­˜ï¼Œå…¶ä¸­å æ¯”æœ€å¤§çš„æ˜¯sourceå­—æ®µï¼Œå®ƒæ§åˆ¶docåŸå§‹æ•°æ®çš„å­˜å‚¨ã€‚åœ¨å†™å…¥æ•°æ®æ—¶ï¼ŒESæŠŠdocåŸå§‹æ•°æ®çš„æ•´ä¸ªjsonç»“æ„ä½“å½“åšä¸€ä¸ªstringï¼Œå­˜å‚¨ä¸ºsourceå­—æ®µã€‚æŸ¥è¯¢æ—¶ï¼Œå¯ä»¥é€šè¿‡sourceå­—æ®µæ‹¿åˆ°å½“åˆå†™å…¥æ—¶çš„æ•´ä¸ªjsonç»“æ„ä½“ã€‚ æ‰€ä»¥ï¼Œå¦‚æœæ²¡æœ‰å–å‡ºæ•´ä¸ªåŸå§‹jsonç»“æ„ä½“çš„éœ€æ±‚ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤ï¼Œåœ¨mappingä¸­å…³é—­sourceå­—æ®µæˆ–è€…åªåœ¨sourceä¸­å­˜å‚¨éƒ¨åˆ†å­—æ®µï¼Œæ•°æ®æŸ¥è¯¢æ—¶ä»å¯é€šè¿‡ESçš„docvaluefieldsè·å–æ‰€æœ‰å­—æ®µçš„å€¼ã€‚<br>æ³¨æ„ï¼šå…³é—­sourceåï¼Œ update, updatebyquery, reindexç­‰æ¥å£å°†æ— æ³•æ­£å¸¸ä½¿ç”¨ï¼Œæ‰€ä»¥æœ‰updateç­‰éœ€æ±‚çš„indexä¸èƒ½å…³é—­sourceã€‚</p><ul><li>å…³é—­ _source<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PUT my_index </span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;mappings&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;my_type&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;_source&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;enabled&quot;</span>: <span class="literal">false</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h4 id="sourceåªå­˜å‚¨éƒ¨åˆ†å­—æ®µ"><a href="#sourceåªå­˜å‚¨éƒ¨åˆ†å­—æ®µ" class="headerlink" title="_sourceåªå­˜å‚¨éƒ¨åˆ†å­—æ®µ"></a>_sourceåªå­˜å‚¨éƒ¨åˆ†å­—æ®µ</h4><p>é€šè¿‡includesæŒ‡å®šè¦å­˜å‚¨çš„å­—æ®µæˆ–è€…é€šè¿‡excludesæ»¤é™¤ä¸éœ€è¦çš„å­—æ®µ</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">PUT my_index</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;mappings&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;_doc&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;_source&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;includes&quot;</span>: [</span><br><span class="line">          <span class="string">&quot;*.count&quot;</span>,</span><br><span class="line">          <span class="string">&quot;meta.*&quot;</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">&quot;excludes&quot;</span>: [</span><br><span class="line">          <span class="string">&quot;meta.description&quot;</span>,</span><br><span class="line">          <span class="string">&quot;meta.other.*&quot;</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="docvalues-æ§åˆ¶åˆ—å­˜ã€‚"><a href="#docvalues-æ§åˆ¶åˆ—å­˜ã€‚" class="headerlink" title="docvalues æ§åˆ¶åˆ—å­˜ã€‚"></a>docvalues æ§åˆ¶åˆ—å­˜ã€‚</h4><p>ESä¸»è¦ä½¿ç”¨åˆ—å­˜æ¥æ”¯æŒsorting, aggregationså’ŒscriptsåŠŸèƒ½ï¼Œå¯¹äºæ²¡æœ‰ä¸Šè¿°éœ€æ±‚çš„å­—æ®µï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤å…³é—­docvaluesï¼Œé™ä½å­˜å‚¨æˆæœ¬ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">PUT my_index</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;mappings&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;my_type&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;session_id&quot;</span>: &#123;</span><br><span class="line">          <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;keyword&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;doc_values&quot;</span>: <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ndexï¼šæ§åˆ¶å€’æ’ç´¢å¼•ã€‚"><a href="#ndexï¼šæ§åˆ¶å€’æ’ç´¢å¼•ã€‚" class="headerlink" title="ndexï¼šæ§åˆ¶å€’æ’ç´¢å¼•ã€‚"></a>ndexï¼šæ§åˆ¶å€’æ’ç´¢å¼•ã€‚</h4><p>ESé»˜è®¤å¯¹äºæ‰€æœ‰å­—æ®µéƒ½å¼€å¯äº†å€’æ’ç´¢å¼•ï¼Œç”¨äºæŸ¥è¯¢ã€‚å¯¹äºæ²¡æœ‰æŸ¥è¯¢éœ€æ±‚çš„å­—æ®µï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤å…³é—­å€’æ’ç´¢å¼•ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">PUT my_index</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;mappings&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;my_type&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;session_id&quot;</span>: &#123;</span><br><span class="line">          <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;keyword&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;index&quot;</span>: <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="allESçš„ä¸€ä¸ªç‰¹æ®Šçš„å­—æ®µ"><a href="#allESçš„ä¸€ä¸ªç‰¹æ®Šçš„å­—æ®µ" class="headerlink" title="allESçš„ä¸€ä¸ªç‰¹æ®Šçš„å­—æ®µ"></a>allESçš„ä¸€ä¸ªç‰¹æ®Šçš„å­—æ®µ</h4><ul><li>ESæŠŠç”¨æˆ·å†™å…¥jsonçš„æ‰€æœ‰å­—æ®µå€¼æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²åï¼Œåšåˆ†è¯ï¼Œç„¶åä¿å­˜å€’æ’ç´¢å¼•ï¼Œç”¨äºæ”¯æŒæ•´ä¸ªjsonçš„å…¨æ–‡æ£€ç´¢ã€‚<br>è¿™ç§éœ€æ±‚é€‚ç”¨çš„åœºæ™¯è¾ƒå°‘ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤å°†allå­—æ®µå…³é—­ï¼ŒèŠ‚çº¦å­˜å‚¨æˆæœ¬å’Œcpuå¼€é”€ã€‚ï¼ˆES 6.0+ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸å†æ”¯æŒ_allå­—æ®µï¼Œä¸éœ€è¦è®¾ç½®ï¼‰<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PUT /my_index</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;mapping&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;my_type&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;_all&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;enabled&quot;</span>: <span class="literal">false</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="fieldnames"><a href="#fieldnames" class="headerlink" title="fieldnames"></a>fieldnames</h4>è¯¥å­—æ®µç”¨äºexistsæŸ¥è¯¢ï¼Œæ¥ç¡®è®¤æŸä¸ªdocé‡Œé¢æœ‰æ— ä¸€ä¸ªå­—æ®µå­˜åœ¨ã€‚è‹¥æ²¡æœ‰è¿™ç§éœ€æ±‚ï¼Œå¯ä»¥å°†å…¶å…³é—­ã€‚<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PUT /my_index</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;mapping&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;my_type&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;_field_names&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;enabled&quot;</span>: <span class="literal">false</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="å¼€å¯æœ€ä½³å‹ç¼©"><a href="#å¼€å¯æœ€ä½³å‹ç¼©" class="headerlink" title="å¼€å¯æœ€ä½³å‹ç¼©"></a>å¼€å¯æœ€ä½³å‹ç¼©</h3><p>å¯¹äºæ‰“å¼€äº†ä¸Šè¿°_sourceå­—æ®µçš„indexï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥æŠŠluceneé€‚ç”¨çš„å‹ç¼©ç®—æ³•æ›¿æ¢æˆ DEFLATEï¼Œæé«˜æ•°æ®å‹ç¼©ç‡ã€‚<br><code>PUT /my_index/_settings&#123;    &quot;index.codec&quot;: &quot;best_compression&quot;&#125;</code></p><h3 id="bulkæ‰¹é‡å†™å…¥"><a href="#bulkæ‰¹é‡å†™å…¥" class="headerlink" title="bulkæ‰¹é‡å†™å…¥"></a>bulkæ‰¹é‡å†™å…¥</h3><p>å†™å…¥æ•°æ®æ—¶å°½é‡ä½¿ç”¨ä¸‹é¢çš„bulkæ¥å£æ‰¹é‡å†™å…¥ï¼Œæé«˜å†™å…¥æ•ˆç‡ã€‚æ¯ä¸ªbulkè¯·æ±‚çš„docæ•°é‡è®¾å®šåŒºé—´æ¨èä¸º1k~1wï¼Œå…·ä½“å¯æ ¹æ®ä¸šåŠ¡åœºæ™¯é€‰å–ä¸€ä¸ªé€‚å½“çš„æ•°é‡ã€‚</p><h3 id="è°ƒæ•´translogåŒæ­¥ç­–ç•¥"><a href="#è°ƒæ•´translogåŒæ­¥ç­–ç•¥" class="headerlink" title="è°ƒæ•´translogåŒæ­¥ç­–ç•¥"></a>è°ƒæ•´translogåŒæ­¥ç­–ç•¥</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œtranslogçš„æŒä¹…åŒ–ç­–ç•¥æ˜¯ï¼Œå¯¹äºæ¯ä¸ªå†™å…¥è¯·æ±‚éƒ½åšä¸€æ¬¡flushï¼Œåˆ·æ–°translogæ•°æ®åˆ°ç£ç›˜ä¸Šã€‚è¿™ç§é¢‘ç¹çš„ç£ç›˜IOæ“ä½œæ˜¯ä¸¥é‡å½±å“å†™å…¥æ€§èƒ½çš„ï¼Œå¦‚æœå¯ä»¥æ¥å—ä¸€å®šæ¦‚ç‡çš„æ•°æ®ä¸¢å¤±ï¼ˆè¿™ç§ç¡¬ä»¶æ•…éšœçš„æ¦‚ç‡å¾ˆå°ï¼‰ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤è°ƒæ•´ translog æŒä¹…åŒ–ç­–ç•¥ä¸ºå¼‚æ­¥å‘¨æœŸæ€§æ‰§è¡Œï¼Œå¹¶é€‚å½“è°ƒæ•´translogçš„åˆ·ç›˜å‘¨æœŸã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">PUT my_index</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;settings&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;index&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;translog&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;sync_interval&quot;</span>: <span class="string">&quot;5s&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;durability&quot;</span>: <span class="string">&quot;async&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è°ƒæ•´refresh-interval"><a href="#è°ƒæ•´refresh-interval" class="headerlink" title="è°ƒæ•´refresh_interval"></a>è°ƒæ•´refresh_interval</h3><p>å†™å…¥Luceneçš„æ•°æ®ï¼Œå¹¶ä¸æ˜¯å®æ—¶å¯æœç´¢çš„ï¼ŒESå¿…é¡»é€šè¿‡refreshçš„è¿‡ç¨‹æŠŠå†…å­˜ä¸­çš„æ•°æ®è½¬æ¢æˆLuceneçš„å®Œæ•´segmentåï¼Œæ‰å¯ä»¥è¢«æœç´¢ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒESæ¯ä¸€ç§’ä¼šrefreshä¸€æ¬¡ï¼Œäº§ç”Ÿä¸€ä¸ªæ–°çš„segmentï¼Œè¿™æ ·ä¼šå¯¼è‡´äº§ç”Ÿçš„segmentè¾ƒå¤šï¼Œä»è€Œsegment mergeè¾ƒä¸ºé¢‘ç¹ï¼Œç³»ç»Ÿå¼€é”€è¾ƒå¤§ã€‚å¦‚æœå¯¹æ•°æ®çš„å®æ—¶å¯è§æ€§è¦æ±‚è¾ƒä½ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æé«˜refreshçš„æ—¶é—´é—´éš”ï¼Œé™ä½ç³»ç»Ÿå¼€é”€ã€‚</p><p><code>PUT my_index&#123;  &quot;settings&quot;: &#123;    &quot;index&quot;: &#123;        &quot;refresh_interval&quot; : &quot;30s&quot;    &#125;  &#125;&#125;</code></p><h3 id="mergeå¹¶å‘æ§åˆ¶"><a href="#mergeå¹¶å‘æ§åˆ¶" class="headerlink" title="mergeå¹¶å‘æ§åˆ¶"></a>mergeå¹¶å‘æ§åˆ¶</h3><p>ESçš„ä¸€ä¸ªindexç”±å¤šä¸ªshardç»„æˆï¼Œè€Œä¸€ä¸ªshardå…¶å®å°±æ˜¯ä¸€ä¸ªLuceneçš„indexï¼Œå®ƒåˆç”±å¤šä¸ªsegmentç»„æˆï¼Œä¸”Luceneä¼šä¸æ–­åœ°æŠŠä¸€äº›å°çš„segmentåˆå¹¶æˆä¸€ä¸ªå¤§çš„segmentï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºmergeã€‚é»˜è®¤å€¼æ˜¯Math.max(1, Math.min(4, Runtime.getRuntime().availableProcessors() / 2))ï¼Œå½“èŠ‚ç‚¹é…ç½®çš„cpuæ ¸æ•°è¾ƒé«˜æ—¶ï¼Œmergeå ç”¨çš„èµ„æºå¯èƒ½ä¼šåé«˜ï¼Œå½±å“é›†ç¾¤çš„æ€§èƒ½ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤è°ƒæ•´æŸä¸ªindexçš„mergeè¿‡ç¨‹çš„å¹¶å‘åº¦ï¼š</p><p><code>PUT /my_index/_settings&#123;    &quot;index.merge.scheduler.max_thread_count&quot;: 2&#125;</code></p><h3 id="å†™å…¥æ•°æ®ä¸æŒ‡å®š-idï¼Œè®©ESè‡ªåŠ¨äº§ç”Ÿ"><a href="#å†™å…¥æ•°æ®ä¸æŒ‡å®š-idï¼Œè®©ESè‡ªåŠ¨äº§ç”Ÿ" class="headerlink" title="å†™å…¥æ•°æ®ä¸æŒ‡å®š_idï¼Œè®©ESè‡ªåŠ¨äº§ç”Ÿ"></a>å†™å…¥æ•°æ®ä¸æŒ‡å®š_idï¼Œè®©ESè‡ªåŠ¨äº§ç”Ÿ</h3><p>å½“ç”¨æˆ·æ˜¾ç¤ºæŒ‡å®šidå†™å…¥æ•°æ®æ—¶ï¼ŒESä¼šå…ˆå‘èµ·æŸ¥è¯¢æ¥ç¡®å®šindexä¸­æ˜¯å¦å·²ç»æœ‰ç›¸åŒidçš„docå­˜åœ¨ï¼Œè‹¥æœ‰åˆ™å…ˆåˆ é™¤åŸæœ‰docå†å†™å…¥æ–°docã€‚è¿™æ ·æ¯æ¬¡å†™å…¥æ—¶ï¼ŒESéƒ½ä¼šè€—è´¹ä¸€å®šçš„èµ„æºåšæŸ¥è¯¢ã€‚å¦‚æœç”¨æˆ·å†™å…¥æ•°æ®æ—¶ä¸æŒ‡å®šdocï¼ŒESåˆ™é€šè¿‡å†…éƒ¨ç®—æ³•äº§ç”Ÿä¸€ä¸ªéšæœºçš„idï¼Œå¹¶ä¸”ä¿è¯idçš„å”¯ä¸€æ€§ï¼Œè¿™æ ·å°±å¯ä»¥è·³è¿‡å‰é¢æŸ¥è¯¢idçš„æ­¥éª¤ï¼Œæé«˜å†™å…¥æ•ˆç‡ã€‚ æ‰€ä»¥ï¼Œåœ¨ä¸éœ€è¦é€šè¿‡idå­—æ®µå»é‡ã€updateçš„ä½¿ç”¨åœºæ™¯ä¸­ï¼Œå†™å…¥ä¸æŒ‡å®šidå¯ä»¥æå‡å†™å…¥é€Ÿç‡ã€‚åŸºç¡€æ¶æ„éƒ¨æ•°æ®åº“å›¢é˜Ÿçš„æµ‹è¯•ç»“æœæ˜¾ç¤ºï¼Œæ— idçš„æ•°æ®å†™å…¥æ€§èƒ½å¯èƒ½æ¯”æœ‰_idçš„é«˜å‡ºè¿‘ä¸€å€ï¼Œå®é™…æŸè€—å’Œå…·ä½“æµ‹è¯•åœºæ™¯ç›¸å…³ã€‚</p><h3 id="routing"><a href="#routing" class="headerlink" title="routing"></a>routing</h3><p>å¯¹äºæ•°æ®é‡è¾ƒå¤§çš„indexï¼Œä¸€èˆ¬ä¼šé…ç½®å¤šä¸ªshardæ¥åˆ†æ‘Šå‹åŠ›ã€‚è¿™ç§åœºæ™¯ä¸‹ï¼Œä¸€ä¸ªæŸ¥è¯¢ä¼šåŒæ—¶æœç´¢æ‰€æœ‰çš„shardï¼Œç„¶åå†å°†å„ä¸ªshardçš„ç»“æœåˆå¹¶åï¼Œè¿”å›ç»™ç”¨æˆ·ã€‚å¯¹äºé«˜å¹¶å‘çš„å°æŸ¥è¯¢åœºæ™¯ï¼Œæ¯ä¸ªåˆ†ç‰‡é€šå¸¸ä»…æŠ“å–æå°‘é‡æ•°æ®ï¼Œæ­¤æ—¶æŸ¥è¯¢è¿‡ç¨‹ä¸­çš„è°ƒåº¦å¼€é”€è¿œå¤§äºå®é™…è¯»å–æ•°æ®çš„å¼€é”€ï¼Œä¸”æŸ¥è¯¢é€Ÿåº¦å–å†³äºæœ€æ…¢çš„ä¸€ä¸ªåˆ†ç‰‡ã€‚å¼€å¯routingåŠŸèƒ½åï¼ŒESä¼šå°†routingç›¸åŒçš„æ•°æ®å†™å…¥åˆ°åŒä¸€ä¸ªåˆ†ç‰‡ä¸­ï¼ˆä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªï¼Œç”±index.routingpartitionsizeå‚æ•°æ§åˆ¶ï¼‰ã€‚å¦‚æœæŸ¥è¯¢æ—¶æŒ‡å®šroutingï¼Œé‚£ä¹ˆESåªä¼šæŸ¥è¯¢routingæŒ‡å‘çš„é‚£ä¸ªåˆ†ç‰‡ï¼Œå¯æ˜¾è‘—é™ä½è°ƒåº¦å¼€é”€ï¼Œæå‡æŸ¥è¯¢æ•ˆç‡ã€‚ routingçš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># å†™å…¥PUT my_index/my_type/<span class="number">1</span>?routing=user1&#123;  <span class="attr">&quot;title&quot;</span>: <span class="string">&quot;This is a document&quot;</span>&#125;</span><br><span class="line"># æŸ¥è¯¢GET my_index/_search?routing=user1,user2 &#123;  <span class="attr">&quot;query&quot;</span>: &#123;    <span class="attr">&quot;match&quot;</span>: &#123;      <span class="attr">&quot;title&quot;</span>: <span class="string">&quot;document&quot;</span>    &#125;  &#125;&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸ºstringç±»å‹çš„å­—æ®µé€‰å–åˆé€‚çš„å­˜å‚¨æ–¹å¼"><a href="#ä¸ºstringç±»å‹çš„å­—æ®µé€‰å–åˆé€‚çš„å­˜å‚¨æ–¹å¼" class="headerlink" title="ä¸ºstringç±»å‹çš„å­—æ®µé€‰å–åˆé€‚çš„å­˜å‚¨æ–¹å¼"></a>ä¸ºstringç±»å‹çš„å­—æ®µé€‰å–åˆé€‚çš„å­˜å‚¨æ–¹å¼</h3><h4 id="å­˜ä¸ºtextç±»å‹çš„å­—æ®µï¼ˆstringå­—æ®µé»˜è®¤ç±»å‹ä¸ºtextï¼‰ï¼š"><a href="#å­˜ä¸ºtextç±»å‹çš„å­—æ®µï¼ˆstringå­—æ®µé»˜è®¤ç±»å‹ä¸ºtextï¼‰ï¼š" class="headerlink" title="å­˜ä¸ºtextç±»å‹çš„å­—æ®µï¼ˆstringå­—æ®µé»˜è®¤ç±»å‹ä¸ºtextï¼‰ï¼š"></a>å­˜ä¸ºtextç±»å‹çš„å­—æ®µï¼ˆstringå­—æ®µé»˜è®¤ç±»å‹ä¸ºtextï¼‰ï¼š</h4><pre><code>åšåˆ†è¯åå­˜å‚¨å€’æ’ç´¢å¼•ï¼Œæ”¯æŒå…¨æ–‡æ£€ç´¢ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢å‡ ä¸ªå‚æ•°ä¼˜åŒ–å…¶å­˜å‚¨æ–¹å¼ï¼š -  normsï¼šç”¨äºåœ¨æœç´¢æ—¶è®¡ç®—è¯¥docçš„_scoreï¼ˆä»£è¡¨è¿™æ¡æ•°æ®ä¸æœç´¢æ¡ä»¶çš„ç›¸å…³åº¦ï¼‰ï¼Œå¦‚æœä¸éœ€è¦è¯„åˆ†ï¼Œå¯ä»¥å°†å…¶å…³é—­ã€‚ - indexoptionsï¼šæ§åˆ¶å€’æ’ç´¢å¼•ä¸­åŒ…æ‹¬å“ªäº›ä¿¡æ¯ï¼ˆdocsã€freqsã€positionsã€offsetsï¼‰ã€‚å¯¹äºä¸å¤ªæ³¨é‡score/highlightingçš„ä½¿ç”¨åœºæ™¯ï¼Œå¯ä»¥è®¾ä¸º docsæ¥é™ä½å†…å­˜/ç£ç›˜èµ„æºæ¶ˆè€—ã€‚ - fields: ç”¨äºæ·»åŠ å­å­—æ®µã€‚å¯¹äºæœ‰sortå’ŒèšåˆæŸ¥è¯¢éœ€æ±‚çš„åœºæ™¯ï¼Œå¯ä»¥æ·»åŠ ä¸€ä¸ªkeywordå­å­—æ®µä»¥æ”¯æŒè¿™ä¸¤ç§åŠŸèƒ½ã€‚<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">    &#123;</span><br><span class="line">    <span class="attr">&quot;mappings&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;my_type&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;title&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;norms&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;index_options&quot;</span>: <span class="string">&quot;docs&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;fields&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;raw&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;keyword&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ```    </span><br><span class="line">#### å­˜ä¸ºkeywordç±»å‹çš„å­—æ®µ</span><br><span class="line">ä¸åšåˆ†è¯ï¼Œä¸æ”¯æŒå…¨æ–‡æ£€ç´¢ã€‚textåˆ†è¯æ¶ˆè€—CPUèµ„æºï¼Œå†—ä½™å­˜å‚¨keywordå­å­—æ®µå ç”¨å­˜å‚¨ç©ºé—´ã€‚å¦‚æœæ²¡æœ‰å…¨æ–‡ç´¢å¼•éœ€æ±‚ï¼Œåªæ˜¯è¦é€šè¿‡æ•´ä¸ªå­—æ®µåšæœç´¢ï¼Œå¯ä»¥è®¾ç½®è¯¥å­—æ®µçš„ç±»å‹ä¸ºkeywordï¼Œæå‡å†™å…¥é€Ÿç‡ï¼Œé™ä½å­˜å‚¨æˆæœ¬ã€‚ è®¾ç½®å­—æ®µç±»å‹çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼šä¸€æ˜¯åˆ›å»ºä¸€ä¸ªå…·ä½“çš„indexæ—¶ï¼ŒæŒ‡å®šå­—æ®µçš„ç±»å‹ï¼›äºŒæ˜¯é€šè¿‡åˆ›å»ºtemplateï¼Œæ§åˆ¶æŸä¸€ç±»indexçš„å­—æ®µç±»å‹ã€‚</span><br><span class="line"></span><br><span class="line">-  é€šè¿‡mappingæŒ‡å®š tags å­—æ®µä¸ºkeywordç±»å‹</span><br><span class="line">```json</span><br><span class="line">PUT my_index</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;mappings&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;my_type&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;tags&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;keyword&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></code></pre><ul><li> é€šè¿‡templateï¼ŒæŒ‡å®šmy_index*ç±»çš„indexï¼Œå…¶æ‰€æœ‰stringå­—æ®µé»˜è®¤ä¸ºkeywordç±»å‹<br>PUT _template/my_template<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;order&quot;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">&quot;template&quot;</span>: <span class="string">&quot;my_index*&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;mappings&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;_default_&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;dynamic_templates&quot;</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">          <span class="attr">&quot;strings&quot;</span>: &#123;</span><br><span class="line">              <span class="attr">&quot;match_mapping_type&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">              <span class="attr">&quot;mapping&quot;</span>: &#123;</span><br><span class="line">              <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;keyword&quot;</span>,</span><br><span class="line">              <span class="attr">&quot;ignore_above&quot;</span>: <span class="number">256</span></span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      ]</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;aliases&quot;</span>: &#123;</span><br><span class="line">      </span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="æŸ¥è¯¢æ—¶ï¼Œä½¿ç”¨query-bool-filterç»„åˆå–ä»£æ™®é€šquery"><a href="#æŸ¥è¯¢æ—¶ï¼Œä½¿ç”¨query-bool-filterç»„åˆå–ä»£æ™®é€šquery" class="headerlink" title="æŸ¥è¯¢æ—¶ï¼Œä½¿ç”¨query-bool-filterç»„åˆå–ä»£æ™®é€šquery"></a>æŸ¥è¯¢æ—¶ï¼Œä½¿ç”¨query-bool-filterç»„åˆå–ä»£æ™®é€šquery</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒESé€šè¿‡ä¸€å®šçš„ç®—æ³•è®¡ç®—è¿”å›çš„æ¯æ¡æ•°æ®ä¸æŸ¥è¯¢è¯­å¥çš„ç›¸å…³åº¦ï¼Œå¹¶é€šè¿‡scoreå­—æ®µæ¥è¡¨å¾ã€‚ä½†å¯¹äºéå…¨æ–‡ç´¢å¼•çš„ä½¿ç”¨åœºæ™¯ï¼Œç”¨æˆ·å¹¶ä¸careæŸ¥è¯¢ç»“æœä¸æŸ¥è¯¢æ¡ä»¶çš„ç›¸å…³åº¦ï¼Œåªæ˜¯æƒ³ç²¾ç¡®çš„æŸ¥æ‰¾ç›®æ ‡æ•°æ®ã€‚æ­¤æ—¶ï¼Œå¯ä»¥é€šè¿‡query-bool-filterç»„åˆæ¥è®©ESä¸è®¡ç®—scoreï¼Œå¹¶ä¸”å°½å¯èƒ½çš„ç¼“å­˜filterçš„ç»“æœé›†ï¼Œä¾›åç»­åŒ…å«ç›¸åŒfilterçš„æŸ¥è¯¢ä½¿ç”¨ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚</p><ul><li>æ™®é€šæŸ¥è¯¢<br><code>POST my_index/_search&#123;  &quot;query&quot;: &#123;    &quot;term&quot; : &#123; &quot;user&quot; : &quot;Kimchy&quot; &#125;   &#125;&#125;</code></li><li>query-bool-filter åŠ é€ŸæŸ¥è¯¢<br><code>POST my_index/_search&#123;  &quot;query&quot;: &#123;    &quot;bool&quot;: &#123;      &quot;filter&quot;: &#123;        &quot;term&quot;: &#123; &quot;user&quot;: &quot;Kimchy&quot; &#125;      &#125;    &#125;  &#125;&#125;</code></li></ul><h3 id="indexæŒ‰æ—¥æœŸæ»šåŠ¨ï¼Œä¾¿äºç®¡ç†"><a href="#indexæŒ‰æ—¥æœŸæ»šåŠ¨ï¼Œä¾¿äºç®¡ç†" class="headerlink" title="indexæŒ‰æ—¥æœŸæ»šåŠ¨ï¼Œä¾¿äºç®¡ç†"></a>indexæŒ‰æ—¥æœŸæ»šåŠ¨ï¼Œä¾¿äºç®¡ç†</h3><p>å†™å…¥ESçš„æ•°æ®æœ€å¥½é€šè¿‡æŸç§æ–¹å¼åšåˆ†å‰²ï¼Œå­˜å…¥ä¸åŒçš„indexã€‚<br>å¸¸è§çš„åšæ³•æ˜¯å°†æ•°æ®æŒ‰æ¨¡å—/åŠŸèƒ½åˆ†ç±»ï¼Œå†™å…¥ä¸åŒçš„indexï¼Œç„¶åæŒ‰ç…§æ—¶é—´å»æ»šåŠ¨ç”Ÿæˆindexã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯å„ç§æ•°æ®åˆ†å¼€ç®¡ç†ä¸ä¼šæ··æ·†ï¼Œä¹Ÿæ˜“äºæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚<code>åŒæ—¶indexæŒ‰æ—¶é—´æ»šåŠ¨ï¼Œæ•°æ®è¿‡æœŸæ—¶åˆ é™¤æ•´ä¸ªindexï¼Œè¦æ¯”ä¸€æ¡æ¡åˆ é™¤æ•°æ®æˆ–deletebyqueryæ•ˆç‡é«˜å¾ˆå¤š</code>ï¼Œå› ä¸ºåˆ é™¤æ•´ä¸ªindexæ˜¯ç›´æ¥åˆ é™¤åº•å±‚æ–‡ä»¶ï¼Œè€Œdeletebyqueryæ˜¯æŸ¥è¯¢-æ ‡è®°-åˆ é™¤ã€‚</p><p>ä¸¾ä¾‹è¯´æ˜ï¼Œå‡å¦‚æœ‰[modulea,moduleb]ä¸¤ä¸ªæ¨¡å—äº§ç”Ÿçš„æ•°æ®ï¼Œé‚£ä¹ˆindexè§„åˆ’å¯ä»¥æ˜¯è¿™æ ·çš„ï¼šä¸€ç±»indexåç§°æ˜¯modulea + {æ—¥æœŸ}ï¼Œå¦ä¸€ç±»indexåç§°æ˜¯module_b+ {æ—¥æœŸ}ã€‚å¯¹äºåå­—ä¸­çš„æ—¥æœŸï¼Œå¯ä»¥åœ¨å†™å…¥æ•°æ®æ—¶è‡ªå·±æŒ‡å®šç²¾ç¡®çš„æ—¥æœŸï¼Œä¹Ÿå¯ä»¥é€šè¿‡ESçš„ingest pipelineä¸­çš„index-name-processorå®ç°ï¼ˆä¼šæœ‰å†™å…¥æ€§èƒ½æŸè€—ï¼‰ã€‚</p><h3 id="æŒ‰éœ€æ§åˆ¶indexçš„åˆ†ç‰‡æ•°å’Œå‰¯æœ¬æ•°"><a href="#æŒ‰éœ€æ§åˆ¶indexçš„åˆ†ç‰‡æ•°å’Œå‰¯æœ¬æ•°" class="headerlink" title="æŒ‰éœ€æ§åˆ¶indexçš„åˆ†ç‰‡æ•°å’Œå‰¯æœ¬æ•°"></a>æŒ‰éœ€æ§åˆ¶indexçš„åˆ†ç‰‡æ•°å’Œå‰¯æœ¬æ•°</h3><p>åˆ†ç‰‡ï¼ˆshardï¼‰ï¼šä¸€ä¸ªESçš„indexç”±å¤šä¸ªshardç»„æˆï¼Œæ¯ä¸ªshardæ‰¿è½½indexçš„ä¸€éƒ¨åˆ†æ•°æ®ã€‚</p><p>å‰¯æœ¬ï¼ˆreplicaï¼‰ï¼šindexä¹Ÿå¯ä»¥è®¾å®šå‰¯æœ¬æ•°ï¼ˆnumberofreplicasï¼‰ï¼Œä¹Ÿå°±æ˜¯åŒä¸€ä¸ªshardæœ‰å¤šå°‘ä¸ªå¤‡ä»½ã€‚å¯¹äºæŸ¥è¯¢å‹åŠ›è¾ƒå¤§çš„indexï¼Œå¯ä»¥è€ƒè™‘æé«˜å‰¯æœ¬æ•°ï¼ˆnumberofreplicasï¼‰ï¼Œé€šè¿‡å¤šä¸ªå‰¯æœ¬å‡æ‘ŠæŸ¥è¯¢å‹åŠ›ã€‚</p><p>shardæ•°é‡ï¼ˆnumberofshardsï¼‰è®¾ç½®è¿‡å¤šæˆ–è¿‡ä½éƒ½ä¼šå¼•å‘ä¸€äº›é—®é¢˜ï¼šshardæ•°é‡è¿‡å¤šï¼Œåˆ™æ‰¹é‡å†™å…¥/æŸ¥è¯¢è¯·æ±‚è¢«åˆ†å‰²ä¸ºè¿‡å¤šçš„å­å†™å…¥/æŸ¥è¯¢ï¼Œå¯¼è‡´è¯¥indexçš„å†™å…¥ã€æŸ¥è¯¢æ‹’ç»ç‡ä¸Šå‡ï¼›å¯¹äºæ•°æ®é‡è¾ƒå¤§çš„inexï¼Œå½“å…¶shardæ•°é‡è¿‡å°æ—¶ï¼Œæ— æ³•å……åˆ†åˆ©ç”¨èŠ‚ç‚¹èµ„æºï¼Œé€ æˆæœºå™¨èµ„æºåˆ©ç”¨ç‡ä¸é«˜ æˆ– ä¸å‡è¡¡ï¼Œå½±å“å†™å…¥/æŸ¥è¯¢çš„æ•ˆç‡ã€‚</p><p>å¯¹äºæ¯ä¸ªindexçš„shardæ•°é‡ï¼Œå¯ä»¥æ ¹æ®æ•°æ®æ€»é‡ã€å†™å…¥å‹åŠ›ã€èŠ‚ç‚¹æ•°é‡ç­‰ç»¼åˆè€ƒé‡åè®¾å®šï¼Œç„¶åæ ¹æ®æ•°æ®å¢é•¿çŠ¶æ€å®šæœŸæ£€æµ‹ä¸‹shardæ•°é‡æ˜¯å¦åˆç†ã€‚åŸºç¡€æ¶æ„éƒ¨æ•°æ®åº“å›¢é˜Ÿçš„æ¨èæ–¹æ¡ˆæ˜¯ï¼š</p><p>å¯¹äºæ•°æ®é‡è¾ƒå°ï¼ˆ100GBä»¥ä¸‹ï¼‰çš„indexï¼Œå¾€å¾€å†™å…¥å‹åŠ›æŸ¥è¯¢å‹åŠ›ç›¸å¯¹è¾ƒä½ï¼Œä¸€èˆ¬è®¾ç½®3<del>5ä¸ªshardï¼Œnumberofreplicasè®¾ç½®ä¸º1å³å¯ï¼ˆä¹Ÿå°±æ˜¯ä¸€ä¸»ä¸€ä»ï¼Œå…±ä¸¤å‰¯æœ¬ï¼‰ ã€‚<br>å¯¹äºæ•°æ®é‡è¾ƒå¤§ï¼ˆ100GBä»¥ä¸Šï¼‰çš„indexï¼š<br>ä¸€èˆ¬æŠŠå•ä¸ªshardçš„æ•°æ®é‡æ§åˆ¶åœ¨ï¼ˆ20GB</del>50GBï¼‰<br>è®©indexå‹åŠ›åˆ†æ‘Šè‡³å¤šä¸ªèŠ‚ç‚¹ï¼šå¯é€šè¿‡index.routing.allocation.totalshardsper_nodeå‚æ•°ï¼Œå¼ºåˆ¶é™å®šä¸€ä¸ªèŠ‚ç‚¹ä¸Šè¯¥indexçš„shardæ•°é‡ï¼Œè®©shardå°½é‡åˆ†é…åˆ°ä¸åŒèŠ‚ç‚¹ä¸Š<br>ç»¼åˆè€ƒè™‘æ•´ä¸ªindexçš„shardæ•°é‡ï¼Œå¦‚æœshardæ•°é‡ï¼ˆä¸åŒ…æ‹¬å‰¯æœ¬ï¼‰è¶…è¿‡50ä¸ªï¼Œå°±å¾ˆå¯èƒ½å¼•å‘æ‹’ç»ç‡ä¸Šå‡çš„é—®é¢˜ï¼Œæ­¤æ—¶å¯è€ƒè™‘æŠŠè¯¥indexæ‹†åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹çš„indexï¼Œåˆ†æ‘Šæ•°æ®é‡ï¼ŒåŒæ—¶é…åˆroutingä½¿ç”¨ï¼Œé™ä½æ¯ä¸ªæŸ¥è¯¢éœ€è¦è®¿é—®çš„shardæ•°é‡ã€‚</p><blockquote><p><a href="https://zhuanlan.zhihu.com/p/43437056">Elasticsearchæ€§èƒ½ä¼˜åŒ–æ€»ç»“</a><br><a href="https://cloud.tencent.com/developer/article/1158408">Elasticsearchè°ƒä¼˜å®è·µ</a></p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;ä»æ€§èƒ½å’Œç¨³å®šæ€§ä¸¤æ–¹é¢ï¼Œä»linuxå‚æ•°è°ƒä¼˜ã€ESèŠ‚ç‚¹é…ç½®å’ŒESä½¿ç”¨æ–¹å¼ä¸‰ä¸ªè§’åº¦å…¥æ‰‹ï¼Œä»‹ç»ESè°ƒä¼˜çš„åŸºæœ¬æ–¹æ¡ˆã€‚å½“ç„¶ï¼ŒESçš„è°ƒä¼˜ç»ä¸èƒ½ä¸€æ¦‚è€Œè®ºï¼Œéœ€è¦æ ¹æ®å®é™…ä¸šåŠ¡åœºæ™¯åšé€‚å½“çš„å–èˆå’Œè°ƒæ•´&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;Linuxä¼˜åŒ–&quot;</summary>
      
    
    
    
    <category term="Elasticsearch" scheme="http://example.com/categories/Elasticsearch/"/>
    
    <category term="Administration and Deployment" scheme="http://example.com/categories/Elasticsearch/Administration-and-Deployment/"/>
    
    
    <category term="elasticsearch" scheme="http://example.com/tags/elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>ä¿®æ”¹mysqlè¡¨åˆ›å»ºæ—¶é—´</title>
    <link href="http://example.com/wiki/%E4%BF%AE%E6%94%B9mysql%E8%A1%A8%E5%88%9B%E5%BB%BA%E6%97%B6%E9%97%B4/"/>
    <id>http://example.com/wiki/%E4%BF%AE%E6%94%B9mysql%E8%A1%A8%E5%88%9B%E5%BB%BA%E6%97%B6%E9%97%B4/</id>
    <published>2021-07-14T13:42:53.000Z</published>
    <updated>2021-07-14T14:42:16.536Z</updated>
    
    <content type="html"><![CDATA[<ul><li><p>ä¿®æ”¹æœåŠ¡å™¨æ—¶é—´<br><code>date -s &quot;2021-07-14 21:22:10&quot;</code></p></li><li><p>æ‰§è¡ŒDDL<br><code>alter table mirror_user comment &#39;ç”¨æˆ·è¡¨&#39;;</code></p></li><li><p>æœåŠ¡å™¨æ—¶é—´ä¿®æ­£<br><code>ntpdate ntp1.aliyun.com</code></p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;ä¿®æ”¹æœåŠ¡å™¨æ—¶é—´&lt;br&gt;&lt;code&gt;date -s &amp;quot;2021-07-14 21:22:10&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ‰§è¡ŒDDL&lt;br&gt;&lt;code&gt;alter table mirror_user comment </summary>
      
    
    
    
    <category term="DataBase" scheme="http://example.com/categories/DataBase/"/>
    
    <category term="MySQL" scheme="http://example.com/categories/DataBase/MySQL/"/>
    
    
    <category term="MySQL" scheme="http://example.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>hutoolå¯¼å‡ºexcel</title>
    <link href="http://example.com/wiki/hutool%E5%AF%BC%E5%87%BAexcel/"/>
    <id>http://example.com/wiki/hutool%E5%AF%BC%E5%87%BAexcel/</id>
    <published>2021-07-14T13:01:13.000Z</published>
    <updated>2021-07-14T13:42:15.674Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å¦‚æœä½ ä»…éœ€ä¸€ä¸ªJavaå¯¼å‡ºexcelçš„å·¥å…·ï¼ŒğŸ‘‡å°±å¯ä»¥æ»¡è¶³ä½ çš„ä¸´æ—¶éœ€æ±‚ï¼Œå½“ç„¶ä»£ç ä¸‹é¢è¿™ä¹ˆå†™è‚¯å®šæ˜¯ä¸è§„èŒƒçš„ï¼Œå¯ä»¥ç¨åå®Œå–„ï¼</p></blockquote><h2 id="æ·»åŠ ä¾èµ–"><a href="#æ·»åŠ ä¾èµ–" class="headerlink" title="æ·»åŠ ä¾èµ–"></a>æ·»åŠ ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/cn.hutool/hutool-all --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.7.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.poi/poi-ooxml --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.poi/poi-ooxml --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="æ•°æ®ç±»"><a href="#æ•°æ®ç±»" class="headerlink" title="æ•°æ®ç±»"></a>æ•°æ®ç±»</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Builder</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IPData</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String ip;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Exportæ–¹æ³•ç¤ºä¾‹"><a href="#Exportæ–¹æ³•ç¤ºä¾‹" class="headerlink" title="Exportæ–¹æ³•ç¤ºä¾‹"></a>Exportæ–¹æ³•ç¤ºä¾‹</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">export</span><span class="params">(List&lt;IPData&gt; rows)</span> <span class="keyword">throws</span> FileNotFoundException </span>&#123;</span><br><span class="line">       ExcelWriter writer = ExcelUtil.getWriter(<span class="keyword">true</span>);</span><br><span class="line">       writer.renameSheet(<span class="string">&quot;æ‰€æœ‰æ•°æ®&quot;</span>);     <span class="comment">//ç”šè‡³sheetçš„åç§°</span></span><br><span class="line">       writer.addHeaderAlias(<span class="string">&quot;ip&quot;</span>, <span class="string">&quot;IP&quot;</span>);</span><br><span class="line">       writer.write(rows, <span class="keyword">true</span>);</span><br><span class="line">       writer.setOnlyAlias(<span class="keyword">true</span>);</span><br><span class="line">       FileOutputStream fileOutputStream = <span class="keyword">new</span> FileOutputStream(<span class="string">&quot;/Users/gaolei/Desktop/IP1.xlsx&quot;</span>);</span><br><span class="line">       writer.flush(fileOutputStream);</span><br><span class="line">       writer.close();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å¦‚æœä½ ä»…éœ€ä¸€ä¸ªJavaå¯¼å‡ºexcelçš„å·¥å…·ï¼ŒğŸ‘‡å°±å¯ä»¥æ»¡è¶³ä½ çš„ä¸´æ—¶éœ€æ±‚ï¼Œå½“ç„¶ä»£ç ä¸‹é¢è¿™ä¹ˆå†™è‚¯å®šæ˜¯ä¸è§„èŒƒçš„ï¼Œå¯ä»¥ç¨åå®Œå–„ï¼&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;æ·»åŠ ä¾èµ–&quot;&gt;&lt;a href=&quot;#æ·»åŠ ä¾èµ–&quot; class=&quot;headerli</summary>
      
    
    
    
    <category term="Develop Lan" scheme="http://example.com/categories/Develop-Lan/"/>
    
    <category term="Java" scheme="http://example.com/categories/Develop-Lan/Java/"/>
    
    
    <category term="excel" scheme="http://example.com/tags/excel/"/>
    
  </entry>
  
  <entry>
    <title>gitå¸¸ç”¨å‘½ä»¤</title>
    <link href="http://example.com/wiki/git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
    <id>http://example.com/wiki/git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</id>
    <published>2021-07-14T01:55:55.000Z</published>
    <updated>2021-07-14T02:18:58.306Z</updated>
    
    <content type="html"><![CDATA[<h2 id="åˆå§‹åŒ–æœ¬åœ°ä»“åº“"><a href="#åˆå§‹åŒ–æœ¬åœ°ä»“åº“" class="headerlink" title="åˆå§‹åŒ–æœ¬åœ°ä»“åº“"></a>åˆå§‹åŒ–æœ¬åœ°ä»“åº“</h2><p><code>git init </code><br><code>git add .</code><br><code>git commit -m &lt;message&gt;</code><br><code>git remote add &lt;name&gt; &lt;url&gt;</code><br><code>git push</code><br><code>git push &lt;name&gt;</code><br><code>git push --set-upstream &lt;name&gt; &lt;branch&gt;</code></p><h2 id="æ‰¹é‡åˆ é™¤åˆ†æ”¯"><a href="#æ‰¹é‡åˆ é™¤åˆ†æ”¯" class="headerlink" title="æ‰¹é‡åˆ é™¤åˆ†æ”¯"></a>æ‰¹é‡åˆ é™¤åˆ†æ”¯</h2><p>è¿œç¨‹ï¼š<code>git branch -r| grep &#39;ss-1&#39; | sed &#39;s/origin\///g&#39; | xargs -I &#123;&#125; git push origin :&#123;&#125;</code><br>æœ¬åœ°ï¼š<code>git branch -a | grep &#39;feature-re-1&#39; | xargs git branch -D</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;åˆå§‹åŒ–æœ¬åœ°ä»“åº“&quot;&gt;&lt;a href=&quot;#åˆå§‹åŒ–æœ¬åœ°ä»“åº“&quot; class=&quot;headerlink&quot; title=&quot;åˆå§‹åŒ–æœ¬åœ°ä»“åº“&quot;&gt;&lt;/a&gt;åˆå§‹åŒ–æœ¬åœ°ä»“åº“&lt;/h2&gt;&lt;p&gt;&lt;code&gt;git init &lt;/code&gt;&lt;br&gt;&lt;code&gt;git add .&lt;/code&gt;&lt;b</summary>
      
    
    
    
    <category term="Develop Tools" scheme="http://example.com/categories/Develop-Tools/"/>
    
    <category term="Git" scheme="http://example.com/categories/Develop-Tools/Git/"/>
    
    
    <category term="git" scheme="http://example.com/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>Linuxå¸¸ç”¨å‘½ä»¤</title>
    <link href="http://example.com/wiki/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
    <id>http://example.com/wiki/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</id>
    <published>2021-07-13T03:44:22.000Z</published>
    <updated>2021-07-15T02:54:42.268Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç”¨æˆ·ç›¸å…³"><a href="#ç”¨æˆ·ç›¸å…³" class="headerlink" title="ç”¨æˆ·ç›¸å…³"></a>ç”¨æˆ·ç›¸å…³</h2><h2 id="æ–‡ä»¶ç›¸å…³"><a href="#æ–‡ä»¶ç›¸å…³" class="headerlink" title="æ–‡ä»¶ç›¸å…³"></a>æ–‡ä»¶ç›¸å…³</h2><h2 id="æ—¥å¿—ç›¸å…³"><a href="#æ—¥å¿—ç›¸å…³" class="headerlink" title="æ—¥å¿—ç›¸å…³"></a>æ—¥å¿—ç›¸å…³</h2><ul><li><p>linux åœ¨æ–‡æ¡£ä¸­æŸ¥æ‰¾å…³é”®å­—ä¸ªæ•°<br><code>grep -o â€œå…³é”®å­—â€ æ–‡æ¡£å | wc -l </code><br><code>grep -o â€œå…³é”®å­—â€ æ–‡æ¡£å | sort | uniq -c</code></p></li><li><p>æ¸…é™¤historyè®°å½•<br><code>vim .bash_history</code><br>å‘½ä»¤æ¨¡å¼ä¸‹ï¼ˆEscä¹‹åè¾“å…¥:ï¼‰ è¾“å…¥ set nu æ¯è¡Œæ•°æ®å‰é¢æ˜¾ç¤ºè¡Œå·<br><code>11,20d</code> å›è½¦ 11ï½20è¡Œçš„è®°å½•å°±è¢«åˆ é™¤äº†<br>ç„¶åå‘½ä»¤æ¨¡å¼ä¸‹ wq ä¿å­˜é€€å‡ºå°±å¯ä»¥äº†<br>å¦‚æœåœ¨æ­¤æŸ¥çœ‹è¿˜æ˜¯æœ‰è®°å½•ï¼Œå¯ä»¥é€€å‡ºå½“å‰å›è¯ä¹‹åï¼Œå†è¿›å»æŸ¥çœ‹ï¼Œå°±ä¼šä¸å†æ˜¾ç¤ºåˆ é™¤çš„è®°å½•äº†</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ç”¨æˆ·ç›¸å…³&quot;&gt;&lt;a href=&quot;#ç”¨æˆ·ç›¸å…³&quot; class=&quot;headerlink&quot; title=&quot;ç”¨æˆ·ç›¸å…³&quot;&gt;&lt;/a&gt;ç”¨æˆ·ç›¸å…³&lt;/h2&gt;&lt;h2 id=&quot;æ–‡ä»¶ç›¸å…³&quot;&gt;&lt;a href=&quot;#æ–‡ä»¶ç›¸å…³&quot; class=&quot;headerlink&quot; title=&quot;æ–‡ä»¶ç›¸å…³&quot;&gt;&lt;/a</summary>
      
    
    
    
    <category term="Linux System" scheme="http://example.com/categories/Linux-System/"/>
    
    <category term="Common commands" scheme="http://example.com/categories/Linux-System/Common-commands/"/>
    
    
    <category term="linux" scheme="http://example.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>æ®µåˆå¹¶</title>
    <link href="http://example.com/wiki/%E6%AE%B5%E5%90%88%E5%B9%B6/"/>
    <id>http://example.com/wiki/%E6%AE%B5%E5%90%88%E5%B9%B6/</id>
    <published>2021-07-08T12:57:54.000Z</published>
    <updated>2021-07-08T13:37:17.283Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><blockquote><ul><li><a href="https://learnku.com/articles/41593">learnku.com</a></li></ul></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‚è€ƒèµ„æ–™&quot;&gt;&lt;a href=&quot;#å‚è€ƒèµ„æ–™&quot; class=&quot;headerlink&quot; title=&quot;å‚è€ƒèµ„æ–™&quot;&gt;&lt;/a&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://learnku.com/articles/41593</summary>
      
    
    
    
    <category term="Elasticsearch" scheme="http://example.com/categories/Elasticsearch/"/>
    
    <category term="Getting Started" scheme="http://example.com/categories/Elasticsearch/Getting-Started/"/>
    
    
    <category term="elasticsearch" scheme="http://example.com/tags/elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>ç»Ÿè®¡å»é‡æ•°æ® (è¿‘ä¼¼åº¦é‡)</title>
    <link href="http://example.com/wiki/%E7%BB%9F%E8%AE%A1%E5%8E%BB%E9%87%8D%E6%95%B0%E6%8D%AE/"/>
    <id>http://example.com/wiki/%E7%BB%9F%E8%AE%A1%E5%8E%BB%E9%87%8D%E6%95%B0%E6%8D%AE/</id>
    <published>2021-07-08T08:09:05.000Z</published>
    <updated>2021-07-08T13:21:20.095Z</updated>
    
    <content type="html"><![CDATA[<h2 id="cardinalityç”¨æ³•"><a href="#cardinalityç”¨æ³•" class="headerlink" title="cardinalityç”¨æ³•"></a>cardinalityç”¨æ³•</h2><p>å¸¸ç”¨å†™æ³•å¦‚ä¸‹ğŸ‘‡<br><code>curl -X GET &quot;localhost:9200/cars/transactions/_search?pretty&quot; -H &#39;Content-Type: application/json&#39; -d&#39;</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;size&quot;</span> : <span class="number">0</span>,</span><br><span class="line">  <span class="attr">&quot;aggs&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;months&quot;</span> : &#123;</span><br><span class="line">        <span class="attr">&quot;date_histogram&quot;</span>: &#123;</span><br><span class="line">          <span class="attr">&quot;field&quot;</span>: <span class="string">&quot;sold&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;interval&quot;</span>: <span class="string">&quot;month&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;aggs&quot;</span>: &#123;</span><br><span class="line">          <span class="attr">&quot;distinct_colors&quot;</span> : &#123;</span><br><span class="line">              <span class="attr">&quot;cardinality&quot;</span> : &#123;</span><br><span class="line">                <span class="attr">&quot;field&quot;</span> : <span class="string">&quot;color&quot;</span></span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç²¾åº¦é—®é¢˜"><a href="#ç²¾åº¦é—®é¢˜" class="headerlink" title="ç²¾åº¦é—®é¢˜"></a>ç²¾åº¦é—®é¢˜</h2><p><code>cardinality</code> åº¦é‡æ˜¯ä¸€ä¸ª <code>è¿‘ä¼¼ç®—æ³•</code>ã€‚ å®ƒæ˜¯åŸºäº HyperLogLog++ ï¼ˆHLLï¼‰ç®—æ³•çš„ã€‚ HLL ä¼šå…ˆå¯¹æˆ‘ä»¬çš„è¾“å…¥ä½œå“ˆå¸Œè¿ç®—ï¼Œç„¶åæ ¹æ®å“ˆå¸Œè¿ç®—çš„ç»“æœä¸­çš„ bits åšæ¦‚ç‡ä¼°ç®—ä»è€Œå¾—åˆ°åŸºæ•°ã€‚</p><p>æˆ‘ä»¬ä¸éœ€è¦ç†è§£æŠ€æœ¯ç»†èŠ‚ï¼Œ ä½†æˆ‘ä»¬æœ€å¥½åº”è¯¥å…³æ³¨ä¸€ä¸‹è¿™ä¸ªç®—æ³•çš„ ç‰¹æ€§ ï¼š</p><ul><li>å¯é…ç½®çš„ç²¾åº¦ï¼Œç”¨æ¥æ§åˆ¶å†…å­˜çš„ä½¿ç”¨ï¼ˆæ›´ç²¾ç¡® ï¼ æ›´å¤šå†…å­˜ï¼‰ã€‚</li><li>å°çš„æ•°æ®é›†ç²¾åº¦æ˜¯éå¸¸é«˜çš„ã€‚</li><li>æˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®å‚æ•°ï¼Œæ¥è®¾ç½®å»é‡éœ€è¦çš„å›ºå®šå†…å­˜ä½¿ç”¨é‡ã€‚æ— è®ºæ•°åƒè¿˜æ˜¯æ•°åäº¿çš„å”¯ä¸€å€¼ï¼Œå†…å­˜ä½¿ç”¨é‡åªä¸ä½ é…ç½®çš„ç²¾ç¡®åº¦ç›¸å…³ã€‚</li></ul><p>è¦é…ç½®ç²¾åº¦ï¼Œæˆ‘ä»¬å¿…é¡»æŒ‡å®š <code>precision_threshold</code> å‚æ•°çš„å€¼ã€‚ è¿™ä¸ªé˜ˆå€¼å®šä¹‰äº†åœ¨ä½•ç§åŸºæ•°æ°´å¹³ä¸‹æˆ‘ä»¬å¸Œæœ›å¾—åˆ°ä¸€ä¸ªè¿‘ä¹ç²¾ç¡®çš„ç»“æœã€‚å‚è€ƒä»¥ä¸‹ç¤ºä¾‹ï¼š</p><p><code>curl -X GET &quot;localhost:9200/cars/transactions/_search?pretty&quot; -H &#39;Content-Type: application/json&#39; -d&#39;</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;size&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;aggs&quot;</span> : &#123;</span><br><span class="line">        <span class="attr">&quot;distinct_colors&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;cardinality&quot;</span> : &#123;</span><br><span class="line">              <span class="attr">&quot;field&quot;</span> : <span class="string">&quot;color&quot;</span>,</span><br><span class="line">              <span class="attr">&quot;precision_threshold&quot;</span> : <span class="number">100</span> </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>âš ï¸ âš ï¸<br><code>precision_threshold</code> æ¥å— 0â€“40000 ä¹‹é—´çš„æ•°å­—ï¼Œæ›´å¤§çš„å€¼è¿˜æ˜¯ä¼šè¢«å½“ä½œ 40000 æ¥å¤„ç† </p><p>ç¤ºä¾‹ä¼šç¡®ä¿å½“å­—æ®µå”¯ä¸€å€¼åœ¨ 100 ä»¥å†…æ—¶ä¼šå¾—åˆ°éå¸¸å‡†ç¡®çš„ç»“æœã€‚å°½ç®¡ç®—æ³•æ˜¯æ— æ³•ä¿è¯è¿™ç‚¹çš„ï¼Œä½†å¦‚æœåŸºæ•°åœ¨é˜ˆå€¼ä»¥ä¸‹ï¼Œå‡ ä¹æ€»æ˜¯ 100% æ­£ç¡®çš„ã€‚é«˜äºé˜ˆå€¼çš„åŸºæ•°ä¼šå¼€å§‹èŠ‚çœå†…å­˜è€Œç‰ºç‰²å‡†ç¡®åº¦ï¼ŒåŒæ—¶ä¹Ÿä¼šå¯¹åº¦é‡ç»“æœå¸¦å…¥è¯¯å·®ã€‚</p><p>å¯¹äºæŒ‡å®šçš„é˜ˆå€¼ï¼Œ<code>HLL</code> çš„æ•°æ®ç»“æ„ä¼šå¤§æ¦‚ä½¿ç”¨ <code>precision_threshold</code> * 8 å­—èŠ‚çš„å†…å­˜ï¼Œæ‰€ä»¥å°±å¿…é¡»åœ¨ç‰ºç‰²å†…å­˜å’Œè·å¾—é¢å¤–çš„å‡†ç¡®åº¦é—´åšå¹³è¡¡ã€‚</p><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œ 100 çš„é˜ˆå€¼å¯ä»¥åœ¨å”¯ä¸€å€¼ä¸ºç™¾ä¸‡çš„æƒ…å†µä¸‹ä»ç„¶å°†è¯¯å·®ç»´æŒ 5% ä»¥å†…</p><h2 id="é€Ÿåº¦é—®é¢˜"><a href="#é€Ÿåº¦é—®é¢˜" class="headerlink" title="é€Ÿåº¦é—®é¢˜"></a>é€Ÿåº¦é—®é¢˜</h2><p>å¦‚æœæƒ³è¦è·å¾—å”¯ä¸€å€¼çš„æ•°ç›®ï¼Œ é€šå¸¸ éœ€è¦æŸ¥è¯¢æ•´ä¸ªæ•°æ®é›†åˆï¼ˆæˆ–å‡ ä¹æ‰€æœ‰æ•°æ®ï¼‰ã€‚ æ‰€æœ‰åŸºäºæ‰€æœ‰æ•°æ®çš„æ“ä½œéƒ½å¿…é¡»è¿…é€Ÿï¼ŒåŸå› æ˜¯æ˜¾ç„¶çš„ã€‚ <code>HyperLogLog</code> çš„é€Ÿåº¦å·²ç»å¾ˆå¿«äº†ï¼Œå®ƒåªæ˜¯ç®€å•çš„å¯¹æ•°æ®åšå“ˆå¸Œä»¥åŠä¸€äº›ä½æ“ä½œã€‚</p><p>ä½†å¦‚æœé€Ÿåº¦å¯¹æˆ‘ä»¬è‡³å…³é‡è¦ï¼Œå¯ä»¥åšè¿›ä¸€æ­¥çš„ä¼˜åŒ–ã€‚ å› ä¸º HLL åªéœ€è¦å­—æ®µå†…å®¹çš„å“ˆå¸Œå€¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç´¢å¼•æ—¶å°±é¢„å…ˆè®¡ç®—å¥½ã€‚ å°±èƒ½åœ¨æŸ¥è¯¢æ—¶è·³è¿‡å“ˆå¸Œè®¡ç®—ç„¶åå°†å“ˆå¸Œå€¼ä» <code>fielddata</code> ç›´æ¥åŠ è½½å‡ºæ¥ã€‚</p><blockquote><p>é¢„å…ˆè®¡ç®—å“ˆå¸Œå€¼åªå¯¹å†…å®¹å¾ˆé•¿æˆ–è€…åŸºæ•°å¾ˆé«˜çš„å­—æ®µæœ‰ç”¨ï¼Œè®¡ç®—è¿™äº›å­—æ®µçš„å“ˆå¸Œå€¼çš„æ¶ˆè€—åœ¨æŸ¥è¯¢æ—¶æ˜¯æ— æ³•å¿½ç•¥çš„ã€‚<br>  å°½ç®¡æ•°å€¼å­—æ®µçš„å“ˆå¸Œè®¡ç®—æ˜¯éå¸¸å¿«é€Ÿçš„ï¼Œå­˜å‚¨å®ƒä»¬çš„åŸå§‹å€¼é€šå¸¸éœ€è¦åŒæ ·ï¼ˆæˆ–æ›´å°‘ï¼‰çš„å†…å­˜ç©ºé—´ã€‚è¿™å¯¹ä½åŸºæ•°çš„å­—ç¬¦ä¸²å­—æ®µåŒæ ·é€‚ç”¨ï¼ŒElasticsearch çš„å†…éƒ¨ä¼˜åŒ–èƒ½å¤Ÿä¿è¯æ¯ä¸ªå”¯ä¸€å€¼åªè®¡ç®—ä¸€æ¬¡å“ˆå¸Œã€‚<br>  åŸºæœ¬ä¸Šè¯´ï¼Œé¢„å…ˆè®¡ç®—å¹¶ä¸èƒ½ä¿è¯æ‰€æœ‰çš„å­—æ®µéƒ½æ›´å¿«ï¼Œå®ƒåªå¯¹é‚£äº›å…·æœ‰é«˜åŸºæ•°å’Œ/æˆ–è€…å†…å®¹å¾ˆé•¿çš„å­—ç¬¦ä¸²å­—æ®µæœ‰ä½œç”¨ã€‚éœ€è¦è®°ä½çš„æ˜¯ï¼Œé¢„è®¡ç®—åªæ˜¯ç®€å•çš„å°†æŸ¥è¯¢æ¶ˆè€—çš„æ—¶é—´æå‰è½¬ç§»åˆ°ç´¢å¼•æ—¶ï¼Œå¹¶éæ²¡æœ‰ä»»ä½•ä»£ä»·ï¼ŒåŒºåˆ«åœ¨äºä½ å¯ä»¥é€‰æ‹©åœ¨ ä»€ä¹ˆæ—¶å€™ åšè¿™ä»¶äº‹ï¼Œè¦ä¹ˆåœ¨ç´¢å¼•æ—¶ï¼Œè¦ä¹ˆåœ¨æŸ¥è¯¢æ—¶ã€‚</p></blockquote><p>åˆ›å»ºç´¢å¼•æ—¶æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">PUT /cars/</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;mappings&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;transactions&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;color&quot;</span>: &#123;</span><br><span class="line">          <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;fields&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;hash&quot;</span>: &#123;</span><br><span class="line">              <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;murmur3&quot;</span> </span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å¤šå€¼å­—æ®µçš„ç±»å‹æ˜¯ <code>murmur3</code> ï¼Œè¿™æ˜¯ä¸€ä¸ªå“ˆå¸Œå‡½æ•°ã€‚</p></blockquote><p>ç°åœ¨å½“æˆ‘ä»¬æ‰§è¡Œèšåˆæ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>color.hash</code> å­—æ®µè€Œä¸æ˜¯ color å­—æ®µï¼š<br><code>curl -X GET &quot;localhost:9200/cars/transactions/_search?pretty&quot; -H &#39;Content-Type: application/json&#39; -d&#39;</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;size&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;aggs&quot;</span> : &#123;</span><br><span class="line">        <span class="attr">&quot;distinct_colors&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;cardinality&quot;</span> : &#123;</span><br><span class="line">              <span class="attr">&quot;field&quot;</span> : <span class="string">&quot;color.hash&quot;</span> </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨ <code>cardinality</code> åº¦é‡ä¼šè¯»å– â€œ<code>color.hash</code>â€œ é‡Œçš„å€¼ï¼ˆé¢„å…ˆè®¡ç®—çš„å“ˆå¸Œå€¼ï¼‰ï¼Œå–ä»£åŠ¨æ€è®¡ç®—åŸå§‹å€¼çš„å“ˆå¸Œã€‚</p><p>å•ä¸ªæ–‡æ¡£èŠ‚çœçš„æ—¶é—´æ˜¯éå¸¸å°‘çš„ï¼Œä½†æ˜¯å¦‚æœä½ èšåˆä¸€äº¿æ•°æ®ï¼Œæ¯ä¸ªå­—æ®µå¤šèŠ±è´¹ 10 çº³ç§’çš„æ—¶é—´ï¼Œé‚£ä¹ˆåœ¨æ¯æ¬¡æŸ¥è¯¢æ—¶éƒ½ä¼šé¢å¤–å¢åŠ  1 ç§’ï¼Œå¦‚æœæˆ‘ä»¬è¦åœ¨éå¸¸å¤§é‡çš„æ•°æ®é‡Œé¢ä½¿ç”¨ <code>cardinality</code> ï¼Œæˆ‘ä»¬å¯ä»¥æƒè¡¡ä½¿ç”¨é¢„è®¡ç®—çš„æ„ä¹‰ï¼Œæ˜¯å¦éœ€è¦æå‰è®¡ç®— hashï¼Œä»è€Œåœ¨æŸ¥è¯¢æ—¶è·å¾—æ›´å¥½çš„æ€§èƒ½ï¼Œåšä¸€äº›æ€§èƒ½æµ‹è¯•æ¥æ£€éªŒé¢„è®¡ç®—å“ˆå¸Œæ˜¯å¦é€‚ç”¨äºä½ çš„åº”ç”¨åœºæ™¯ã€‚ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;cardinalityç”¨æ³•&quot;&gt;&lt;a href=&quot;#cardinalityç”¨æ³•&quot; class=&quot;headerlink&quot; title=&quot;cardinalityç”¨æ³•&quot;&gt;&lt;/a&gt;cardinalityç”¨æ³•&lt;/h2&gt;&lt;p&gt;å¸¸ç”¨å†™æ³•å¦‚ä¸‹ğŸ‘‡&lt;br&gt;&lt;code&gt;curl -X </summary>
      
    
    
    
    <category term="Elasticsearch" scheme="http://example.com/categories/Elasticsearch/"/>
    
    <category term="Aggregations" scheme="http://example.com/categories/Elasticsearch/Aggregations/"/>
    
    
    <category term="elasticsearch" scheme="http://example.com/tags/elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>å¤šæ¡¶æ’åº</title>
    <link href="http://example.com/wiki/%E5%A4%9A%E6%A1%B6%E6%8E%92%E5%BA%8F/"/>
    <id>http://example.com/wiki/%E5%A4%9A%E6%A1%B6%E6%8E%92%E5%BA%8F/</id>
    <published>2021-07-08T07:50:24.000Z</published>
    <updated>2021-07-08T13:21:43.551Z</updated>
    
    <content type="html"><![CDATA[<p>å¤šå€¼æ¡¶ï¼ˆ terms ã€ histogram å’Œ date_histogram ï¼‰åŠ¨æ€ç”Ÿæˆå¾ˆå¤šæ¡¶ã€‚ Elasticsearch æ˜¯å¦‚ä½•å†³å®šè¿™äº›æ¡¶å±•ç¤ºç»™ç”¨æˆ·çš„é¡ºåºå‘¢ï¼Ÿ</p><p>é»˜è®¤çš„ï¼Œæ¡¶ä¼šæ ¹æ® doc_count é™åºæ’åˆ—ã€‚è¿™æ˜¯ä¸€ä¸ªå¥½çš„é»˜è®¤è¡Œä¸ºï¼Œå› ä¸ºé€šå¸¸æˆ‘ä»¬æƒ³è¦æ‰¾åˆ°æ–‡æ¡£ä¸­ä¸æŸ¥è¯¢æ¡ä»¶ç›¸å…³çš„æœ€å¤§å€¼ï¼šå”®ä»·ã€äººå£æ•°é‡ã€é¢‘ç‡ã€‚ä½†æœ‰äº›æ—¶å€™æˆ‘ä»¬å¸Œæœ›èƒ½ä¿®æ”¹è¿™ä¸ªé¡ºåºï¼Œä¸åŒçš„æ¡¶æœ‰ç€ä¸åŒçš„å¤„ç†æ–¹å¼ã€‚</p><h2 id="å†…ç½®æ’åº"><a href="#å†…ç½®æ’åº" class="headerlink" title="å†…ç½®æ’åº"></a>å†…ç½®æ’åº</h2><p>è¿™äº›æ’åºæ¨¡å¼æ˜¯æ¡¶ å›ºæœ‰çš„ èƒ½åŠ›ï¼šå®ƒä»¬æ“ä½œæ¡¶ç”Ÿæˆçš„æ•°æ® ï¼Œæ¯”å¦‚ doc_count ã€‚ å®ƒä»¬å…±äº«ç›¸åŒçš„è¯­æ³•ï¼Œä½†æ˜¯æ ¹æ®ä½¿ç”¨æ¡¶çš„ä¸åŒä¼šæœ‰äº›ç»†å¾®å·®åˆ«ã€‚</p><p>è®©æˆ‘ä»¬åšä¸€ä¸ª terms èšåˆä½†æ˜¯æŒ‰ doc_count å€¼çš„å‡åºæ’åºï¼š</p><p><code>curl -X GET &quot;localhost:9200/cars/transactions/_search?pretty&quot; -H &#39;Content-Type: application/json&#39; -d&#39;</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;size&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;aggs&quot;</span> : &#123;</span><br><span class="line">        <span class="attr">&quot;colors&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;terms&quot;</span> : &#123;</span><br><span class="line">              <span class="attr">&quot;field&quot;</span> : <span class="string">&quot;color&quot;</span>,</span><br><span class="line">              <span class="attr">&quot;order&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;_count&quot;</span> : <span class="string">&quot;asc&quot;</span> </span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x27;</span><br></pre></td></tr></table></figure><p>ç”¨å…³é”®å­— _count ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ doc_count å€¼çš„å‡åºæ’åºã€‚</p><p>æˆ‘ä»¬ä¸ºèšåˆå¼•å…¥äº†ä¸€ä¸ª order å¯¹è±¡ï¼Œ å®ƒå…è®¸æˆ‘ä»¬å¯ä»¥æ ¹æ®ä»¥ä¸‹å‡ ä¸ªå€¼ä¸­çš„ä¸€ä¸ªå€¼è¿›è¡Œæ’åºï¼š</p><ul><li>_count<br>æŒ‰æ–‡æ¡£æ•°æ’åºã€‚å¯¹ terms ã€ histogram ã€ date_histogram æœ‰æ•ˆã€‚</li><li>_term<br>æŒ‰è¯é¡¹çš„å­—ç¬¦ä¸²å€¼çš„å­—æ¯é¡ºåºæ’åºã€‚åªåœ¨ terms å†…ä½¿ç”¨ã€‚</li><li>_key<br>æŒ‰æ¯ä¸ªæ¡¶çš„é”®å€¼æ•°å€¼æ’åºï¼ˆç†è®ºä¸Šä¸ _term ç±»ä¼¼ï¼‰ã€‚ åªåœ¨ histogram å’Œ date_histogram å†…ä½¿ç”¨ã€‚</li></ul><h2 id="æŒ‰åº¦é‡æ’åº"><a href="#æŒ‰åº¦é‡æ’åº" class="headerlink" title="æŒ‰åº¦é‡æ’åº"></a>æŒ‰åº¦é‡æ’åº</h2><p>æœ‰æ—¶ï¼Œæˆ‘ä»¬ä¼šæƒ³åŸºäºåº¦é‡è®¡ç®—çš„ç»“æœå€¼è¿›è¡Œæ’åºã€‚ åœ¨æˆ‘ä»¬çš„æ±½è½¦é”€å”®åˆ†æä»ªè¡¨ç›˜ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½æƒ³æŒ‰ç…§æ±½è½¦é¢œè‰²åˆ›å»ºä¸€ä¸ªé”€å”®æ¡çŠ¶å›¾è¡¨ï¼Œä½†æŒ‰ç…§æ±½è½¦å¹³å‡å”®ä»·çš„å‡åºè¿›è¡Œæ’åºã€‚</p><p>æˆ‘ä»¬å¯ä»¥å¢åŠ ä¸€ä¸ªåº¦é‡ï¼Œå†æŒ‡å®š order å‚æ•°å¼•ç”¨è¿™ä¸ªåº¦é‡å³å¯ï¼š</p><p><code>curl -X GET &quot;localhost:9200/cars/transactions/_search?pretty&quot; -H &#39;Content-Type: application/json&#39; -d&#39;</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;size&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;aggs&quot;</span> : &#123;</span><br><span class="line">        <span class="attr">&quot;colors&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;terms&quot;</span> : &#123;</span><br><span class="line">              <span class="attr">&quot;field&quot;</span> : <span class="string">&quot;color&quot;</span>,</span><br><span class="line">              <span class="attr">&quot;order&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;avg_price&quot;</span> : <span class="string">&quot;asc&quot;</span> </span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;aggs&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;avg_price&quot;</span>: &#123;</span><br><span class="line">                    <span class="attr">&quot;avg&quot;</span>: &#123;<span class="attr">&quot;field&quot;</span>: <span class="string">&quot;price&quot;</span>&#125; </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><p>è®¡ç®—æ¯ä¸ªæ¡¶çš„å¹³å‡å”®ä»·ã€‚</p></li><li><p>æ¡¶æŒ‰ç…§è®¡ç®—å¹³å‡å€¼çš„å‡åºæ’åºã€‚</p></li></ul><p>æˆ‘ä»¬å¯ä»¥é‡‡ç”¨è¿™ç§æ–¹å¼ç”¨ä»»ä½•åº¦é‡æ’åºï¼Œåªéœ€ç®€å•çš„å¼•ç”¨åº¦é‡çš„åå­—ã€‚ä¸è¿‡æœ‰äº›åº¦é‡ä¼šè¾“å‡ºå¤šä¸ªå€¼ã€‚ extended_stats åº¦é‡æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼šå®ƒè¾“å‡ºå¥½å‡ ä¸ªåº¦é‡å€¼ã€‚</p><p>å¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨å¤šå€¼åº¦é‡è¿›è¡Œæ’åºï¼Œ æˆ‘ä»¬åªéœ€ä»¥å…³å¿ƒçš„åº¦é‡ä¸ºå…³é”®è¯ä½¿ç”¨ç‚¹å¼è·¯å¾„ï¼š<br><code>curl -X GET &quot;localhost:9200/cars/transactions/_search?pretty&quot; -H &#39;Content-Type: application/json&#39; -d&#39;</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;size&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;aggs&quot;</span> : &#123;</span><br><span class="line">        <span class="attr">&quot;colors&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;terms&quot;</span> : &#123;</span><br><span class="line">              <span class="attr">&quot;field&quot;</span> : <span class="string">&quot;color&quot;</span>,</span><br><span class="line">              <span class="attr">&quot;order&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;stats.variance&quot;</span> : <span class="string">&quot;asc&quot;</span> </span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;aggs&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;stats&quot;</span>: &#123;</span><br><span class="line">                    <span class="attr">&quot;extended_stats&quot;</span>: &#123;<span class="attr">&quot;field&quot;</span>: <span class="string">&quot;price&quot;</span>&#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨ . ç¬¦å·ï¼Œæ ¹æ®æ„Ÿå…´è¶£çš„åº¦é‡è¿›è¡Œæ’åºã€‚</li></ul><h2 id="æ·±åº¦åº¦é‡æ’åº"><a href="#æ·±åº¦åº¦é‡æ’åº" class="headerlink" title="æ·±åº¦åº¦é‡æ’åº"></a>æ·±åº¦åº¦é‡æ’åº</h2><p>åœ¨å‰é¢çš„ç¤ºä¾‹ä¸­ï¼Œåº¦é‡æ˜¯æ¡¶çš„ç›´æ¥å­èŠ‚ç‚¹ã€‚å¹³å‡å”®ä»·æ˜¯æ ¹æ®æ¯ä¸ª term æ¥è®¡ç®—çš„ã€‚ åœ¨ä¸€å®šæ¡ä»¶ä¸‹ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰å¯èƒ½å¯¹ æ›´æ·± çš„åº¦é‡è¿›è¡Œæ’åºï¼Œæ¯”å¦‚å­™å­æ¡¶æˆ–ä»å­™æ¡¶ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å®šä¹‰æ›´æ·±çš„è·¯å¾„ï¼Œå°†åº¦é‡ç”¨å°–æ‹¬å·ï¼ˆ &gt; ï¼‰åµŒå¥—èµ·æ¥ï¼Œåƒè¿™æ ·ï¼š my_bucket&gt;another_bucket&gt;metric ã€‚</p><p>éœ€è¦æé†’çš„æ˜¯åµŒå¥—è·¯å¾„ä¸Šçš„æ¯ä¸ªæ¡¶éƒ½å¿…é¡»æ˜¯ å•å€¼ çš„ã€‚ filter æ¡¶ç”Ÿæˆ ä¸€ä¸ªå•å€¼æ¡¶ï¼šæ‰€æœ‰ä¸è¿‡æ»¤æ¡ä»¶åŒ¹é…çš„æ–‡æ¡£éƒ½åœ¨æ¡¶ä¸­ã€‚ å¤šå€¼æ¡¶ï¼ˆå¦‚ï¼šterms ï¼‰åŠ¨æ€ç”Ÿæˆè®¸å¤šæ¡¶ï¼Œæ— æ³•é€šè¿‡æŒ‡å®šä¸€ä¸ªç¡®å®šè·¯å¾„æ¥è¯†åˆ«ã€‚</p><p>ç›®å‰ï¼Œåªæœ‰ä¸‰ä¸ªå•å€¼æ¡¶ï¼š filter ã€ global å’Œ reverse_nested ã€‚è®©æˆ‘ä»¬å¿«é€Ÿç”¨ç¤ºä¾‹è¯´æ˜ï¼Œåˆ›å»ºä¸€ä¸ªæ±½è½¦å”®ä»·çš„ç›´æ–¹å›¾ï¼Œä½†æ˜¯æŒ‰ç…§çº¢è‰²å’Œç»¿è‰²ï¼ˆä¸åŒ…æ‹¬è“è‰²ï¼‰è½¦å„è‡ªçš„æ–¹å·®æ¥æ’åºï¼š</p><p><code>curl -X GET &quot;localhost:9200/cars/transactions/_search?pretty&quot; -H &#39;Content-Type: application/json&#39; -d&#39;</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;size&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;aggs&quot;</span> : &#123;</span><br><span class="line">        <span class="attr">&quot;colors&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;histogram&quot;</span> : &#123;</span><br><span class="line">              <span class="attr">&quot;field&quot;</span> : <span class="string">&quot;price&quot;</span>,</span><br><span class="line">              <span class="attr">&quot;interval&quot;</span>: <span class="number">20000</span>,</span><br><span class="line">              <span class="attr">&quot;order&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;red_green_cars&gt;stats.variance&quot;</span> : <span class="string">&quot;asc&quot;</span> </span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;aggs&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;red_green_cars&quot;</span>: &#123;</span><br><span class="line">                    <span class="attr">&quot;filter&quot;</span>: &#123; <span class="attr">&quot;terms&quot;</span>: &#123;<span class="attr">&quot;color&quot;</span>: [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>]&#125;&#125;, </span><br><span class="line">                    <span class="attr">&quot;aggs&quot;</span>: &#123;</span><br><span class="line">                        <span class="attr">&quot;stats&quot;</span>: &#123;<span class="attr">&quot;extended_stats&quot;</span>: &#123;<span class="attr">&quot;field&quot;</span> : <span class="string">&quot;price&quot;</span>&#125;&#125; </span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><p>æŒ‰ç…§åµŒå¥—åº¦é‡çš„æ–¹å·®å¯¹æ¡¶çš„ç›´æ–¹å›¾è¿›è¡Œæ’åºã€‚</p></li><li><p>å› ä¸ºæˆ‘ä»¬ä½¿ç”¨å•å€¼è¿‡æ»¤å™¨ filter ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åµŒå¥—æ’åºã€‚</p></li><li><p>æŒ‰ç…§ç”Ÿæˆçš„åº¦é‡å¯¹ç»Ÿè®¡ç»“æœè¿›è¡Œæ’åºã€‚</p></li></ul><p>æœ¬ä¾‹ä¸­ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¦‚ä½•è®¿é—®ä¸€ä¸ªåµŒå¥—çš„åº¦é‡ã€‚ stats åº¦é‡æ˜¯ red_green_cars èšåˆçš„å­èŠ‚ç‚¹ï¼Œè€Œ red_green_cars åˆæ˜¯ colors èšåˆçš„å­èŠ‚ç‚¹ã€‚ ä¸ºäº†æ ¹æ®è¿™ä¸ªåº¦é‡æ’åºï¼Œæˆ‘ä»¬å®šä¹‰äº†è·¯å¾„ red_green_cars&gt;stats.variance ã€‚æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼Œå› ä¸º filter æ¡¶æ˜¯ä¸ªå•å€¼æ¡¶ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å¤šå€¼æ¡¶ï¼ˆ terms ã€ histogram å’Œ date_histogram ï¼‰åŠ¨æ€ç”Ÿæˆå¾ˆå¤šæ¡¶ã€‚ Elasticsearch æ˜¯å¦‚ä½•å†³å®šè¿™äº›æ¡¶å±•ç¤ºç»™ç”¨æˆ·çš„é¡ºåºå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;é»˜è®¤çš„ï¼Œæ¡¶ä¼šæ ¹æ® doc_count é™åºæ’åˆ—ã€‚è¿™æ˜¯ä¸€ä¸ªå¥½çš„é»˜è®¤è¡Œä¸ºï¼Œå› ä¸ºé€šå¸¸æˆ‘ä»¬æƒ³è¦æ‰¾åˆ°æ–‡æ¡£</summary>
      
    
    
    
    <category term="Elasticsearch" scheme="http://example.com/categories/Elasticsearch/"/>
    
    <category term="Aggregations" scheme="http://example.com/categories/Elasticsearch/Aggregations/"/>
    
    
    <category term="elasticsaerch" scheme="http://example.com/tags/elasticsaerch/"/>
    
  </entry>
  
  <entry>
    <title>è¿‡æ»¤å’Œèšåˆ</title>
    <link href="http://example.com/wiki/%E8%BF%87%E6%BB%A4%E5%92%8C%E8%81%9A%E5%90%88/"/>
    <id>http://example.com/wiki/%E8%BF%87%E6%BB%A4%E5%92%8C%E8%81%9A%E5%90%88/</id>
    <published>2021-07-08T07:33:26.000Z</published>
    <updated>2021-07-08T13:21:01.410Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è¿‡æ»¤å’Œèšåˆ"><a href="#è¿‡æ»¤å’Œèšåˆ" class="headerlink" title="è¿‡æ»¤å’Œèšåˆ"></a>è¿‡æ»¤å’Œèšåˆ</h2><p>èšåˆèŒƒå›´é™å®šè¿˜æœ‰ä¸€ä¸ªè‡ªç„¶çš„æ‰©å±•å°±æ˜¯è¿‡æ»¤ã€‚å› ä¸ºèšåˆæ˜¯åœ¨æŸ¥è¯¢ç»“æœèŒƒå›´å†…æ“ä½œçš„ï¼Œä»»ä½•å¯ä»¥é€‚ç”¨äºæŸ¥è¯¢çš„è¿‡æ»¤å™¨ä¹Ÿå¯ä»¥åº”ç”¨åœ¨èšåˆä¸Šã€‚</p><h2 id="è¿‡æ»¤"><a href="#è¿‡æ»¤" class="headerlink" title="è¿‡æ»¤"></a>è¿‡æ»¤</h2><p>å¦‚æœæˆ‘ä»¬æƒ³æ‰¾åˆ°å”®ä»·åœ¨ $10,000 ç¾å…ƒä¹‹ä¸Šçš„æ‰€æœ‰æ±½è½¦åŒæ—¶ä¹Ÿä¸ºè¿™äº›è½¦è®¡ç®—å¹³å‡å”®ä»·ï¼Œ å¯ä»¥ç®€å•åœ°ä½¿ç”¨ä¸€ä¸ª <code>constant_score</code> æŸ¥è¯¢å’Œ <code>filter</code> çº¦æŸï¼š</p><p><code>GET /cars/transactions/_search</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;size&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;query&quot;</span> : &#123;</span><br><span class="line">        <span class="attr">&quot;constant_score&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;filter&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;range&quot;</span>: &#123;</span><br><span class="line">                    <span class="attr">&quot;price&quot;</span>: &#123;</span><br><span class="line">                        <span class="attr">&quot;gte&quot;</span>: <span class="number">10000</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;aggs&quot;</span> : &#123;</span><br><span class="line">        <span class="attr">&quot;single_avg_price&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;avg&quot;</span> : &#123; <span class="attr">&quot;field&quot;</span> : <span class="string">&quot;price&quot;</span> &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»æ ¹æœ¬ä¸Šè®²ï¼Œä½¿ç”¨ <code>non-scoring</code> æŸ¥è¯¢å’Œä½¿ç”¨ <code>match</code> æŸ¥è¯¢æ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚æŸ¥è¯¢ï¼ˆåŒ…æ‹¬äº†ä¸€ä¸ªè¿‡æ»¤å™¨ï¼‰è¿”å›ä¸€ç»„æ–‡æ¡£çš„å­é›†ï¼Œèšåˆæ­£æ˜¯æ“ä½œè¿™äº›æ–‡æ¡£ã€‚ä½¿ç”¨ <code>filtering query</code> ä¼šå¿½ç•¥è¯„åˆ†ï¼Œå¹¶æœ‰å¯èƒ½ä¼šç¼“å­˜ç»“æœæ•°æ®ç­‰ç­‰ã€‚</p><h2 id="è¿‡æ»¤æ¡¶"><a href="#è¿‡æ»¤æ¡¶" class="headerlink" title="è¿‡æ»¤æ¡¶"></a>è¿‡æ»¤æ¡¶</h2><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬åªæƒ³å¯¹èšåˆç»“æœè¿‡æ»¤æ€ä¹ˆåŠï¼Ÿ å‡è®¾æˆ‘ä»¬æ­£åœ¨ä¸ºæ±½è½¦ç»é”€å•†åˆ›å»ºä¸€ä¸ªæœç´¢é¡µé¢ï¼Œ æˆ‘ä»¬å¸Œæœ›æ˜¾ç¤ºç”¨æˆ·æœç´¢çš„ç»“æœï¼Œä½†æ˜¯æˆ‘ä»¬åŒæ—¶ä¹Ÿæƒ³åœ¨é¡µé¢ä¸Šæä¾›æ›´ä¸°å¯Œçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼ˆä¸æœç´¢åŒ¹é…çš„ï¼‰ä¸Šä¸ªæœˆåº¦æ±½è½¦çš„å¹³å‡å”®ä»·ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬æ— æ³•ç®€å•çš„åšèŒƒå›´é™å®šï¼Œå› ä¸ºæœ‰ä¸¤ä¸ªä¸åŒçš„æ¡ä»¶ã€‚æœç´¢ç»“æœå¿…é¡»æ˜¯ ford ï¼Œä½†æ˜¯èšåˆç»“æœå¿…é¡»æ»¡è¶³ ford AND sold &gt; now - 1M ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ç§ç‰¹æ®Šçš„æ¡¶ï¼Œå«åš filter ï¼ˆæ³¨ï¼šè¿‡æ»¤æ¡¶ï¼‰ ã€‚ æˆ‘ä»¬å¯ä»¥æŒ‡å®šä¸€ä¸ªè¿‡æ»¤æ¡¶ï¼Œå½“æ–‡æ¡£æ»¡è¶³è¿‡æ»¤æ¡¶çš„æ¡ä»¶æ—¶ï¼Œæˆ‘ä»¬å°†å…¶åŠ å…¥åˆ°æ¡¶å†…ã€‚</p><p>æŸ¥è¯¢ç»“æœå¦‚ä¸‹ï¼š<br><code>GET /cars/transactions/_search</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">&quot;size&quot;</span> : <span class="number">0</span>,</span><br><span class="line">   <span class="attr">&quot;query&quot;</span>:&#123;</span><br><span class="line">      <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">         <span class="attr">&quot;make&quot;</span>: <span class="string">&quot;ford&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="attr">&quot;aggs&quot;</span>:&#123;</span><br><span class="line">      <span class="attr">&quot;recent_sales&quot;</span>: &#123;</span><br><span class="line">         <span class="attr">&quot;filter&quot;</span>: &#123; </span><br><span class="line">            <span class="attr">&quot;range&quot;</span>: &#123;</span><br><span class="line">               <span class="attr">&quot;sold&quot;</span>: &#123;</span><br><span class="line">                  <span class="attr">&quot;from&quot;</span>: <span class="string">&quot;now-1M&quot;</span></span><br><span class="line">               &#125;</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;,</span><br><span class="line">         <span class="attr">&quot;aggs&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;average_price&quot;</span>:&#123;</span><br><span class="line">               <span class="attr">&quot;avg&quot;</span>: &#123;</span><br><span class="line">                  <span class="attr">&quot;field&quot;</span>: <span class="string">&quot;price&quot;</span> </span><br><span class="line">               &#125;</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>ä½¿ç”¨ è¿‡æ»¤ æ¡¶åœ¨ æŸ¥è¯¢ èŒƒå›´åŸºç¡€ä¸Šåº”ç”¨è¿‡æ»¤å™¨ã€‚</p></li><li><p>avg åº¦é‡åªä¼šå¯¹ ford å’Œä¸Šä¸ªæœˆå”®å‡ºçš„æ–‡æ¡£è®¡ç®—å¹³å‡å”®ä»·ã€‚</p></li></ul><p>å› ä¸º <code>filter</code> æ¡¶å’Œå…¶ä»–æ¡¶çš„æ“ä½œæ–¹å¼ä¸€æ ·ï¼Œæ‰€ä»¥å¯ä»¥éšæ„å°†å…¶ä»–æ¡¶å’Œåº¦é‡åµŒå…¥å…¶ä¸­ã€‚æ‰€æœ‰åµŒå¥—çš„ç»„ä»¶éƒ½ä¼š â€œç»§æ‰¿â€ è¿™ä¸ªè¿‡æ»¤ï¼Œè¿™ä½¿æˆ‘ä»¬å¯ä»¥æŒ‰éœ€é’ˆå¯¹èšåˆè¿‡æ»¤å‡ºé€‰æ‹©éƒ¨åˆ†ã€‚</p><h2 id="åè¿‡æ»¤å™¨"><a href="#åè¿‡æ»¤å™¨" class="headerlink" title="åè¿‡æ»¤å™¨"></a>åè¿‡æ»¤å™¨</h2><p>ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å¯ä»¥åŒæ—¶å¯¹æœç´¢ç»“æœå’Œèšåˆç»“æœè¿›è¡Œè¿‡æ»¤ï¼ˆä¸è®¡ç®—å¾—åˆ†çš„ filter æŸ¥è¯¢ï¼‰ï¼Œä»¥åŠé’ˆå¯¹èšåˆç»“æœçš„ä¸€éƒ¨åˆ†è¿›è¡Œè¿‡æ»¤ï¼ˆ filter æ¡¶ï¼‰ã€‚</p><p>æˆ‘ä»¬å¯èƒ½ä¼šæƒ³ï¼Œâ€åªè¿‡æ»¤æœç´¢ç»“æœï¼Œä¸è¿‡æ»¤èšåˆç»“æœå‘¢ï¼Ÿâ€ ç­”æ¡ˆæ˜¯ä½¿ç”¨ post_filter ã€‚</p><p>å®ƒæ˜¯æ¥æ”¶ä¸€ä¸ªè¿‡æ»¤å™¨çš„é¡¶å±‚æœç´¢è¯·æ±‚å…ƒç´ ã€‚è¿™ä¸ªè¿‡æ»¤å™¨åœ¨æŸ¥è¯¢ ä¹‹å æ‰§è¡Œï¼ˆè¿™æ­£æ˜¯è¯¥è¿‡æ»¤å™¨çš„åå­—çš„ç”±æ¥ï¼šå®ƒåœ¨æŸ¥è¯¢ä¹‹å post æ‰§è¡Œï¼‰ã€‚æ­£å› ä¸ºå®ƒåœ¨æŸ¥è¯¢ä¹‹åæ‰§è¡Œï¼Œå®ƒå¯¹æŸ¥è¯¢èŒƒå›´æ²¡æœ‰ä»»ä½•å½±å“ï¼Œæ‰€ä»¥å¯¹èšåˆä¹Ÿä¸ä¼šæœ‰ä»»ä½•å½±å“ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªè¡Œä¸ºå¯¹æŸ¥è¯¢æ¡ä»¶åº”ç”¨æ›´å¤šçš„è¿‡æ»¤å™¨ï¼Œè€Œä¸ä¼šå½±å“å…¶ä»–çš„æ“ä½œï¼Œå°±å¦‚ UI ä¸Šçš„å„ä¸ªåˆ†ç±»é¢ã€‚è®©æˆ‘ä»¬ä¸ºæ±½è½¦ç»é”€å•†è®¾è®¡å¦å¤–ä¸€ä¸ªæœç´¢é¡µé¢ï¼Œè¿™ä¸ªé¡µé¢å…è®¸ç”¨æˆ·æœç´¢æ±½è½¦åŒæ—¶å¯ä»¥æ ¹æ®é¢œè‰²æ¥è¿‡æ»¤ã€‚é¢œè‰²çš„é€‰é¡¹æ˜¯é€šè¿‡èšåˆè·å¾—çš„ï¼š</p><p><code>GET /cars/transactions/_search</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;size&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;make&quot;</span>: <span class="string">&quot;ford&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;post_filter&quot;</span>: &#123;    </span><br><span class="line">        <span class="attr">&quot;term&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;color&quot;</span> : <span class="string">&quot;green&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;aggs&quot;</span> : &#123;</span><br><span class="line">        <span class="attr">&quot;all_colors&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;terms&quot;</span> : &#123; <span class="attr">&quot;field&quot;</span> : <span class="string">&quot;color&quot;</span> &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>post_filter å…ƒç´ æ˜¯ top-level è€Œä¸”ä»…å¯¹å‘½ä¸­ç»“æœè¿›è¡Œè¿‡æ»¤ã€‚</p></blockquote><p>æŸ¥è¯¢ éƒ¨åˆ†æ‰¾åˆ°æ‰€æœ‰çš„ ford æ±½è½¦ï¼Œç„¶åç”¨ terms èšåˆåˆ›å»ºä¸€ä¸ªé¢œè‰²åˆ—è¡¨ã€‚å› ä¸ºèšåˆå¯¹æŸ¥è¯¢èŒƒå›´è¿›è¡Œæ“ä½œï¼Œé¢œè‰²åˆ—è¡¨ä¸ç¦ç‰¹æ±½è½¦æœ‰çš„é¢œè‰²ç›¸å¯¹åº”ã€‚</p><p>æœ€åï¼Œ post_filter ä¼šè¿‡æ»¤æœç´¢ç»“æœï¼Œåªå±•ç¤ºç»¿è‰² ford æ±½è½¦ã€‚è¿™åœ¨æŸ¥è¯¢æ‰§è¡Œè¿‡ å å‘ç”Ÿï¼Œæ‰€ä»¥èšåˆä¸å—å½±å“ã€‚</p><p>è¿™é€šå¸¸å¯¹ UI çš„è¿è´¯ä¸€è‡´æ€§å¾ˆé‡è¦ï¼Œå¯ä»¥æƒ³è±¡ç”¨æˆ·åœ¨ç•Œé¢å•†é€‰æ‹©äº†ä¸€ç±»é¢œè‰²ï¼ˆæ¯”å¦‚ï¼šç»¿è‰²ï¼‰ï¼ŒæœŸæœ›çš„æ˜¯æœç´¢ç»“æœå·²ç»è¢«è¿‡æ»¤äº†ï¼Œè€Œ ä¸æ˜¯ è¿‡æ»¤ç•Œé¢ä¸Šçš„é€‰é¡¹ã€‚å¦‚æœæˆ‘ä»¬åº”ç”¨ filter æŸ¥è¯¢ï¼Œç•Œé¢ä¼šé©¬ä¸Šå˜æˆ åª æ˜¾ç¤º ç»¿è‰² ä½œä¸ºé€‰é¡¹ï¼Œè¿™ä¸æ˜¯ç”¨æˆ·æƒ³è¦çš„ï¼</p><p>âš ï¸ âš ï¸ âš ï¸</p><h2 id="æ€§èƒ½è€ƒè™‘ï¼ˆPerformance-considerationï¼‰"><a href="#æ€§èƒ½è€ƒè™‘ï¼ˆPerformance-considerationï¼‰" class="headerlink" title="æ€§èƒ½è€ƒè™‘ï¼ˆPerformance considerationï¼‰"></a>æ€§èƒ½è€ƒè™‘ï¼ˆPerformance considerationï¼‰</h2><p>å½“ä½ éœ€è¦å¯¹æœç´¢ç»“æœå’Œèšåˆç»“æœåšä¸åŒçš„è¿‡æ»¤æ—¶ï¼Œä½ æ‰åº”è¯¥ä½¿ç”¨ post_filter ï¼Œ æœ‰æ—¶ç”¨æˆ·ä¼šåœ¨æ™®é€šæœç´¢ä½¿ç”¨ post_filter ã€‚</p><p>ä¸è¦è¿™ä¹ˆåšï¼ post_filter çš„ç‰¹æ€§æ˜¯åœ¨æŸ¥è¯¢ ä¹‹å æ‰§è¡Œï¼Œä»»ä½•è¿‡æ»¤å¯¹æ€§èƒ½å¸¦æ¥çš„å¥½å¤„ï¼ˆæ¯”å¦‚ç¼“å­˜ï¼‰éƒ½ä¼šå®Œå…¨å¤±å»ã€‚</p><p>åœ¨æˆ‘ä»¬éœ€è¦ä¸åŒè¿‡æ»¤æ—¶ï¼Œ post_filter åªä¸èšåˆä¸€èµ·ä½¿ç”¨ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é€‰æ‹©åˆé€‚ç±»å‹çš„è¿‡æ»¤ï¼ˆå¦‚ï¼šæœç´¢å‘½ä¸­ã€èšåˆæˆ–ä¸¤è€…å…¼æœ‰ï¼‰é€šå¸¸å’Œæˆ‘ä»¬æœŸæœ›å¦‚ä½•è¡¨ç°ç”¨æˆ·äº¤äº’æœ‰å…³ã€‚é€‰æ‹©åˆé€‚çš„è¿‡æ»¤å™¨ï¼ˆæˆ–ç»„åˆï¼‰å–å†³äºæˆ‘ä»¬æœŸæœ›å¦‚ä½•å°†ç»“æœå‘ˆç°ç»™ç”¨æˆ·ã€‚</p><ul><li>åœ¨ filter è¿‡æ»¤ä¸­çš„ non-scoring æŸ¥è¯¢ï¼ŒåŒæ—¶å½±å“æœç´¢ç»“æœå’Œèšåˆç»“æœã€‚</li><li>filter æ¡¶å½±å“èšåˆã€‚</li><li>post_filter åªå½±å“æœç´¢ç»“æœã€‚</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;è¿‡æ»¤å’Œèšåˆ&quot;&gt;&lt;a href=&quot;#è¿‡æ»¤å’Œèšåˆ&quot; class=&quot;headerlink&quot; title=&quot;è¿‡æ»¤å’Œèšåˆ&quot;&gt;&lt;/a&gt;è¿‡æ»¤å’Œèšåˆ&lt;/h2&gt;&lt;p&gt;èšåˆèŒƒå›´é™å®šè¿˜æœ‰ä¸€ä¸ªè‡ªç„¶çš„æ‰©å±•å°±æ˜¯è¿‡æ»¤ã€‚å› ä¸ºèšåˆæ˜¯åœ¨æŸ¥è¯¢ç»“æœèŒƒå›´å†…æ“ä½œçš„ï¼Œä»»ä½•å¯ä»¥é€‚ç”¨äºæŸ¥è¯¢çš„è¿‡æ»¤å™¨ä¹Ÿå¯ä»¥åº”ç”¨åœ¨èšåˆ</summary>
      
    
    
    
    <category term="Elasticsearch" scheme="http://example.com/categories/Elasticsearch/"/>
    
    <category term="Aggregations" scheme="http://example.com/categories/Elasticsearch/Aggregations/"/>
    
    
    <category term="elasticsearch" scheme="http://example.com/tags/elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>èšåˆ æ¡å½¢å›¾</title>
    <link href="http://example.com/wiki/%E8%81%9A%E5%90%88-%E6%9D%A1%E5%BD%A2%E5%9B%BE/"/>
    <id>http://example.com/wiki/%E8%81%9A%E5%90%88-%E6%9D%A1%E5%BD%A2%E5%9B%BE/</id>
    <published>2021-07-08T07:11:57.000Z</published>
    <updated>2021-07-08T13:21:13.369Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><blockquote><ul><li><a href=""></a></li><li><a href=""></a></li></ul></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‚è€ƒèµ„æ–™&quot;&gt;&lt;a href=&quot;#å‚è€ƒèµ„æ–™&quot; class=&quot;headerlink&quot; title=&quot;å‚è€ƒèµ„æ–™&quot;&gt;&lt;/a&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;&quot;&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;&quot;&gt;&lt;/a&gt;&lt;/l</summary>
      
    
    
    
    <category term="Elasticsearch" scheme="http://example.com/categories/Elasticsearch/"/>
    
    <category term="Aggregations" scheme="http://example.com/categories/Elasticsearch/Aggregations/"/>
    
    
    <category term="elasticsearch" scheme="http://example.com/tags/elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>åµŒå¥—æ¡¶</title>
    <link href="http://example.com/wiki/%E5%B5%8C%E5%A5%97%E6%A1%B6/"/>
    <id>http://example.com/wiki/%E5%B5%8C%E5%A5%97%E6%A1%B6/</id>
    <published>2021-07-08T07:01:16.000Z</published>
    <updated>2021-07-08T13:21:24.382Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸¤å±‚åµŒå¥—"><a href="#ä¸¤å±‚åµŒå¥—" class="headerlink" title="ä¸¤å±‚åµŒå¥—"></a>ä¸¤å±‚åµŒå¥—</h2><p>åœ¨æˆ‘ä»¬ä½¿ç”¨ä¸åŒçš„åµŒå¥—æ–¹æ¡ˆæ—¶ï¼Œèšåˆçš„åŠ›é‡æ‰èƒ½çœŸæ­£å¾—ä»¥æ˜¾ç°ã€‚ åœ¨å‰ä¾‹ä¸­ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°å¦‚ä½•å°†ä¸€ä¸ªåº¦é‡åµŒå…¥æ¡¶ä¸­ï¼Œå®ƒçš„åŠŸèƒ½å·²ç»ååˆ†å¼ºå¤§äº†ã€‚</p><p>ä½†çœŸæ­£ä»¤äººæ¿€åŠ¨çš„åˆ†ææ¥è‡ªäºå°†æ¡¶åµŒå¥—è¿› å¦å¤–ä¸€ä¸ªæ¡¶ æ‰€èƒ½å¾—åˆ°çš„ç»“æœã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“æ¯ä¸ªé¢œè‰²çš„æ±½è½¦åˆ¶é€ å•†çš„åˆ†å¸ƒï¼š</p><p><code>GET /cars/transactions/_search</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">&quot;size&quot;</span> : <span class="number">0</span>,</span><br><span class="line">   <span class="attr">&quot;aggs&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;colors&quot;</span>: &#123;</span><br><span class="line">         <span class="attr">&quot;terms&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;field&quot;</span>: <span class="string">&quot;color&quot;</span></span><br><span class="line">         &#125;,</span><br><span class="line">         <span class="attr">&quot;aggs&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;avg_price&quot;</span>: &#123; </span><br><span class="line">               <span class="attr">&quot;avg&quot;</span>: &#123;</span><br><span class="line">                  <span class="attr">&quot;field&quot;</span>: <span class="string">&quot;price&quot;</span></span><br><span class="line">               &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;make&quot;</span>: &#123; </span><br><span class="line">                <span class="attr">&quot;terms&quot;</span>: &#123;</span><br><span class="line">                    <span class="attr">&quot;field&quot;</span>: <span class="string">&quot;make&quot;</span> </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>æ³¨æ„å‰ä¾‹ä¸­çš„ avg_price åº¦é‡ä»ç„¶ä¿æŒåŸä½ã€‚</p></li><li><p>å¦ä¸€ä¸ªèšåˆ make è¢«åŠ å…¥åˆ°äº† color é¢œè‰²æ¡¶ä¸­ã€‚</p></li><li><p>è¿™ä¸ªèšåˆæ˜¯ terms æ¡¶ï¼Œå®ƒä¼šä¸ºæ¯ä¸ªæ±½è½¦åˆ¶é€ å•†ç”Ÿæˆå”¯ä¸€çš„æ¡¶ã€‚</p></li></ul><p>è¿™é‡Œå‘ç”Ÿäº†ä¸€äº›æœ‰è¶£çš„äº‹ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬å¯èƒ½ä¼šè§‚å¯Ÿåˆ°ä¹‹å‰ä¾‹å­ä¸­çš„ <code>avg_price</code> åº¦é‡å®Œå…¨æ²¡æœ‰å˜åŒ–ï¼Œè¿˜åœ¨åŸæ¥çš„ä½ç½®ã€‚ ä¸€ä¸ªèšåˆçš„æ¯ä¸ª å±‚çº§ éƒ½å¯ä»¥æœ‰å¤šä¸ªåº¦é‡æˆ–æ¡¶ï¼Œ <code>avg_price</code> åº¦é‡å‘Šè¯‰æˆ‘ä»¬æ¯ç§é¢œè‰²æ±½è½¦çš„å¹³å‡ä»·æ ¼ã€‚å®ƒä¸å…¶ä»–çš„æ¡¶å’Œåº¦é‡ç›¸äº’ç‹¬ç«‹ã€‚</p><p>è¿™å¯¹æˆ‘ä»¬çš„åº”ç”¨éå¸¸é‡è¦ï¼Œå› ä¸ºè¿™é‡Œé¢æœ‰å¾ˆå¤šç›¸äº’å…³è”ï¼Œä½†åˆå®Œå…¨ä¸åŒçš„åº¦é‡éœ€è¦æ”¶é›†ã€‚èšåˆä½¿æˆ‘ä»¬èƒ½å¤Ÿç”¨ä¸€æ¬¡æ•°æ®è¯·æ±‚è·å¾—æ‰€æœ‰çš„è¿™äº›ä¿¡æ¯ã€‚</p><p>å¦å¤–ä¸€ä»¶å€¼å¾—æ³¨æ„çš„é‡è¦äº‹æƒ…æ˜¯æˆ‘ä»¬æ–°å¢çš„è¿™ä¸ª make èšåˆï¼Œå®ƒæ˜¯ä¸€ä¸ª <code>terms</code> æ¡¶ï¼ˆåµŒå¥—åœ¨ colors ã€ terms æ¡¶å†…ï¼‰ã€‚è¿™æ„å‘³ç€å®ƒä¼šä¸ºæ•°æ®é›†ä¸­çš„æ¯ä¸ªå”¯ä¸€ç»„åˆç”Ÿæˆï¼ˆ color ã€ make ï¼‰å…ƒç»„ã€‚</p><p>è®©æˆ‘ä»¬çœ‹çœ‹è¿”å›çš„å“åº”ï¼ˆä¸ºäº†ç®€å•æˆ‘ä»¬åªæ˜¾ç¤ºéƒ¨åˆ†ç»“æœï¼‰ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">&quot;aggregations&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;colors&quot;</span>: &#123;</span><br><span class="line">         <span class="attr">&quot;buckets&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">               <span class="attr">&quot;key&quot;</span>: <span class="string">&quot;red&quot;</span>,</span><br><span class="line">               <span class="attr">&quot;doc_count&quot;</span>: <span class="number">4</span>,</span><br><span class="line">               <span class="attr">&quot;make&quot;</span>: &#123; </span><br><span class="line">                  <span class="attr">&quot;buckets&quot;</span>: [</span><br><span class="line">                     &#123;</span><br><span class="line">                        <span class="attr">&quot;key&quot;</span>: <span class="string">&quot;honda&quot;</span>, </span><br><span class="line">                        <span class="attr">&quot;doc_count&quot;</span>: <span class="number">3</span></span><br><span class="line">                     &#125;,</span><br><span class="line">                     &#123;</span><br><span class="line">                        <span class="attr">&quot;key&quot;</span>: <span class="string">&quot;bmw&quot;</span>,</span><br><span class="line">                        <span class="attr">&quot;doc_count&quot;</span>: <span class="number">1</span></span><br><span class="line">                     &#125;</span><br><span class="line">                  ]</span><br><span class="line">               &#125;,</span><br><span class="line">               <span class="attr">&quot;avg_price&quot;</span>: &#123;</span><br><span class="line">                  <span class="attr">&quot;value&quot;</span>: <span class="number">32500</span> </span><br><span class="line">               &#125;</span><br><span class="line">            &#125;</span><br><span class="line">      &#125;  </span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>æ­£å¦‚æœŸæœ›çš„é‚£æ ·ï¼Œæ–°çš„èšåˆåµŒå…¥åœ¨æ¯ä¸ªé¢œè‰²æ¡¶ä¸­ã€‚</p></li><li><p>ç°åœ¨æˆ‘ä»¬çœ‹è§æŒ‰ä¸åŒåˆ¶é€ å•†åˆ†è§£çš„æ¯ç§é¢œè‰²ä¸‹è½¦è¾†ä¿¡æ¯ã€‚</p></li><li><p>æœ€ç»ˆï¼Œæˆ‘ä»¬çœ‹åˆ°å‰ä¾‹ä¸­çš„ avg_price åº¦é‡ä»ç„¶ç»´æŒä¸å˜ã€‚</p></li></ul><h2 id="ä¸‰å±‚åµŒå¥—"><a href="#ä¸‰å±‚åµŒå¥—" class="headerlink" title="ä¸‰å±‚åµŒå¥—"></a>ä¸‰å±‚åµŒå¥—</h2><p>è®©æˆ‘ä»¬å›åˆ°è¯é¢˜çš„åŸç‚¹ï¼Œåœ¨è¿›å…¥æ–°è¯é¢˜ä¹‹å‰ï¼Œå¯¹æˆ‘ä»¬çš„ç¤ºä¾‹åšæœ€åä¸€ä¸ªä¿®æ”¹ï¼Œ ä¸ºæ¯ä¸ªæ±½è½¦ç”Ÿæˆå•†è®¡ç®—æœ€ä½å’Œæœ€é«˜çš„ä»·æ ¼ï¼š<br><code>GET /cars/transactions/_search</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">&quot;size&quot;</span> : <span class="number">0</span>,</span><br><span class="line">   <span class="attr">&quot;aggs&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;colors&quot;</span>: &#123;</span><br><span class="line">         <span class="attr">&quot;terms&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;field&quot;</span>: <span class="string">&quot;color&quot;</span></span><br><span class="line">         &#125;,</span><br><span class="line">         <span class="attr">&quot;aggs&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;avg_price&quot;</span>: &#123; <span class="attr">&quot;avg&quot;</span>: &#123; <span class="attr">&quot;field&quot;</span>: <span class="string">&quot;price&quot;</span> &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;make&quot;</span> : &#123;</span><br><span class="line">                <span class="attr">&quot;terms&quot;</span> : &#123;</span><br><span class="line">                    <span class="attr">&quot;field&quot;</span> : <span class="string">&quot;make&quot;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">&quot;aggs&quot;</span> : &#123; </span><br><span class="line">                    <span class="attr">&quot;min_price&quot;</span> : &#123; <span class="attr">&quot;min&quot;</span>: &#123; <span class="attr">&quot;field&quot;</span>: <span class="string">&quot;price&quot;</span>&#125; &#125;, </span><br><span class="line">                    <span class="attr">&quot;max_price&quot;</span> : &#123; <span class="attr">&quot;max&quot;</span>: &#123; <span class="attr">&quot;field&quot;</span>: <span class="string">&quot;price&quot;</span>&#125; &#125; </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>æˆ‘ä»¬éœ€è¦å¢åŠ å¦å¤–ä¸€ä¸ªåµŒå¥—çš„ aggs å±‚çº§ã€‚</p></li><li><p>ç„¶ååŒ…æ‹¬ min æœ€å°åº¦é‡ã€‚</p></li><li><p>ä»¥åŠ max æœ€å¤§åº¦é‡ã€‚</p></li></ul><p>å¾—åˆ°ä»¥ä¸‹è¾“å‡ºï¼ˆåªæ˜¾ç¤ºéƒ¨åˆ†ç»“æœï¼‰ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">...</span><br><span class="line">   <span class="attr">&quot;aggregations&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;colors&quot;</span>: &#123;</span><br><span class="line">         <span class="attr">&quot;buckets&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">               <span class="attr">&quot;key&quot;</span>: <span class="string">&quot;red&quot;</span>,</span><br><span class="line">               <span class="attr">&quot;doc_count&quot;</span>: <span class="number">4</span>,</span><br><span class="line">               <span class="attr">&quot;make&quot;</span>: &#123;</span><br><span class="line">                  <span class="attr">&quot;buckets&quot;</span>: [</span><br><span class="line">                     &#123;</span><br><span class="line">                        <span class="attr">&quot;key&quot;</span>: <span class="string">&quot;honda&quot;</span>,</span><br><span class="line">                        <span class="attr">&quot;doc_count&quot;</span>: <span class="number">3</span>,</span><br><span class="line">                        <span class="attr">&quot;min_price&quot;</span>: &#123;</span><br><span class="line">                           <span class="attr">&quot;value&quot;</span>: <span class="number">10000</span> </span><br><span class="line">                        &#125;,</span><br><span class="line">                        <span class="attr">&quot;max_price&quot;</span>: &#123;</span><br><span class="line">                           <span class="attr">&quot;value&quot;</span>: <span class="number">20000</span> </span><br><span class="line">                        &#125;</span><br><span class="line">                     &#125;,</span><br><span class="line">                     &#123;</span><br><span class="line">                        <span class="attr">&quot;key&quot;</span>: <span class="string">&quot;bmw&quot;</span>,</span><br><span class="line">                        <span class="attr">&quot;doc_count&quot;</span>: <span class="number">1</span>,</span><br><span class="line">                        <span class="attr">&quot;min_price&quot;</span>: &#123;</span><br><span class="line">                           <span class="attr">&quot;value&quot;</span>: <span class="number">80000</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        <span class="attr">&quot;max_price&quot;</span>: &#123;</span><br><span class="line">                           <span class="attr">&quot;value&quot;</span>: <span class="number">80000</span></span><br><span class="line">                        &#125;</span><br><span class="line">                     &#125;</span><br><span class="line">                  ]</span><br><span class="line">               &#125;,</span><br><span class="line">               <span class="attr">&quot;avg_price&quot;</span>: &#123;</span><br><span class="line">                  <span class="attr">&quot;value&quot;</span>: <span class="number">32500</span></span><br><span class="line">               &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>æœ‰äº†è¿™ä¸¤ä¸ªæ¡¶ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æŸ¥è¯¢çš„ç»“æœè¿›è¡Œæ‰©å±•å¹¶å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š  </p><p>æœ‰å››è¾†çº¢è‰²è½¦ã€‚<br>çº¢è‰²è½¦çš„å¹³å‡å”®ä»·æ˜¯ $32ï¼Œ500 ç¾å…ƒã€‚<br>å…¶ä¸­ä¸‰è¾†çº¢è‰²è½¦æ˜¯ Honda æœ¬ç”°åˆ¶é€ ï¼Œä¸€è¾†æ˜¯ BMW å®é©¬åˆ¶é€ ã€‚<br>æœ€ä¾¿å®œçš„çº¢è‰²æœ¬ç”°å”®ä»·ä¸º $10ï¼Œ000 ç¾å…ƒã€‚<br>æœ€è´µçš„çº¢è‰²æœ¬ç”°å”®ä»·ä¸º $20ï¼Œ000 ç¾å…ƒã€‚  </p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ä¸¤å±‚åµŒå¥—&quot;&gt;&lt;a href=&quot;#ä¸¤å±‚åµŒå¥—&quot; class=&quot;headerlink&quot; title=&quot;ä¸¤å±‚åµŒå¥—&quot;&gt;&lt;/a&gt;ä¸¤å±‚åµŒå¥—&lt;/h2&gt;&lt;p&gt;åœ¨æˆ‘ä»¬ä½¿ç”¨ä¸åŒçš„åµŒå¥—æ–¹æ¡ˆæ—¶ï¼Œèšåˆçš„åŠ›é‡æ‰èƒ½çœŸæ­£å¾—ä»¥æ˜¾ç°ã€‚ åœ¨å‰ä¾‹ä¸­ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°å¦‚ä½•å°†ä¸€ä¸ªåº¦é‡åµŒå…¥æ¡¶ä¸­ï¼Œå®ƒçš„åŠŸèƒ½å·²ç»ååˆ†å¼ºå¤§</summary>
      
    
    
    
    <category term="Elasticsearch" scheme="http://example.com/categories/Elasticsearch/"/>
    
    <category term="Aggregations" scheme="http://example.com/categories/Elasticsearch/Aggregations/"/>
    
    
    <category term="elasticsearch" scheme="http://example.com/tags/elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>èšåˆ é«˜çº§æ¦‚å¿µ</title>
    <link href="http://example.com/wiki/%E8%81%9A%E5%90%88-%E9%AB%98%E7%BA%A7%E6%A6%82%E5%BF%B5/"/>
    <id>http://example.com/wiki/%E8%81%9A%E5%90%88-%E9%AB%98%E7%BA%A7%E6%A6%82%E5%BF%B5/</id>
    <published>2021-07-08T06:52:35.000Z</published>
    <updated>2021-07-08T13:21:08.345Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ¡¶"><a href="#æ¡¶" class="headerlink" title="æ¡¶"></a>æ¡¶</h2><p><code>æ¡¶</code> ç®€å•æ¥è¯´å°±æ˜¯æ»¡è¶³ç‰¹å®šæ¡ä»¶çš„æ–‡æ¡£çš„é›†åˆï¼š</p><ul><li>ä¸€ä¸ªé›‡å‘˜å±äº ç”·æ€§ æ¡¶æˆ–è€… å¥³æ€§ æ¡¶</li><li>å¥¥å°”å·´å°¼å±äº çº½çº¦ æ¡¶</li><li>æ—¥æœŸ2014-10-28å±äº åæœˆ æ¡¶<br>å½“èšåˆå¼€å§‹è¢«æ‰§è¡Œï¼Œæ¯ä¸ªæ–‡æ¡£é‡Œé¢çš„å€¼é€šè¿‡è®¡ç®—æ¥å†³å®šç¬¦åˆå“ªä¸ªæ¡¶çš„æ¡ä»¶ã€‚å¦‚æœåŒ¹é…åˆ°ï¼Œæ–‡æ¡£å°†æ”¾å…¥ç›¸åº”çš„æ¡¶å¹¶æ¥ç€è¿›è¡Œèšåˆæ“ä½œã€‚</li></ul><p>æ¡¶ä¹Ÿå¯ä»¥è¢«åµŒå¥—åœ¨å…¶ä»–æ¡¶é‡Œé¢ï¼Œæä¾›å±‚æ¬¡åŒ–çš„æˆ–è€…æœ‰æ¡ä»¶çš„åˆ’åˆ†æ–¹æ¡ˆã€‚ä¾‹å¦‚ï¼Œè¾›è¾›é‚£æä¼šè¢«æ”¾å…¥ä¿„äº¥ä¿„å·è¿™ä¸ªæ¡¶ï¼Œè€Œ æ•´ä¸ª ä¿„äº¥ä¿„å·æ¡¶ä¼šè¢«æ”¾å…¥ç¾å›½è¿™ä¸ªæ¡¶ã€‚</p><p>Elasticsearch æœ‰å¾ˆå¤šç§ç±»å‹çš„æ¡¶ï¼Œèƒ½è®©ä½ é€šè¿‡å¾ˆå¤šç§æ–¹å¼æ¥åˆ’åˆ†æ–‡æ¡£ï¼ˆ<code>æ—¶é—´</code>ã€<code>æœ€å—æ¬¢è¿çš„è¯</code>ã€<code>å¹´é¾„åŒºé—´</code>ã€<code>åœ°ç†ä½ç½®</code> ç­‰ç­‰ï¼‰ã€‚å…¶å®æ ¹æœ¬ä¸Šéƒ½æ˜¯é€šè¿‡åŒæ ·çš„åŸç†è¿›è¡Œæ“ä½œï¼šåŸºäºæ¡ä»¶æ¥åˆ’åˆ†æ–‡æ¡£ã€‚</p><h2 id="æŒ‡æ ‡"><a href="#æŒ‡æ ‡" class="headerlink" title="æŒ‡æ ‡"></a>æŒ‡æ ‡</h2><p>æ¡¶èƒ½è®©æˆ‘ä»¬åˆ’åˆ†æ–‡æ¡£åˆ°æœ‰æ„ä¹‰çš„é›†åˆï¼Œä½†æ˜¯æœ€ç»ˆæˆ‘ä»¬éœ€è¦çš„æ˜¯å¯¹è¿™äº›æ¡¶å†…çš„æ–‡æ¡£è¿›è¡Œä¸€äº›æŒ‡æ ‡çš„è®¡ç®—ã€‚åˆ†æ¡¶æ˜¯ä¸€ç§è¾¾åˆ°ç›®çš„çš„æ‰‹æ®µï¼šå®ƒæä¾›äº†ä¸€ç§ç»™æ–‡æ¡£åˆ†ç»„çš„æ–¹æ³•æ¥è®©æˆ‘ä»¬å¯ä»¥è®¡ç®—æ„Ÿå…´è¶£çš„æŒ‡æ ‡ã€‚</p><p>å¤§å¤šæ•° <code>æŒ‡æ ‡</code> æ˜¯ç®€å•çš„æ•°å­¦è¿ç®—ï¼ˆä¾‹å¦‚æœ€å°å€¼ã€å¹³å‡å€¼ã€æœ€å¤§å€¼ï¼Œè¿˜æœ‰æ±‡æ€»ï¼‰ï¼Œè¿™äº›æ˜¯é€šè¿‡æ–‡æ¡£çš„å€¼æ¥è®¡ç®—ã€‚åœ¨å®è·µä¸­ï¼ŒæŒ‡æ ‡èƒ½è®©ä½ è®¡ç®—åƒå¹³å‡è–ªèµ„ã€æœ€é«˜å‡ºå”®ä»·æ ¼ã€95%çš„æŸ¥è¯¢å»¶è¿Ÿè¿™æ ·çš„æ•°æ®ã€‚</p><h2 id="æ¡¶å’ŒæŒ‡æ ‡çš„ç»„åˆ"><a href="#æ¡¶å’ŒæŒ‡æ ‡çš„ç»„åˆ" class="headerlink" title="æ¡¶å’ŒæŒ‡æ ‡çš„ç»„åˆ"></a>æ¡¶å’ŒæŒ‡æ ‡çš„ç»„åˆ</h2><p><code>èšåˆ</code> æ˜¯ç”±æ¡¶å’ŒæŒ‡æ ‡ç»„æˆçš„ã€‚ èšåˆå¯èƒ½åªæœ‰ä¸€ä¸ªæ¡¶ï¼Œå¯èƒ½åªæœ‰ä¸€ä¸ªæŒ‡æ ‡ï¼Œæˆ–è€…å¯èƒ½ä¸¤ä¸ªéƒ½æœ‰ã€‚ä¹Ÿæœ‰å¯èƒ½æœ‰ä¸€äº›æ¡¶åµŒå¥—åœ¨å…¶ä»–æ¡¶é‡Œé¢ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰€å±å›½å®¶æ¥åˆ’åˆ†æ–‡æ¡£ï¼ˆæ¡¶ï¼‰ï¼Œç„¶åè®¡ç®—æ¯ä¸ªå›½å®¶çš„å¹³å‡è–ªé…¬ï¼ˆæŒ‡æ ‡ï¼‰ã€‚</p><p>ç”±äºæ¡¶å¯ä»¥è¢«åµŒå¥—ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°éå¸¸å¤šå¹¶ä¸”éå¸¸å¤æ‚çš„èšåˆï¼š</p><p>1.é€šè¿‡å›½å®¶åˆ’åˆ†æ–‡æ¡£ï¼ˆæ¡¶ï¼‰</p><p>2.ç„¶åé€šè¿‡æ€§åˆ«åˆ’åˆ†æ¯ä¸ªå›½å®¶ï¼ˆæ¡¶ï¼‰</p><p>3.ç„¶åé€šè¿‡å¹´é¾„åŒºé—´åˆ’åˆ†æ¯ç§æ€§åˆ«ï¼ˆæ¡¶ï¼‰</p><p>4.æœ€åï¼Œä¸ºæ¯ä¸ªå¹´é¾„åŒºé—´è®¡ç®—å¹³å‡è–ªé…¬ï¼ˆæŒ‡æ ‡ï¼‰</p><p>æœ€åå°†å‘Šè¯‰ä½ æ¯ä¸ª &lt;å›½å®¶, æ€§åˆ«, å¹´é¾„&gt; ç»„åˆçš„å¹³å‡è–ªé…¬ã€‚æ‰€æœ‰çš„è¿™äº›éƒ½åœ¨ä¸€ä¸ªè¯·æ±‚å†…å®Œæˆå¹¶ä¸”åªéå†ä¸€æ¬¡æ•°æ®ï¼</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;æ¡¶&quot;&gt;&lt;a href=&quot;#æ¡¶&quot; class=&quot;headerlink&quot; title=&quot;æ¡¶&quot;&gt;&lt;/a&gt;æ¡¶&lt;/h2&gt;&lt;p&gt;&lt;code&gt;æ¡¶&lt;/code&gt; ç®€å•æ¥è¯´å°±æ˜¯æ»¡è¶³ç‰¹å®šæ¡ä»¶çš„æ–‡æ¡£çš„é›†åˆï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ªé›‡å‘˜å±äº ç”·æ€§ æ¡¶æˆ–è€… å¥³æ€§ æ¡¶&lt;/li&gt;
&lt;l</summary>
      
    
    
    
    <category term="Elasticsearch" scheme="http://example.com/categories/Elasticsearch/"/>
    
    <category term="Aggregations" scheme="http://example.com/categories/Elasticsearch/Aggregations/"/>
    
    
    <category term="elasticsaerch" scheme="http://example.com/tags/elasticsaerch/"/>
    
  </entry>
  
  <entry>
    <title>elasticsearch-overview</title>
    <link href="http://example.com/wiki/elasticsearch-overview/"/>
    <id>http://example.com/wiki/elasticsearch-overview/</id>
    <published>2021-07-08T03:17:58.000Z</published>
    <updated>2021-07-08T13:15:46.849Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å­¦ä¹ èµ„æ–™"><a href="#å­¦ä¹ èµ„æ–™" class="headerlink" title="å­¦ä¹ èµ„æ–™"></a>å­¦ä¹ èµ„æ–™</h2><ul><li> <a href="https://doc.codingdict.com/elasticsearch/">https://www.codingdict.com/</a></li><li> <a href="https://elasticsearch.cn/">https://elasticsearch.cn/</a></li><li> <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indexing-buffer.html">https://www.elastic.co/guide/en/</a></li><li> <a href="https://elastic.blog.csdn.net/">é“­æ¯…å¤©ä¸‹</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å­¦ä¹ èµ„æ–™&quot;&gt;&lt;a href=&quot;#å­¦ä¹ èµ„æ–™&quot; class=&quot;headerlink&quot; title=&quot;å­¦ä¹ èµ„æ–™&quot;&gt;&lt;/a&gt;å­¦ä¹ èµ„æ–™&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt; &lt;a href=&quot;https://doc.codingdict.com/elasticsearch/&quot;&gt;htt</summary>
      
    
    
    
    <category term="Elasticsearch" scheme="http://example.com/categories/Elasticsearch/"/>
    
    <category term="Getting Started" scheme="http://example.com/categories/Elasticsearch/Getting-Started/"/>
    
    
    <category term="elasticsearch" scheme="http://example.com/tags/elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>å…³äº Elasticsearch å†…å­˜å ç”¨åŠåˆ†é…</title>
    <link href="http://example.com/wiki/%E5%85%B3%E4%BA%8E-Elasticsearch-%E5%86%85%E5%AD%98%E5%8D%A0%E7%94%A8%E5%8F%8A%E5%88%86%E9%85%8D/"/>
    <id>http://example.com/wiki/%E5%85%B3%E4%BA%8E-Elasticsearch-%E5%86%85%E5%AD%98%E5%8D%A0%E7%94%A8%E5%8F%8A%E5%88%86%E9%85%8D/</id>
    <published>2021-07-08T02:39:16.000Z</published>
    <updated>2021-07-08T13:18:44.472Z</updated>
    
    <content type="html"><![CDATA[<p>Elasticsearch å’Œ Lucene å¯¹å†…å­˜ä½¿ç”¨æƒ…å†µï¼š </p><img src='https://nereuschen.github.io/2015/09/16/ElasticSearch%E5%86%85%E5%AD%98%E4%BD%BF%E7%94%A8%E5%88%86%E6%9E%90/es-cache.png' width=500 height=550><p>Elasticsearch é™åˆ¶çš„å†…å­˜å¤§å°æ˜¯ JAVA å †ç©ºé—´çš„å¤§å°ï¼Œä¸åŒ…æ‹¬Lucene ç¼“å­˜å€’æ’ç´¢å¼•æ•°æ®ç©ºé—´ã€‚</p><p>Lucene ä¸­çš„ å€’æ’ç´¢å¼• segments å­˜å‚¨åœ¨æ–‡ä»¶ä¸­ï¼Œä¸ºæé«˜è®¿é—®é€Ÿåº¦ï¼Œéƒ½ä¼šæŠŠå®ƒåŠ è½½åˆ°å†…å­˜ä¸­ï¼Œä»è€Œæé«˜ Lucene æ€§èƒ½ã€‚æ‰€ä»¥å»ºè®®è‡³å°‘ç•™ç³»ç»Ÿä¸€åŠå†…å­˜ç»™Luceneã€‚<br><code>Node Query Cache</code> (è´Ÿè´£ç¼“å­˜f ilter æŸ¥è¯¢ç»“æœ)ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸€ä¸ªï¼Œè¢«æ‰€æœ‰ shard å…±äº«ï¼Œfilter queryæŸ¥è¯¢ç»“æœè¦ä¹ˆæ˜¯ yes è¦ä¹ˆæ˜¯noï¼Œä¸æ¶‰åŠ scores çš„è®¡ç®—ã€‚<br>é›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹éƒ½è¦é…ç½®ï¼Œé»˜è®¤ä¸ºï¼šindices.queries.cache.size:10%</p><p><code>Indexing Buffer</code> ç´¢å¼•ç¼“å†²åŒºï¼Œç”¨äºå­˜å‚¨æ–°ç´¢å¼•çš„æ–‡æ¡£ï¼Œå½“å…¶è¢«å¡«æ»¡æ—¶ï¼Œç¼“å†²åŒºä¸­çš„æ–‡æ¡£è¢«å†™å…¥ç£ç›˜ä¸­çš„ <code>segments</code> ä¸­ã€‚èŠ‚ç‚¹ä¸Šæ‰€æœ‰ <code>shard</code> å…±äº«ã€‚<br>ç¼“å†²åŒºé»˜è®¤å¤§å°ï¼š indices.memory.index_buffer_size: 10%<br>å¦‚æœç¼“å†²åŒºå¤§å°è®¾ç½®äº†ç™¾åˆ†ç™¾åˆ™ indices.memory.min_index_buffer_size ç”¨äºè¿™æ˜¯æœ€å°å€¼ï¼Œé»˜è®¤ä¸º 48mbã€‚indices.memory.max_index_buffer_size ç”¨äºæœ€å¤§å¤§å°ï¼Œæ— é»˜è®¤å€¼ã€‚</p><p><code>segments</code><br>segmentsä¼šé•¿æœŸå ç”¨å†…å­˜ï¼Œå…¶åˆè¡·å°±æ˜¯åˆ©ç”¨OSçš„cacheæå‡æ€§èƒ½ã€‚åªæœ‰åœ¨Mergeä¹‹åï¼Œæ‰ä¼šé‡Šæ”¾æ‰æ ‡è®°ä¸ºDeleteçš„segmentsï¼Œé‡Šæ”¾éƒ¨åˆ†å†…å­˜ã€‚</p><p><code>Shard Request Cache</code> ç”¨äºç¼“å­˜è¯·æ±‚ç»“æœï¼Œä½†ä¹‹ç¼“å­˜request sizeä¸º0çš„ã€‚æ¯”å¦‚è¯´ hits.total, aggregations å’Œ suggestions.<br>é»˜è®¤æœ€å¤§ä¸ºindices.requests.cache.size:1%</p><p><code>Field Data Cache</code> å­—æ®µç¼“å­˜é‡è¦ç”¨äºå¯¹å­—æ®µè¿›è¡Œæ’åºã€èšåˆæ˜¯ä½¿ç”¨ã€‚å› ä¸ºæ„å»ºå­—æ®µæ•°æ®ç¼“å­˜ä»£ä»·æ˜‚è´µï¼Œæ‰€ä»¥å»ºè®®æœ‰è¶³å¤Ÿçš„å†…è®­æ¥å­˜å‚¨ã€‚<br><code>Fielddata</code> æ˜¯ ã€Œ å»¶è¿Ÿ ã€ åŠ è½½ã€‚å¦‚æœä½ ä»æ¥æ²¡æœ‰èšåˆä¸€ä¸ªåˆ†æå­—ç¬¦ä¸²ï¼Œå°±ä¸ä¼šåŠ è½½ fielddata åˆ°å†…å­˜ä¸­ï¼Œä¹Ÿå°±ä¸ä¼šä½¿ç”¨å¤§é‡çš„å†…å­˜ï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘åˆ†é…è¾ƒå°çš„heapç»™Elasticsearchã€‚å› ä¸ºheapè¶Šå°æ„å‘³ç€Elasticsearchçš„GCä¼šæ¯”è¾ƒå¿«ï¼Œå¹¶ä¸”é¢„ç•™ç»™Luceneçš„å†…å­˜ä¹Ÿä¼šæ¯”è¾ƒå¤§ã€‚ã€‚<br>å¦‚æœæ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜ä¿å­˜fielddataæ—¶ï¼ŒElastisearchä¼šä¸æ–­åœ°ä»ç£ç›˜åŠ è½½æ•°æ®åˆ°å†…å­˜ï¼Œå¹¶å‰”é™¤æ‰æ—§çš„å†…å­˜æ•°æ®ã€‚å‰”é™¤æ“ä½œä¼šé€ æˆä¸¥é‡çš„ç£ç›˜I/Oï¼Œå¹¶ä¸”å¼•å‘å¤§é‡çš„GCï¼Œä¼šä¸¥é‡å½±å“Elastisearchçš„æ€§èƒ½ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹Fielddataä¼šä¸æ–­å ç”¨å†…å­˜ï¼Œç›´åˆ°å®ƒè§¦å‘äº†fielddata circuit breakerã€‚<br>fielddata circuit breakerä¼šæ ¹æ®æŸ¥è¯¢æ¡ä»¶è¯„ä¼°è¿™æ¬¡æŸ¥è¯¢ä¼šä½¿ç”¨å¤šå°‘å†…å­˜ï¼Œä»è€Œè®¡ç®—åŠ è½½è¿™éƒ¨åˆ†å†…å­˜ä¹‹åï¼ŒField Data Cacheæ‰€å ç”¨çš„å†…å­˜æ˜¯å¦ä¼šè¶…è¿‡indices.breaker.fielddata.limitã€‚å¦‚æœè¶…è¿‡è¿™ä¸ªå€¼ï¼Œå°±ä¼šè§¦å‘fielddata circuit breakerï¼Œabortè¿™æ¬¡æŸ¥è¯¢å¹¶ä¸”æŠ›å‡ºå¼‚å¸¸ï¼Œé˜²æ­¢OOMã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">indices.breaker.fielddata.limit:60% (é»˜è®¤heapçš„60%)  (es7ä¹‹åæ”¹æˆ70%)</span><br></pre></td></tr></table></figure><p>å¦‚æœè®¾ç½®äº†indices.fielddata.cache.sizeï¼Œå½“è¾¾åˆ°sizeæ—¶ï¼Œcacheä¼šå‰”é™¤æ—§çš„fielddataã€‚</p><blockquote><p>indices.breaker.fielddata.limit å¿…é¡»å¤§äº indices.fielddata.cache.sizeï¼Œå¦åˆ™åªä¼šè§¦å‘fielddata circuit breakerï¼Œè€Œä¸ä¼šå‰”é™¤æ—§çš„fielddataã€‚</p></blockquote><h2 id="é…ç½®Elasticsearchå †å†…å­˜"><a href="#é…ç½®Elasticsearchå †å†…å­˜" class="headerlink" title="é…ç½®Elasticsearchå †å†…å­˜"></a>é…ç½®Elasticsearchå †å†…å­˜</h2><p>Elasticsearché»˜è®¤å®‰è£…åè®¾ç½®çš„å†…å­˜æ˜¯ <code>1GB</code>ï¼Œè¿™æ˜¯è¿œè¿œä¸å¤Ÿç”¨äºç”Ÿäº§ç¯å¢ƒçš„ã€‚<br>æœ‰ä¸¤ç§æ–¹å¼ä¿®æ”¹Elasticsearchçš„å †å†…å­˜ï¼š</p><blockquote><ol><li>è®¾ç½®ç¯å¢ƒå˜é‡ï¼š<code>export ES_HEAP_SIZE=10g</code> åœ¨eså¯åŠ¨æ—¶ä¼šè¯»å–è¯¥å˜é‡ï¼›</li><li>å¯åŠ¨æ—¶ä½œä¸ºå‚æ•°ä¼ é€’ç»™esï¼š <code>./bin/elasticsearch -Xmx10g -Xms10g</code></li></ol></blockquote><h2 id="æ³¨æ„ç‚¹"><a href="#æ³¨æ„ç‚¹" class="headerlink" title="æ³¨æ„ç‚¹"></a>æ³¨æ„ç‚¹</h2><p>ç»™esåˆ†é…å†…å­˜æ—¶è¦æ³¨æ„ï¼Œè‡³å°‘è¦åˆ†é…ä¸€åŠå„¿å†…å­˜ç•™ç»™ Luceneã€‚<br>åˆ†é…ç»™ es çš„å†…å­˜æœ€å¥½ä¸è¦è¶…è¿‡ 32G ï¼Œå› ä¸ºå¦‚æœå †å¤§å°å°äº 32 GBï¼ŒJVM å¯ä»¥åˆ©ç”¨æŒ‡é’ˆå‹ç¼©ï¼Œè¿™å¯ä»¥å¤§å¤§é™ä½å†…å­˜çš„ä½¿ç”¨ï¼šæ¯ä¸ªæŒ‡é’ˆ 4 å­—èŠ‚è€Œä¸æ˜¯ 8 å­—èŠ‚ã€‚å¦‚æœå¤§äº32G æ¯ä¸ªæŒ‡é’ˆå ç”¨ 8å­—èŠ‚ï¼Œå¹¶ä¸”ä¼šå ç”¨æ›´å¤šçš„å†…å­˜å¸¦å®½ï¼Œé™ä½äº†cpuæ€§èƒ½ã€‚</p><p>è¿˜æœ‰ä¸€ç‚¹ï¼Œ è¦å…³é—­ <code>swap</code> å†…å­˜äº¤æ¢ç©ºé—´ï¼Œç¦ç”¨swappingã€‚é¢‘ç¹çš„swapping å¯¹æœåŠ¡å™¨æ¥è¯´æ˜¯è‡´å‘½çš„ã€‚<br>æ€»ç»“ï¼šç»™es JVMæ ˆçš„å†…å­˜æœ€å¥½ä¸è¦è¶…è¿‡32Gï¼Œç•™ç»™Luceneçš„å†…å­˜è¶Šå¤§è¶Šå¥½ï¼ŒLuceneæŠŠæ‰€æœ‰çš„segmentéƒ½ç¼“å­˜èµ·æ¥ï¼Œä¼šåŠ å¿«å…¨æ–‡æ£€ç´¢ã€‚</p><h2 id="å…³é—­äº¤æ¢åŒº"><a href="#å…³é—­äº¤æ¢åŒº" class="headerlink" title="å…³é—­äº¤æ¢åŒº"></a>å…³é—­äº¤æ¢åŒº</h2><p>è¿™åº”è¯¥æ˜¾è€Œæ˜“è§äº†ï¼Œä½†ä»ç„¶éœ€è¦æ˜ç¡®çš„å†™å‡ºæ¥ï¼šæŠŠå†…å­˜æ¢æˆç¡¬ç›˜å°†æ¯æ‰æœåŠ¡å™¨çš„æ€§èƒ½ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼šæ¶‰åŠå†…å­˜çš„æ“ä½œæ˜¯éœ€è¦å¿«é€Ÿæ‰§è¡Œçš„ã€‚å¦‚æœä»‹è´¨ä»å†…å­˜å˜ä¸ºäº†ç¡¬ç›˜ï¼Œä¸€ä¸ª10å¾®ç§’çš„æ“ä½œå˜æˆéœ€è¦10æ¯«ç§’ã€‚è€Œä¸”è¿™ç§å»¶è¿Ÿå‘ç”Ÿåœ¨æ‰€æœ‰æœ¬è¯¥åªèŠ±è´¹10å¾®ç§’çš„æ“ä½œä¸Šï¼Œå°±ä¸éš¾ç†è§£ä¸ºä»€ä¹ˆäº¤æ¢åŒºå¯¹äºæ€§èƒ½æ¥è¯´æ˜¯å™©æ¢¦ã€‚</p><p>æœ€å¥½çš„é€‰æ‹©æ˜¯ç¦ç”¨æ‰æ“ä½œç³»ç»Ÿçš„äº¤æ¢åŒºã€‚å¯ä»¥ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo swapoff -a</span><br></pre></td></tr></table></figure><p>æ¥ç¦ç”¨ï¼Œä½ å¯èƒ½è¿˜éœ€è¦ç¼–è¾‘ <code>/etc/fstab</code> æ–‡ä»¶ã€‚ç»†èŠ‚å¯ä»¥å‚è€ƒä½ çš„æ“ä½œç³»ç»Ÿæ–‡æ¡£ã€‚</p><p>å¦‚æœå®é™…ç¯å¢ƒä¸å…è®¸ç¦ç”¨æ‰ <code>swap</code>ï¼Œä½ å¯ä»¥å°è¯•é™ä½ <code>swappiness</code>ã€‚æ­¤å€¼æ§åˆ¶æ“ä½œç³»ç»Ÿä½¿ç”¨äº¤æ¢åŒºçš„ç§¯ææ€§ã€‚è¿™å¯ä»¥é˜²æ­¢åœ¨æ­£å¸¸æƒ…å†µä¸‹ä½¿ç”¨äº¤æ¢åŒºï¼Œä½†ä»å…è®¸æ“ä½œç³»ç»Ÿåœ¨ç´§æ€¥æƒ…å†µä¸‹å°†å†…å­˜é‡Œçš„ä¸œè¥¿æ”¾åˆ°äº¤æ¢åŒºã€‚</p><p>å¯¹äºå¤§å¤šæ•°Linuxç³»ç»Ÿæ¥è¯´ï¼Œè¿™å¯ä»¥ç”¨ <code>sysctl</code> å€¼æ¥é…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">vm.swappiness</span> <span class="string">=</span> <span class="number">1</span> <span class="comment"># å°†æ­¤å€¼é…ç½®ä¸º1ä¼šæ¯”0å¥½ï¼Œåœ¨kernalå†…æ ¸çš„æŸäº›ç‰ˆæœ¬ä¸­ï¼Œ0å¯èƒ½ä¼šå¼•èµ·OOMå¼‚å¸¸ã€‚</span></span><br></pre></td></tr></table></figure><p>æœ€åï¼Œå¦‚æœä¸¤ç§æ–¹æ³•éƒ½ä¸å¯ç”¨ï¼Œä½ åº”è¯¥åœ¨ElasticSearchçš„é…ç½®ä¸­å¯ç”¨ <code>mlockall.file</code>ã€‚è¿™å…è®¸JVMé”å®šå…¶ä½¿ç”¨çš„å†…å­˜ï¼Œè€Œé¿å…è¢«æ”¾å…¥æ“ä½œç³»ç»Ÿäº¤æ¢åŒºã€‚</p><p>åœ¨elasticsearch.ymlä¸­ï¼Œåšå¦‚ä¸‹è®¾ç½®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bootstrap.mlockall: true</span><br></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹nodeèŠ‚ç‚¹æ•°æ®"><a href="#æŸ¥çœ‹nodeèŠ‚ç‚¹æ•°æ®" class="headerlink" title="æŸ¥çœ‹nodeèŠ‚ç‚¹æ•°æ®"></a>æŸ¥çœ‹nodeèŠ‚ç‚¹æ•°æ®</h2><p><code>GET /_cat/nodes?v&amp;h=id,ip,port,v,master,name,heap.current,heap.percent,heap.max,ram.current,ram.percent,ram.max,fielddata.memory_size,fielddata.evictions,query_cache.memory_size,query_cache.evictions, request_cache.memory_size,request_cache.evictions,request_cache.hit_count,request_cache.miss_count</code></p><p><code>GET /_cat/nodes?v&amp;h=id,heap.current,heap.percent,heap.max,ram.current,ram.percent,ram.max,fielddata.memory_size</code></p><p><code>GET /_cat/nodes?v&amp;h=id,fielddata.evictions,query_cache.memory_size,query_cache.evictions, request_cache.memory_size,request_cache.evictions,request_cache.hit_count,request_cache.miss_count</code></p><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><blockquote><p><a href="https://nereuschen.github.io/2015/09/16/ElasticSearch%E5%86%85%E5%AD%98%E4%BD%BF%E7%94%A8%E5%88%86%E6%9E%90/"></a></p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Elasticsearch å’Œ Lucene å¯¹å†…å­˜ä½¿ç”¨æƒ…å†µï¼š &lt;/p&gt;
&lt;img src=&#39;https://nereuschen.github.io/2015/09/16/ElasticSearch%E5%86%85%E5%AD%98%E4%BD%BF%E7%94%A8%</summary>
      
    
    
    
    <category term="Elasticsearch" scheme="http://example.com/categories/Elasticsearch/"/>
    
    <category term="Administration and Deployment" scheme="http://example.com/categories/Elasticsearch/Administration-and-Deployment/"/>
    
    
    <category term="elasticsearch" scheme="http://example.com/tags/elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>cross-fieldsè·¨å­—æ®µæŸ¥è¯¢</title>
    <link href="http://example.com/wiki/cross-fields%E8%B7%A8%E5%AD%97%E6%AE%B5%E6%9F%A5%E8%AF%A2/"/>
    <id>http://example.com/wiki/cross-fields%E8%B7%A8%E5%AD%97%E6%AE%B5%E6%9F%A5%E8%AF%A2/</id>
    <published>2021-07-07T06:41:42.000Z</published>
    <updated>2021-07-08T13:09:24.415Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><blockquote><ul><li><a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/_cross_fields_queries.html#_cross_fields_queries">Elasticsearch: æƒå¨æŒ‡å— Â» æ·±å…¥æœç´¢ Â» å¤šå­—æ®µæœç´¢ Â» cross-fields è·¨å­—æ®µæŸ¥è¯¢</a></li><li><a href=""></a></li></ul></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‚è€ƒèµ„æ–™&quot;&gt;&lt;a href=&quot;#å‚è€ƒèµ„æ–™&quot; class=&quot;headerlink&quot; title=&quot;å‚è€ƒèµ„æ–™&quot;&gt;&lt;/a&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/cn/el</summary>
      
    
    
    
    <category term="Elasticsearch" scheme="http://example.com/categories/Elasticsearch/"/>
    
    <category term="Search in Depth" scheme="http://example.com/categories/Elasticsearch/Search-in-Depth/"/>
    
    
    <category term="elasticsearch" scheme="http://example.com/tags/elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>copy_toå‚æ•°</title>
    <link href="http://example.com/wiki/copy-to%E5%8F%82%E6%95%B0/"/>
    <id>http://example.com/wiki/copy-to%E5%8F%82%E6%95%B0/</id>
    <published>2021-07-07T06:34:42.000Z</published>
    <updated>2021-07-08T13:07:44.463Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><blockquote><ul><li><a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/custom-all.html">Elasticsearch: æƒå¨æŒ‡å— Â» æ·±å…¥æœç´¢ Â» å¤šå­—æ®µæœç´¢ Â» è‡ªå®šä¹‰ _all å­—æ®µ</a></li><li><a href="https://doc.codingdict.com/elasticsearch/319/">Docs Â» Mapping parametersï¼ˆæ˜ å°„å‚æ•°ï¼‰ Â» Mapping(æ˜ å°„) Â» copy_toï¼ˆåˆå¹¶å‚æ•°ï¼‰</a></li></ul></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å‚è€ƒèµ„æ–™&quot;&gt;&lt;a href=&quot;#å‚è€ƒèµ„æ–™&quot; class=&quot;headerlink&quot; title=&quot;å‚è€ƒèµ„æ–™&quot;&gt;&lt;/a&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.elastic.co/guide/cn/el</summary>
      
    
    
    
    <category term="Elasticsearch" scheme="http://example.com/categories/Elasticsearch/"/>
    
    <category term="Search in Depth" scheme="http://example.com/categories/Elasticsearch/Search-in-Depth/"/>
    
    
    <category term="elasticsearch" scheme="http://example.com/tags/elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>å­—ç¬¦ä¸²æ’åºä¸å¤šå­—æ®µ</title>
    <link href="http://example.com/wiki/%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8E%92%E5%BA%8F%E4%B8%8E%E5%A4%9A%E5%AD%97%E6%AE%B5/"/>
    <id>http://example.com/wiki/%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8E%92%E5%BA%8F%E4%B8%8E%E5%A4%9A%E5%AD%97%E6%AE%B5/</id>
    <published>2021-07-07T03:05:31.000Z</published>
    <updated>2021-07-08T13:28:49.165Z</updated>
    
    <content type="html"><![CDATA[<p>è¢«è§£æçš„å­—ç¬¦ä¸²å­—æ®µä¹Ÿæ˜¯å¤šå€¼å­—æ®µï¼Œ ä½†æ˜¯å¾ˆå°‘ä¼šæŒ‰ç…§ä½ æƒ³è¦çš„æ–¹å¼è¿›è¡Œæ’åºã€‚å¦‚æœä½ æƒ³åˆ†æä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚ fine old art ï¼Œ è¿™åŒ…å« 3 é¡¹ã€‚æˆ‘ä»¬å¾ˆå¯èƒ½æƒ³è¦æŒ‰ç¬¬ä¸€é¡¹çš„å­—æ¯æ’åºï¼Œç„¶åæŒ‰ç¬¬äºŒé¡¹çš„å­—æ¯æ’åºï¼Œè¯¸å¦‚æ­¤ç±»ï¼Œä½†æ˜¯ Elasticsearch åœ¨æ’åºè¿‡ç¨‹ä¸­æ²¡æœ‰è¿™æ ·çš„ä¿¡æ¯ã€‚</p><p>ä½ å¯ä»¥ä½¿ç”¨ min å’Œ max æ’åºæ¨¡å¼ï¼ˆé»˜è®¤æ˜¯ min ï¼‰ï¼Œä½†æ˜¯è¿™ä¼šå¯¼è‡´æ’åºä»¥ art æˆ–æ˜¯ old ï¼Œä»»ä½•ä¸€ä¸ªéƒ½ä¸æ˜¯æ‰€å¸Œæœ›çš„ã€‚</p><p>ä¸ºäº†ä»¥å­—ç¬¦ä¸²å­—æ®µè¿›è¡Œæ’åºï¼Œè¿™ä¸ªå­—æ®µåº”ä»…åŒ…å«ä¸€é¡¹ï¼š æ•´ä¸ª not_analyzed å­—ç¬¦ä¸²ã€‚ ä½†æ˜¯æˆ‘ä»¬ä»éœ€è¦ analyzed å­—æ®µï¼Œè¿™æ ·æ‰èƒ½ä»¥å…¨æ–‡è¿›è¡ŒæŸ¥è¯¢</p><p>ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯ç”¨ä¸¤ç§æ–¹å¼å¯¹åŒä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œç´¢å¼•ï¼Œè¿™å°†åœ¨æ–‡æ¡£ä¸­åŒ…æ‹¬ä¸¤ä¸ªå­—æ®µï¼š analyzed ç”¨äºæœç´¢ï¼Œ not_analyzed ç”¨äºæ’åº</p><p>ä½†æ˜¯ä¿å­˜ç›¸åŒçš„å­—ç¬¦ä¸²ä¸¤æ¬¡åœ¨ _source å­—æ®µæ˜¯æµªè´¹ç©ºé—´çš„ã€‚ æˆ‘ä»¬çœŸæ­£æƒ³è¦åšçš„æ˜¯ä¼ é€’ä¸€ä¸ª å•å­—æ®µ ä½†æ˜¯å´ç”¨ä¸¤ç§æ–¹å¼ç´¢å¼•å®ƒã€‚æ‰€æœ‰çš„ _core_field ç±»å‹ (strings, numbers, Booleans, dates) æ¥æ”¶ä¸€ä¸ª fields å‚æ•°</p><p>è¯¥å‚æ•°å…è®¸ä½ è½¬åŒ–ä¸€ä¸ªç®€å•çš„æ˜ å°„å¦‚ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;tweet&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;type&quot;</span>:     <span class="string">&quot;string&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;analyzer&quot;</span>: <span class="string">&quot;english&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºä¸€ä¸ªå¤šå­—æ®µæ˜ å°„å¦‚ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;tweet&quot;</span>: &#123; </span><br><span class="line">    <span class="attr">&quot;type&quot;</span>:     <span class="string">&quot;string&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;analyzer&quot;</span>: <span class="string">&quot;english&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;fields&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;raw&quot;</span>: &#123; </span><br><span class="line">            <span class="attr">&quot;type&quot;</span>:  <span class="string">&quot;string&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;index&quot;</span>: <span class="string">&quot;not_analyzed&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>tweet ä¸»å­—æ®µä¸ä¹‹å‰çš„ä¸€æ ·: æ˜¯ä¸€ä¸ª analyzed å…¨æ–‡å­—æ®µã€‚</p></li><li><p>æ–°çš„ tweet.raw å­å­—æ®µæ˜¯ not_analyzed.</p></li></ul><p>ç°åœ¨ï¼Œè‡³å°‘åªè¦æˆ‘ä»¬é‡æ–°ç´¢å¼•äº†æˆ‘ä»¬çš„æ•°æ®ï¼Œä½¿ç”¨ tweet å­—æ®µç”¨äºæœç´¢ï¼Œ<code>tweet.raw</code> å­—æ®µç”¨äºæ’åºï¼š<br><code>curl -X GET &quot;localhost:9200/_search?pretty&quot; -H &#39;Content-Type: application/json&#39; -d</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;tweet&quot;</span>: <span class="string">&quot;elasticsearch&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;sort&quot;</span>: <span class="string">&quot;tweet.raw&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¢«è§£æçš„å­—ç¬¦ä¸²å­—æ®µä¹Ÿæ˜¯å¤šå€¼å­—æ®µï¼Œ ä½†æ˜¯å¾ˆå°‘ä¼šæŒ‰ç…§ä½ æƒ³è¦çš„æ–¹å¼è¿›è¡Œæ’åºã€‚å¦‚æœä½ æƒ³åˆ†æä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚ fine old art ï¼Œ è¿™åŒ…å« 3 é¡¹ã€‚æˆ‘ä»¬å¾ˆå¯èƒ½æƒ³è¦æŒ‰ç¬¬ä¸€é¡¹çš„å­—æ¯æ’åºï¼Œç„¶åæŒ‰ç¬¬äºŒé¡¹çš„å­—æ¯æ’åºï¼Œè¯¸å¦‚æ­¤ç±»ï¼Œä½†æ˜¯ Elasticsearch åœ¨æ’åºè¿‡ç¨‹ä¸­æ²¡æœ‰è¿™æ ·çš„ä¿¡æ¯ã€‚</summary>
      
    
    
    
    <category term="Elasticsearch" scheme="http://example.com/categories/Elasticsearch/"/>
    
    <category term="Getting Started" scheme="http://example.com/categories/Elasticsearch/Getting-Started/"/>
    
    
  </entry>
  
  <entry>
    <title>æ¨èç³»ç»Ÿ-Overview</title>
    <link href="http://example.com/wiki/%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F-Overview/"/>
    <id>http://example.com/wiki/%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F-Overview/</id>
    <published>2021-07-07T02:08:05.000Z</published>
    <updated>2021-07-13T03:45:26.981Z</updated>
    
    <content type="html"><![CDATA[<h2 id="åšå®¢èµ„æ–™"><a href="#åšå®¢èµ„æ–™" class="headerlink" title="åšå®¢èµ„æ–™"></a>åšå®¢èµ„æ–™</h2><ul><li><a href="https://blog.csdn.net/qq_40027052/article/details/78733365">æ·±åº¦è§£æäº¬ä¸œä¸ªæ€§åŒ–æ¨èç³»ç»Ÿæ¼”è¿›å²</a>  </li><li><a href="https://www.cnblogs.com/liuning8023/p/5522619.html">ç”¨ Mahout å’Œ Elasticsearch å®ç°æ¨èç³»ç»Ÿ</a></li><li><a href="https://tech.meituan.com/2015/01/22/mt-recommend-practice.html">ç¾å›¢æ¨èç®—æ³•å®è·µ</a></li><li><a href="https://blog.csdn.net/love284969214/article/details/82932064">58åŒåŸæ¨èç³»ç»Ÿè®¾è®¡ä¸å®ç°</a></li><li><a href="http://www.360doc.com/content/16/0307/22/31263000_540328712.shtml">å¾®åšæ¨èç³»ç»Ÿçš„æ¶æ„æ¼”è¿›ä¹‹è·¯</a></li><li><a href="https://blog.csdn.net/tzs_1041218129/article/details/103331908">Flink åœ¨å°çº¢ä¹¦æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨</a></li><li><a href="https://www.slidestalk.com/YunQi/XiaoHongShu_BigData_Platform_Evolution">å°çº¢ä¹¦å¤§æ•°æ®åœ¨æ¨èç³»ç»Ÿä¸­çš„åº”ç”¨</a></li><li><a href="https://www.slidestalk.com/u223/rs_in_kuaikan">å¿«çœ‹æ¼«ç”»ä¸ªæ€§åŒ–æ¨èæ¢ç´¢ä¸å®è·µ</a></li><li><a href="https://zhuanlan.zhihu.com/p/45123018">æ•°æ®ä»“åº“ç³»åˆ—ç¯‡â€”â€”å”¯å“ä¼šå¤§æ•°æ®æ¶æ„</a></li><li><a href="https://developer.aliyun.com/article/763941">æ¨èç³»ç»ŸåŸºæœ¬æ¦‚å¿µå’Œæ¶æ„</a></li><li><a href="https://bp.aliyun.com/detail/140">PAIå¹³å°æ­å»ºä¼ä¸šçº§ä¸ªæ€§åŒ–æ¨èç³»ç»Ÿ - Aliyun</a></li><li><a href="https://www.aliyun.com/product/bigdata/product/learn"></a></li><li><a href="https://toutiao.io/posts/35tpcy/preview">è˜‘è‡è¡—æ¨èå·¥ç¨‹å®è·µ</a></li></ul><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><blockquote><ul><li><a href=""></a></li><li><a href=""></a></li></ul></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;åšå®¢èµ„æ–™&quot;&gt;&lt;a href=&quot;#åšå®¢èµ„æ–™&quot; class=&quot;headerlink&quot; title=&quot;åšå®¢èµ„æ–™&quot;&gt;&lt;/a&gt;åšå®¢èµ„æ–™&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.csdn.net/qq_40027052/article/detai</summary>
      
    
    
    
    <category term="Recommend System" scheme="http://example.com/categories/Recommend-System/"/>
    
    <category term="Overview" scheme="http://example.com/categories/Recommend-System/Overview/"/>
    
    
    <category term="æ¨è" scheme="http://example.com/tags/%E6%8E%A8%E8%8D%90/"/>
    
  </entry>
  
  <entry>
    <title>flink æäº¤ä»»åŠ¡</title>
    <link href="http://example.com/wiki/flink-%E6%8F%90%E4%BA%A4%E4%BB%BB%E5%8A%A1/"/>
    <id>http://example.com/wiki/flink-%E6%8F%90%E4%BA%A4%E4%BB%BB%E5%8A%A1/</id>
    <published>2021-07-06T15:57:04.000Z</published>
    <updated>2021-07-07T14:25:24.237Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸‹é¢æ¼”ç¤ºå¦‚ä½•é€šè¿‡adminé¡µé¢æäº¤ä»»åŠ¡ ğŸ‘‡</p><h2 id="å‡†å¤‡task-jar"><a href="#å‡†å¤‡task-jar" class="headerlink" title="å‡†å¤‡task jar"></a>å‡†å¤‡task jar</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StreamWordCount</span> </span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºæµå¤„ç†æ‰§è¡Œç¯å¢ƒ</span></span><br><span class="line">        StreamExecutionEnvironment env = StreamContextEnvironment.getExecutionEnvironment();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä»socketæ–‡æœ¬æµè¯»å–æ•°æ®</span></span><br><span class="line">        DataStream&lt;String&gt; inputDataStream = env.socketTextStream(<span class="string">&quot;localhost&quot;</span>, <span class="number">7777</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åŸºäºæ•°æ®æµè¿›è¡Œè½¬æ¢è®¡ç®—</span></span><br><span class="line">        DataStream&lt;Tuple2&lt;String,Integer&gt;&gt; resultStream = inputDataStream.flatMap(<span class="keyword">new</span> WordCount.MyFlatMapper())</span><br><span class="line">                .keyBy(<span class="number">0</span>)</span><br><span class="line">                .sum(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        resultStream.print();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ‰§è¡Œä»»åŠ¡</span></span><br><span class="line">        env.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œ<code>mvn install -DskipTest</code> å¯ä»¥å¾—åˆ°ç›¸åº”çš„jar</p><h2 id="adminæäº¤jar"><a href="#adminæäº¤jar" class="headerlink" title="adminæäº¤jar"></a>adminæäº¤jar</h2><img src='https://oscimg.oschina.net/oscnet/up-6f96aa46a523c9cd32f12177775b6d6fab9.png' width=900 height=450> <p>æäº¤å®ŒjaråŒ…ä¹‹åï¼Œéœ€è¦è®¾ç½®ç›¸å…³å‚æ•°ï¼Œè¿™ä¸ªæ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µæ¥è®¾ç½®ï¼Œä¸‹é¢æ˜¯å‚è€ƒæ ·ä¾‹ï¼š </p><ul><li>Enter Class : com.ibli.flink.StreamWordCount<br>ä¹Ÿå°±æ˜¯ç¨‹åºå…¥å£ï¼Œæˆ‘ä»¬è¿™æ˜¯å†™äº†ä¸€ä¸ªmainæ–¹æ³•ï¼Œå¦‚æœæ˜¯ç¨‹åºçš„è¯ï¼Œå¯ä»¥å†™å¯¹åº”bootstrapçš„å¯åŠ¨ç±»</li><li>Program Arguments : â€“host localhost â€“port 7777 </li></ul><p>ç‚¹å‡» <code>submit</code>  ä¹‹åæŸ¥çœ‹æäº¤çš„ä»»åŠ¡çŠ¶æ€</p><h2 id="æŸ¥çœ‹ä»»åŠ¡"><a href="#æŸ¥çœ‹ä»»åŠ¡" class="headerlink" title="æŸ¥çœ‹ä»»åŠ¡"></a>æŸ¥çœ‹ä»»åŠ¡</h2><img src='https://oscimg.oschina.net/oscnet/up-f11b32799d87f90c6e78732db82f191be3b.png' width=900 height=450>  <p>å¯ä»¥çœ‹åˆ°æ˜¯æœ‰ä¸¤ä¸ªä»»åŠ¡ï¼Œå¹¶ä¸”éƒ½æ˜¯åœ¨æ‰§è¡ŒçŠ¶æ€ï¼›<br>ç‚¹å‡»ä¸€ä¸ªä»»åŠ¡ï¼Œè¿˜å¯ä»¥æŸ¥çœ‹ä»»åŠ¡è¯¦æƒ…ä¿¡æ¯ï¼Œå’Œä¸€äº›å…¶ä»–çš„ä¿¡æ¯ï¼Œéå¸¸å…¨é¢ï¼›</p><img src="https://oscimg.oschina.net/oscnet/up-9678050d3906aae9ccead23d02927d46851.png" width=900 height=450><h2 id="æŸ¥çœ‹è¿è¡Œæ—¶ä»»åŠ¡åˆ—è¡¨"><a href="#æŸ¥çœ‹è¿è¡Œæ—¶ä»»åŠ¡åˆ—è¡¨" class="headerlink" title="æŸ¥çœ‹è¿è¡Œæ—¶ä»»åŠ¡åˆ—è¡¨"></a>æŸ¥çœ‹è¿è¡Œæ—¶ä»»åŠ¡åˆ—è¡¨</h2><img src='https://oscimg.oschina.net/oscnet/up-da8bf04ac90ae3c16095a6ebf25175b4452.png' width=900 height=350><h2 id="æŸ¥çœ‹ä»»åŠ¡ç®¡ç†åˆ—è¡¨"><a href="#æŸ¥çœ‹ä»»åŠ¡ç®¡ç†åˆ—è¡¨" class="headerlink" title="æŸ¥çœ‹ä»»åŠ¡ç®¡ç†åˆ—è¡¨"></a>æŸ¥çœ‹ä»»åŠ¡ç®¡ç†åˆ—è¡¨</h2><img src="https://oscimg.oschina.net/oscnet/up-a85746f93dc171f3d320a17c07294682bb3.png" width=900 height=450><p>ç‚¹å‡»ä»»åŠ¡å¯ä»¥è·³è½¬åˆ°è¯¦æƒ…é¡µé¢ ğŸ‘‡ ä¸‹é¢æ˜¯æ‰§è¡Œæ—¥å¿— </p><img src= 'https://oscimg.oschina.net/oscnet/up-a11c7ccc522c77d100d57a9c2a08ec9183b.png' width=900 height=500><p>æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°ä»»åŠ¡æ‰§è¡Œçš„æ ‡å‡†è¾“å‡ºç»“æœâœ…</p><img src="https://oscimg.oschina.net/oscnet/up-3d990a6318fab3a11e7336fdcd271851fda.png" width=900 height=400><h2 id="ä»»åŠ¡æºæ•°æ®"><a href="#ä»»åŠ¡æºæ•°æ®" class="headerlink" title="ä»»åŠ¡æºæ•°æ®"></a>ä»»åŠ¡æºæ•°æ®</h2><p>é€šè¿‡nc è¾“å…¥æ•°æ®ï¼Œç”±ç¨‹åºè¯»å–7777ç«¯å£è¾“å…¥æµå¹¶è§£ææ•°æ®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gaolei:geekibli gaolei$ nc -lk 7777</span><br><span class="line">hello java</span><br><span class="line">hello flink</span><br></pre></td></tr></table></figure><h2 id="å–æ¶ˆä»»åŠ¡å¦‚ä¸‹"><a href="#å–æ¶ˆä»»åŠ¡å¦‚ä¸‹" class="headerlink" title="å–æ¶ˆä»»åŠ¡å¦‚ä¸‹"></a>å–æ¶ˆä»»åŠ¡å¦‚ä¸‹</h2><img src='https://oscimg.oschina.net/oscnet/up-05199d86b957e0adec4e4d91390a0aebbec.png' width=900 height=400> <p>å†æ¬¡æŸ¥çœ‹å·²å®Œæˆä»»åŠ¡åˆ—è¡¨ å¦‚ä¸‹ï¼š</p><img src='https://oscimg.oschina.net/oscnet/up-78c97d4c4aec1641a22165735764c54b969.png' width=900 height=400>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä¸‹é¢æ¼”ç¤ºå¦‚ä½•é€šè¿‡adminé¡µé¢æäº¤ä»»åŠ¡ ğŸ‘‡&lt;/p&gt;
&lt;h2 id=&quot;å‡†å¤‡task-jar&quot;&gt;&lt;a href=&quot;#å‡†å¤‡task-jar&quot; class=&quot;headerlink&quot; title=&quot;å‡†å¤‡task jar&quot;&gt;&lt;/a&gt;å‡†å¤‡task jar&lt;/h2&gt;&lt;figure cla</summary>
      
    
    
    
    <category term="Apache Flink" scheme="http://example.com/categories/Apache-Flink/"/>
    
    
    <category term="flink" scheme="http://example.com/tags/flink/"/>
    
  </entry>
  
</feed>
